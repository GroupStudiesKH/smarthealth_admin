import{_ as x,i as N,r as m,j as S,k as u,o as r,c as i,b as a,l as M,d as A,e as _,g as b,n as c,t as n,a as d,v as F,F as D,f as q,p as C}from"./index-955d0ec7.js";import{a as L}from"./api-service-28558cf5.js";import{L as U}from"./loading-3ea249f0.js";import{F as B,N as T,_ as E}from"./sidebar-0f1fc19f.js";const P={components:{Footer:B,Navbar:T,Sidebar:E,Loading:U},setup(){const h=N(),o=m([]),w=m({name:"",email:"",permission_group_id:"",password:"",password_confirmation:""}),s=m(!1),g=m(""),y=m(""),p=m({}),l=m(!1),k=()=>{l.value=!0,L.registerAdmin(w.value).then(t=>{l.value=!1,v("成功","管理員已成功新增"),h.push("/admins")}).catch(t=>{var f;p.value=((f=t.response)==null?void 0:f.data.content)||{},l.value=!1,v("錯誤","新增管理員失敗，請檢查輸入並再試一次")})},v=(t,f)=>{y.value=t,g.value=f,s.value=!0},e=()=>{s.value=!1},V=async()=>{try{const t=await L.getPermissionGroups();o.value=t}catch(t){console.error("Error fetching permission list:",t),v("錯誤","獲取權限列表失敗，請再試一次")}};return S(async()=>{l.value=!0,await V(),l.value=!1}),{userData:w,registerAdmin:k,permissionList:o,showModal:s,modalMessage:g,modalTitle:y,closeModal:e,errors:p,isLoading:l}}},j={class:"main-wrapper"},z={class:"page-wrapper"},G={class:"page-content"},R={class:"row mb-4"},H={class:"col-12 col-lg-8 mx-auto stretch-card"},I={class:"card"},J={class:"card-body"},K={class:"mb-3"},O={key:0,class:"invalid-feedback"},Q={class:"mb-3"},W={key:0,class:"invalid-feedback"},X={class:"mb-3"},Y=["value"],Z={key:0,class:"invalid-feedback"},$={class:"mb-3"},ss={key:0,class:"invalid-feedback"},os={class:"mb-3"},as={key:0,class:"invalid-feedback"},es={class:"modal-dialog"},rs={class:"modal-content"},is={class:"modal-header"},ls={class:"modal-title"},ts={class:"modal-body"},ns={class:"modal-footer"},ds={key:1,class:"modal-backdrop fade show"};function ms(h,o,w,s,g,y){const p=u("Sidebar"),l=u("Navbar"),k=u("Footer"),v=u("Loading");return r(),i(D,null,[a("div",j,[M(p),a("div",z,[M(l),a("div",G,[a("div",R,[a("div",H,[a("div",I,[a("div",J,[o[15]||(o[15]=a("h6",{class:"card-title"},"新增管理員",-1)),a("form",{onSubmit:o[5]||(o[5]=A((...e)=>s.registerAdmin&&s.registerAdmin(...e),["prevent"]))},[a("div",K,[o[8]||(o[8]=a("label",{for:"name",class:"form-label"},"姓名",-1)),_(a("input",{type:"text",class:c(["form-control",{"is-invalid":s.errors.name}]),id:"name","onUpdate:modelValue":o[0]||(o[0]=e=>s.userData.name=e),required:""},null,2),[[b,s.userData.name]]),s.errors.name?(r(),i("div",O,n(s.errors.name[0]),1)):d("",!0)]),a("div",Q,[o[9]||(o[9]=a("label",{for:"email",class:"form-label"},"電子郵件",-1)),_(a("input",{type:"email",class:c(["form-control",{"is-invalid":s.errors.email}]),id:"email","onUpdate:modelValue":o[1]||(o[1]=e=>s.userData.email=e),required:""},null,2),[[b,s.userData.email]]),s.errors.email?(r(),i("div",W,n(s.errors.email[0]),1)):d("",!0)]),a("div",X,[o[11]||(o[11]=a("label",{for:"permission_group_id",class:"form-label"},"權限群組",-1)),_(a("select",{class:c(["form-select",{"is-invalid":s.errors.permission_group_id}]),id:"permission_group_id","onUpdate:modelValue":o[2]||(o[2]=e=>s.userData.permission_group_id=e),required:""},[o[10]||(o[10]=a("option",{value:""},"請選擇權限群組",-1)),(r(!0),i(D,null,q(s.permissionList,e=>(r(),i("option",{key:e.id,value:e.id},n(e.name),9,Y))),128))],2),[[F,s.userData.permission_group_id]]),s.errors.permission_group_id?(r(),i("div",Z,n(s.errors.permission_group_id[0]),1)):d("",!0)]),a("div",$,[o[12]||(o[12]=a("label",{for:"password",class:"form-label"},"密碼",-1)),_(a("input",{type:"password",class:c(["form-control",{"is-invalid":s.errors.password}]),id:"password","onUpdate:modelValue":o[3]||(o[3]=e=>s.userData.password=e),required:""},null,2),[[b,s.userData.password]]),s.errors.password?(r(),i("div",ss,n(s.errors.password[0]),1)):d("",!0)]),a("div",os,[o[13]||(o[13]=a("label",{for:"password_confirmation",class:"form-label"},"確認密碼",-1)),_(a("input",{type:"password",class:c(["form-control",{"is-invalid":s.errors.password}]),id:"password_confirmation","onUpdate:modelValue":o[4]||(o[4]=e=>s.userData.password_confirmation=e),required:""},null,2),[[b,s.userData.password_confirmation]]),s.errors.password?(r(),i("div",as,n(s.errors.password[0]),1)):d("",!0)]),o[14]||(o[14]=a("button",{type:"submit",class:"btn btn-primary"},"新增管理員",-1))],32)])])])]),s.showModal?(r(),i("div",{key:0,class:c(["modal fade",{show:s.showModal}]),tabindex:"-1",style:{display:"block"}},[a("div",es,[a("div",rs,[a("div",is,[a("h5",ls,n(s.modalTitle),1),a("button",{type:"button",class:"btn-close",onClick:o[6]||(o[6]=(...e)=>s.closeModal&&s.closeModal(...e))})]),a("div",ts,[a("p",null,n(s.modalMessage),1)]),a("div",ns,[a("button",{type:"button",class:"btn btn-secondary",onClick:o[7]||(o[7]=(...e)=>s.closeModal&&s.closeModal(...e))},"關閉")])])])],2)):d("",!0),s.showModal?(r(),i("div",ds)):d("",!0)]),M(k)])]),s.isLoading?(r(),C(v,{key:0})):d("",!0)],64)}const fs=x(P,[["render",ms]]);export{fs as default};
