import{_ as N,p as S,r as v,i as x,j as p,o as i,c as r,b as e,k as f,F as k,f as w,n as y,d as P,a as V,t as c}from"./index-adc0a2d3.js";import{F as j,N as B,_ as M,a as F}from"./sidebar-d8222704.js";const z={components:{Footer:j,Navbar:B,Sidebar:M},setup(){const _=S(),s=v([]),m=v(1),t=v(1),g=10,l=v(!1),d=async(a=1)=>{try{l.value=!0;const o=await F.getAdmins(a,g);s.value=o.data,t.value=Math.ceil(o.total/g),m.value=a,l.value=!1}catch(o){console.error("Failed to fetch admin data:",o)}},h=a=>{_.push(`/admins/${a}/edit`)},b=async a=>{var o,C;if(confirm("您確定要刪除這個管理員嗎？"))try{l.value=!0,await F.deleteAdmin(a),await d(m.value),l.value=!1}catch(A){console.error("Failed to delete admin:",A),alert(((C=(o=A.response)==null?void 0:o.data)==null?void 0:C.message)||"刪除管理員時發生錯誤")}},n=a=>{d(a)},u=()=>{_.push("/admins/add")};return x(()=>{d()}),{admins:s,loading:l,currentPage:m,totalPages:t,editAdmin:h,deleteAdmin:b,changePage:n,addAdmin:u}}},D={class:"main-wrapper"},E={class:"page-wrapper"},I={class:"page-content"},L={class:"row"},R={class:"col-12 stretch-card"},q={class:"card"},G={class:"card-body"},H={class:"d-flex justify-content-between align-items-center mb-3"},J={class:"table-responsive"},K={class:"table"},O=["onClick"],Q=["onClick"],T={class:"mt-4"},U={class:"pagination justify-content-center"},W=["onClick"],X={key:0,class:"loading-overlay"};function Y(_,s,m,t,g,l){const d=p("Sidebar"),h=p("Navbar"),b=p("Footer");return i(),r(k,null,[e("div",D,[f(d),e("div",E,[f(h),e("div",I,[e("div",L,[e("div",R,[e("div",q,[e("div",G,[e("div",H,[s[3]||(s[3]=e("h6",{class:"card-title"},"管理員列表",-1)),e("button",{onClick:s[0]||(s[0]=(...n)=>t.addAdmin&&t.addAdmin(...n)),class:"btn btn-primary"}," 新增管理員 ")]),e("div",J,[e("table",K,[s[4]||(s[4]=e("thead",null,[e("tr",null,[e("th",null,"ID"),e("th",null,"名稱"),e("th",null,"電子郵件"),e("th",null,"權限群組"),e("th",null,"操作")])],-1)),e("tbody",null,[(i(!0),r(k,null,w(t.admins,n=>(i(),r("tr",{key:n.id},[e("td",null,c(n.id),1),e("td",null,c(n.name),1),e("td",null,c(n.email),1),e("td",null,c(n.permission_group.name),1),e("td",null,[e("button",{onClick:u=>t.editAdmin(n.id),class:"btn btn-primary btn-sm me-2"}," 編輯 ",8,O),e("button",{onClick:u=>t.deleteAdmin(n.id),class:"btn btn-danger btn-sm"}," 刪除 ",8,Q)])]))),128))])])]),e("nav",T,[e("ul",U,[e("li",{class:y(["page-item",{disabled:t.currentPage===1}])},[e("a",{class:"page-link",href:"#",onClick:s[1]||(s[1]=P(n=>t.changePage(t.currentPage-1),["prevent"]))},"上一頁")],2),(i(!0),r(k,null,w(t.totalPages,n=>(i(),r("li",{key:n,class:y(["page-item",{active:t.currentPage===n}])},[e("a",{class:"page-link",href:"#",onClick:P(u=>t.changePage(n),["prevent"])},c(n),9,W)],2))),128)),e("li",{class:y(["page-item",{disabled:t.currentPage===t.totalPages}])},[e("a",{class:"page-link",href:"#",onClick:s[2]||(s[2]=P(n=>t.changePage(t.currentPage+1),["prevent"]))},"下一頁")],2)])])])])])])]),f(b)])]),t.loading?(i(),r("div",X,s[5]||(s[5]=[e("div",{class:"loading-spinner"},[e("div",{class:"spinner-border text-primary",role:"status"},[e("span",{class:"visually-hidden"},"載入中...")]),e("div",{class:"mt-2"},"載入中...")],-1)]))):V("",!0)],64)}const ee=N(z,[["render",Y]]);export{ee as default};
