import{_ as D,i as S,r as d,j as N,k as g,o as t,c as n,l as k,b as o,d as E,e as p,g as h,n as v,t as m,a as _,v as F,F as P,f as V,s as C}from"./index-13cbd5f1.js";import{F as U,N as L,_ as x}from"./sidebar-ad5af850.js";const B={components:{Footer:U,Navbar:L,Sidebar:x},setup(){S();const i=d([]),s=d({name:"",email:"",permission_group_id:"",new_password:""});d(!1);const u=d(!1),e=d(""),b=d(""),l=d({}),f=()=>{if(!w())return;const r={...s.value,id:1};try{sessionStorage.setItem("userData",JSON.stringify(r)),c("成功","使用者資料已成功更新")}catch(y){console.error("Error updating user data:",y),c("錯誤","更新使用者資料失敗，請檢查輸入並再試一次")}},w=()=>(l.value={},s.value.name.trim()||(l.value.name=["請填寫姓名"]),s.value.permission_group_id||(l.value.permission_group_id=["請選擇權限群組"]),s.value.new_password&&s.value.new_password.length<6&&(l.value.password=["密碼長度至少需要6個字元"]),Object.keys(l.value).length===0),c=(r,y)=>{b.value=r,e.value=y,u.value=!0},a=()=>{u.value=!1},M=async()=>{try{const r=[{id:1,name:"系統管理員"},{id:2,name:"一般管理員"},{id:3,name:"客服人員"}];i.value=r}catch(r){console.error("Error fetching permission list:",r),c("錯誤","獲取權限列表失敗，請再試一次")}};return N(()=>{M();const r=sessionStorage.getItem("userData");r?s.value={...JSON.parse(r),password:"",password_confirmation:""}:console.error("User data not found in sessionStorage")}),{userData:s,adminEdit:f,permissionList:i,showModal:u,modalMessage:e,modalTitle:b,closeModal:a,errors:l}}},O={class:"main-wrapper"},T={class:"page-wrapper"},j={class:"page-content"},q={class:"row mb-4"},I={class:"col-12 col-lg-8 mx-auto stretch-card"},J={class:"card"},R={class:"card-body"},z={class:"mb-3"},A={key:0,class:"invalid-feedback"},G={class:"mb-3"},H={class:"mb-3"},K=["value"],Q={key:0,class:"invalid-feedback"},W={class:"mb-3"},X={class:"input-group"},Y=["type"],Z={key:0,class:"invalid-feedback"},$={class:"modal-dialog"},ss={class:"modal-content"},os={class:"modal-header"},es={class:"modal-title"},as={class:"modal-body"},rs={class:"modal-footer"},is={key:1,class:"modal-backdrop fade show"};function ts(i,s,u,e,b,l){const f=g("Sidebar"),w=g("Navbar"),c=g("Footer");return t(),n("div",O,[k(f),o("div",T,[k(w),o("div",j,[o("div",q,[o("div",I,[o("div",J,[o("div",R,[s[14]||(s[14]=o("h6",{class:"card-title"},"編輯使用者資料",-1)),o("form",{onSubmit:s[5]||(s[5]=E((...a)=>e.adminEdit&&e.adminEdit(...a),["prevent"]))},[o("div",z,[s[8]||(s[8]=o("label",{for:"name",class:"form-label"},"姓名",-1)),p(o("input",{type:"text",class:v(["form-control",{"is-invalid":e.errors.name}]),id:"name","onUpdate:modelValue":s[0]||(s[0]=a=>e.userData.name=a),required:""},null,2),[[h,e.userData.name]]),e.errors.name?(t(),n("div",A,m(e.errors.name[0]),1)):_("",!0)]),o("div",G,[s[9]||(s[9]=o("label",{for:"email",class:"form-label"},"電子郵件",-1)),p(o("input",{type:"email",class:"form-control",id:"email","onUpdate:modelValue":s[1]||(s[1]=a=>e.userData.email=a),disabled:""},null,512),[[h,e.userData.email]])]),o("div",H,[s[11]||(s[11]=o("label",{for:"permission_group_id",class:"form-label"},"權限群組",-1)),p(o("select",{class:v(["form-select",{"is-invalid":e.errors.permission_group_id}]),id:"permission_group_id","onUpdate:modelValue":s[2]||(s[2]=a=>e.userData.permission_group_id=a),required:""},[s[10]||(s[10]=o("option",{value:""},"請選擇權限群組",-1)),(t(!0),n(P,null,V(e.permissionList,a=>(t(),n("option",{key:a.id,value:a.id},m(a.name),9,K))),128))],2),[[F,e.userData.permission_group_id]]),e.errors.permission_group_id?(t(),n("div",Q,m(e.errors.permission_group_id[0]),1)):_("",!0)]),o("div",W,[s[12]||(s[12]=o("label",{for:"new_password",class:"form-label"},"更改密碼",-1)),o("div",X,[p(o("input",{type:i.showPassword?"text":"password",class:v(["form-control",{"is-invalid":e.errors.password}]),id:"new_password","onUpdate:modelValue":s[3]||(s[3]=a=>e.userData.new_password=a)},null,10,Y),[[C,e.userData.new_password]]),o("button",{class:"btn btn-outline-secondary",type:"button",onClick:s[4]||(s[4]=a=>i.showPassword=!i.showPassword)},[o("i",{class:v((i.showPassword,"material-icons"))},m(i.showPassword?"visibility_off":"visibility"),3)]),e.errors.password?(t(),n("div",Z,m(e.errors.password[0]),1)):_("",!0)])]),s[13]||(s[13]=o("button",{type:"submit",class:"btn btn-primary"},"更新資料",-1))],32)])])])]),e.showModal?(t(),n("div",{key:0,class:v(["modal fade",{show:e.showModal}]),tabindex:"-1",style:{display:"block"}},[o("div",$,[o("div",ss,[o("div",os,[o("h5",es,m(e.modalTitle),1),o("button",{type:"button",class:"btn-close",onClick:s[6]||(s[6]=(...a)=>e.closeModal&&e.closeModal(...a))})]),o("div",as,[o("p",null,m(e.modalMessage),1)]),o("div",rs,[o("button",{type:"button",class:"btn btn-secondary",onClick:s[7]||(s[7]=(...a)=>e.closeModal&&e.closeModal(...a))},"關閉")])])])],2)):_("",!0),e.showModal?(t(),n("div",is)):_("",!0)]),k(c)])])}const ds=D(B,[["render",ts]]);export{ds as default};
