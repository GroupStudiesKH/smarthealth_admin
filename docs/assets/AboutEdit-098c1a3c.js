import{_ as U,u as V,i as C,r as _,j as F,k as v,o as f,c as D,l as k,b as t,e as l,g as n,a as x,t as L,n as h,h as A,p as N}from"./index-dd0c0eb2.js";import{F as j,N as S,_ as E}from"./sidebar-0cb9a7ca.js";import{a as M}from"./api-service-a37f4a4e.js";import{L as B}from"./loading-196c643f.js";const O={components:{Footer:j,Navbar:S,Sidebar:E,Loading:B},setup(){V(),C();const d=_({key_person_title:"",key_person_chinese_name:"",key_person_english_name:"",key_person_pic:"",section_1:"",section_2_title:"",section_2_content:"",section_3_title:"",section_3_content:"",section_4_title:"",section_4_content:""}),o=_({}),b=_(!1),e=_(""),r=_(!1),u=async()=>{try{r.value=!0;const s=await M.getAbout();d.value={...d.value,...s},r.value=!1}catch(s){r.value=!1,console.error("Error fetching about data:",s),alert("獲取關於我們資料失敗，請稍後再試")}},y=s=>{const i=s.target.files[0];if(i){const a=URL.createObjectURL(i);d.value={...d.value,key_person_pic:i,preview_url:a}}},w=async()=>{var s,i;try{r.value=!0;const a=new FormData;Object.entries(d.value).forEach(([m,c])=>{m!=="preview_url"&&(m==="key_person_pic"?c instanceof File&&a.append(m,c):c!=null&&a.append(m,c))});const p=await M.updateAbout(a);e.value="儲存成功",b.value=!0,r.value=!1,await u()}catch(a){if(r.value=!1,console.error("Failed to save about data:",a),((i=(s=a.response)==null?void 0:s.data)==null?void 0:i.status)==="error")if(a.response.data.content){const p={};for(const[c,g]of Object.entries(a.response.data.content))p[c]=Array.isArray(g)?g[0].replace(/[\[\]"]/g,""):g;o.value=p;const m=Object.values(p).join("<br/>");e.value=m,b.value=!0}else e.value=a.response.data.message||"儲存失敗",b.value=!0;else e.value="儲存失敗",b.value=!0}};return F(()=>{u()}),{aboutData:d,errors:o,showModal:b,modalMessage:e,loading:r,getAboutData:u,saveAboutData:w,handleFileChange:y}}},R={class:"main-wrapper"},P={class:"page-wrapper"},T={class:"page-content"},z={class:"row"},H={class:"col-md-12 grid-margin stretch-card"},K={class:"card"},q={class:"card-body"},G={class:"row mb-4"},I={class:"col-12 mb-3"},J={class:"col-12 mb-3"},Q={class:"col-12 mb-3"},W={class:"col-12 mb-3"},X={key:0,class:"image-preview mt-2"},Y=["src"],Z={class:"col-12 mb-3"},$={class:"col-12 mb-3"},oo={class:"col-12 mb-3"},to={class:"col-12 mb-3"},eo={class:"col-12 mb-3"},ao={class:"col-12 mb-3"},so={class:"col-12 mb-3"},lo=["disabled"],no={class:"modal-dialog"},ro={class:"modal-content"},io={class:"modal-header"},co=["innerHTML"],bo={class:"modal-footer"};function mo(d,o,b,e,r,u){const y=v("Navbar"),w=v("Sidebar"),s=v("Footer"),i=v("Loading");return f(),D("div",R,[k(y),k(w),t("div",P,[t("div",T,[t("div",z,[t("div",H,[t("div",K,[t("div",q,[o[26]||(o[26]=t("h6",{class:"card-title"},"關於我們編輯",-1)),t("div",G,[t("div",I,[o[15]||(o[15]=t("label",{class:"form-label"},"關鍵人物職稱",-1)),l(t("input",{type:"text",class:"form-control","onUpdate:modelValue":o[0]||(o[0]=a=>e.aboutData.key_person_title=a)},null,512),[[n,e.aboutData.key_person_title]])]),t("div",J,[o[16]||(o[16]=t("label",{class:"form-label"},"關鍵人物中文姓名",-1)),l(t("input",{type:"text",class:"form-control","onUpdate:modelValue":o[1]||(o[1]=a=>e.aboutData.key_person_chinese_name=a)},null,512),[[n,e.aboutData.key_person_chinese_name]])]),t("div",Q,[o[17]||(o[17]=t("label",{class:"form-label"},"關鍵人物英文姓名",-1)),l(t("input",{type:"text",class:"form-control","onUpdate:modelValue":o[2]||(o[2]=a=>e.aboutData.key_person_english_name=a)},null,512),[[n,e.aboutData.key_person_english_name]])]),t("div",W,[o[18]||(o[18]=t("label",{class:"form-label"},"關鍵人物照片",-1)),t("input",{type:"file",class:"form-control",onChange:o[3]||(o[3]=(...a)=>e.handleFileChange&&e.handleFileChange(...a)),accept:"image/*"},null,32),e.aboutData.preview_url||e.aboutData.key_person_pic?(f(),D("div",X,[t("img",{src:e.aboutData.preview_url||e.aboutData.key_person_pic,alt:"Key Person Picture Preview",style:{"max-width":"200px"}},null,8,Y)])):x("",!0)]),t("div",Z,[o[19]||(o[19]=t("label",{class:"form-label"},"第一段內容",-1)),l(t("textarea",{class:"form-control",rows:"5","onUpdate:modelValue":o[4]||(o[4]=a=>e.aboutData.section_1=a),style:{"white-space":"pre-wrap"}},null,512),[[n,e.aboutData.section_1]])]),t("div",$,[o[20]||(o[20]=t("label",{class:"form-label"},"第二段標題",-1)),l(t("input",{type:"text",class:"form-control","onUpdate:modelValue":o[5]||(o[5]=a=>e.aboutData.section_2_title=a)},null,512),[[n,e.aboutData.section_2_title]])]),t("div",oo,[o[21]||(o[21]=t("label",{class:"form-label"},"第二段內容",-1)),l(t("textarea",{class:"form-control",rows:"5","onUpdate:modelValue":o[6]||(o[6]=a=>e.aboutData.section_2_content=a),style:{"white-space":"pre-wrap"}},null,512),[[n,e.aboutData.section_2_content]])]),t("div",to,[o[22]||(o[22]=t("label",{class:"form-label"},"第三段標題",-1)),l(t("input",{type:"text",class:"form-control","onUpdate:modelValue":o[7]||(o[7]=a=>e.aboutData.section_3_title=a)},null,512),[[n,e.aboutData.section_3_title]])]),t("div",eo,[o[23]||(o[23]=t("label",{class:"form-label"},"第三段內容",-1)),l(t("textarea",{class:"form-control",rows:"5","onUpdate:modelValue":o[8]||(o[8]=a=>e.aboutData.section_3_content=a),style:{"white-space":"pre-wrap"}},null,512),[[n,e.aboutData.section_3_content]])]),t("div",ao,[o[24]||(o[24]=t("label",{class:"form-label"},"第四段標題",-1)),l(t("input",{type:"text",class:"form-control","onUpdate:modelValue":o[9]||(o[9]=a=>e.aboutData.section_4_title=a)},null,512),[[n,e.aboutData.section_4_title]])]),t("div",so,[o[25]||(o[25]=t("label",{class:"form-label"},"第四段內容",-1)),l(t("textarea",{class:"form-control",rows:"5","onUpdate:modelValue":o[10]||(o[10]=a=>e.aboutData.section_4_content=a),style:{"white-space":"pre-wrap"}},null,512),[[n,e.aboutData.section_4_content]])])]),t("button",{type:"button",class:"btn btn-primary me-2",onClick:o[11]||(o[11]=(...a)=>e.saveAboutData&&e.saveAboutData(...a)),disabled:e.loading},L(e.loading?"儲存中...":"儲存"),9,lo)])])])])]),k(s)]),t("div",{class:h(["modal fade",{show:e.showModal}]),id:"exampleModal",tabindex:"-1","aria-labelledby":"exampleModalLabel",style:A({display:e.showModal?"block":"none"}),"aria-modal":"true",role:"dialog"},[t("div",no,[t("div",ro,[t("div",io,[o[27]||(o[27]=t("h5",{class:"modal-title",id:"exampleModalLabel"},"系統訊息",-1)),t("button",{type:"button",class:"btn-close",onClick:o[12]||(o[12]=a=>e.showModal=!1),"aria-label":"btn-close"})]),t("div",{class:"modal-body",innerHTML:e.modalMessage},null,8,co),t("div",bo,[t("button",{type:"button",class:"btn btn-secondary",onClick:o[13]||(o[13]=a=>e.showModal=!1)}," 關閉 ")])])])],6),e.showModal?(f(),D("div",{key:0,class:"modal-backdrop fade show",onClick:o[14]||(o[14]=a=>e.showModal=!1)})):x("",!0),e.loading?(f(),N(i,{key:1})):x("",!0)])}const fo=U(O,[["render",mo]]);export{fo as default};
