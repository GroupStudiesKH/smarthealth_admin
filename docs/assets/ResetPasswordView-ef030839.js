import{_ as L,i as V,u as q,r,j as F,k as w,o as m,c as u,b as o,m as y,e as g,g as _,t as k,l as B,y as N,n as M,a as p,p as T,F as D}from"./index-7097d872.js";import{a as h}from"./api-service-28558cf5.js";import{L as R}from"./loading-0c855871.js";const j={components:{Loading:R},setup(){const d=V(),s=q(),i=r(""),a=r(""),c=r(!1),e=r(!1),n=r(""),t=r(!1),l=async b=>{var f,v;if(b.preventDefault(),i.value!==a.value){n.value="兩次輸入的密碼不一致",t.value=!0;return}e.value=!0;try{await h.resetPassword({token:s.query.token,password:i.value}),c.value=!0}catch(C){n.value=((v=(f=C.response)==null?void 0:f.data)==null?void 0:v.message)||"重設密碼失敗",t.value=!0,e.value=!1}finally{e.value=!1}},x=async()=>{try{e.value=!0,await h.verifyToken({token:s.query.token}),e.value=!1}catch{alert("無效的重設密碼連結"),d.push("/login")}},S=()=>{c.value=!1,d.push("/login")},E=()=>{t.value=!1};return F(()=>{console.log(s.query.token),s.query.token?x():(alert("無效的重設密碼連結"),d.push("/login"))}),{password:i,password_confirmation:a,submitForm:l,showSuccessModal:c,closeSuccessModal:S,isLoading:e,errorMessage:n,showErrorModal:t,closeErrorModal:E}}},P={class:"main-wrapper"},U={class:"page-wrapper full-page"},z={class:"page-content d-flex align-items-center justify-content-center"},H={class:"row w-100 mx-0 auth-page"},A={class:"col-md-10 col-lg-8 col-xl-6 mx-auto"},G={class:"card"},I={class:"row"},J={class:"col-md-8 ps-md-0"},K={class:"auth-form-wrapper px-4 py-5"},O={class:"mb-3"},Q={class:"mb-3"},W=["disabled"],X={class:"modal-dialog"},Y={class:"modal-content"},Z={class:"modal-header"},$={class:"modal-footer"},oo={class:"modal-dialog"},so={class:"modal-content"},ao={class:"modal-header"},lo={class:"modal-body"},eo={class:"modal-footer"};function to(d,s,i,a,c,e){const n=w("router-link"),t=w("Loading");return m(),u(D,null,[o("div",P,[o("div",U,[o("div",z,[o("div",H,[o("div",A,[o("div",G,[o("div",I,[s[13]||(s[13]=o("div",{class:"col-md-4 pe-md-0"},[o("div",{class:"auth-side-wrapper",style:{"background-image":"url('assets/images/login.webp')"}})],-1)),o("div",J,[o("div",K,[s[10]||(s[10]=o("a",{href:"#",class:"nobleui-logo d-block mb-2"},[y("Smart"),o("span",null,"Health")],-1)),s[11]||(s[11]=o("h5",{class:"text-secondary fw-normal mb-4"},"重設密碼",-1)),s[12]||(s[12]=o("p",{class:"mb-4"},"請輸入您的新密碼。",-1)),o("form",{class:"forms-sample",onSubmit:s[2]||(s[2]=(...l)=>a.submitForm&&a.submitForm(...l))},[o("div",O,[s[7]||(s[7]=o("label",{for:"password",class:"form-label"},"新密碼",-1)),g(o("input",{type:"password",class:"form-control",id:"password","onUpdate:modelValue":s[0]||(s[0]=l=>a.password=l),placeholder:"請輸入新密碼",required:""},null,512),[[_,a.password]])]),o("div",Q,[s[8]||(s[8]=o("label",{for:"password_confirmation",class:"form-label"},"確認密碼",-1)),g(o("input",{type:"password",class:"form-control",id:"password_confirmation","onUpdate:modelValue":s[1]||(s[1]=l=>a.password_confirmation=l),placeholder:"請再次輸入新密碼",required:""},null,512),[[_,a.password_confirmation]])]),o("button",{type:"submit",class:"btn btn-primary me-2 mb-2 mb-md-0",disabled:a.isLoading},k(a.isLoading?"處理中...":"確認重設密碼"),9,W),B(n,{to:"/login",class:"btn btn-secondary"},{default:N(()=>s[9]||(s[9]=[y(" 返回登入 ")])),_:1})],32)])])])])])])])]),a.showSuccessModal?(m(),u("div",{key:0,class:M(["modal fade",{show:a.showSuccessModal}]),tabindex:"-1",style:{display:"block"}},[o("div",X,[o("div",Y,[o("div",Z,[s[14]||(s[14]=o("h5",{class:"modal-title"},"重設成功",-1)),o("button",{type:"button",class:"btn-close",onClick:s[3]||(s[3]=(...l)=>a.closeSuccessModal&&a.closeSuccessModal(...l))})]),s[15]||(s[15]=o("div",{class:"modal-body"},[o("p",null,"密碼已重設成功，請使用新密碼登入。")],-1)),o("div",$,[o("button",{type:"button",class:"btn btn-primary",onClick:s[4]||(s[4]=(...l)=>a.closeSuccessModal&&a.closeSuccessModal(...l))},"確定")])])])],2)):p("",!0),a.showErrorModal?(m(),u("div",{key:1,class:M(["modal fade",{show:a.showErrorModal}]),tabindex:"-1",style:{display:"block"}},[o("div",oo,[o("div",so,[o("div",ao,[s[16]||(s[16]=o("h5",{class:"modal-title"},"錯誤",-1)),o("button",{type:"button",class:"btn-close",onClick:s[5]||(s[5]=(...l)=>a.closeErrorModal&&a.closeErrorModal(...l))})]),o("div",lo,[o("p",null,k(a.errorMessage),1)]),o("div",eo,[o("button",{type:"button",class:"btn btn-primary",onClick:s[6]||(s[6]=(...l)=>a.closeErrorModal&&a.closeErrorModal(...l))},"確定")])])])],2)):p("",!0)]),a.isLoading?(m(),T(t,{key:0})):p("",!0)],64)}const co=L(j,[["render",to]]);export{co as default};
