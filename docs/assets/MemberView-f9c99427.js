import{_ as z,i as E,r as b,q as F,j as R,k as v,o as l,c as d,b as e,l as C,m as M,e as T,g as B,E as j,F as _,f as w,n as m,d as S,a as P,p as A,t as r}from"./index-61f48f03.js";import{a as N}from"./api-service-e3b33b42.js";import{F as G,N as K,_ as q}from"./sidebar-1e893977.js";import{L as U}from"./loading-27cafcfd.js";const H={components:{Footer:G,Navbar:K,Sidebar:q,Loading:U},setup(){const u=E(),s=b([]),k=b(0),a=b(1),h=b(10),g=F({keyword:""}),c=b(!1),y=()=>{a.value=1,o()},p=()=>{g.keyword="",a.value=1,o()},f=n=>{a.value=n,o()},t=F([{key:"id",label:"編號"},{key:"name",label:"會員名稱"},{key:"birthdate",label:"生日"},{key:"email",label:"Email帳號"},{key:"created_at",label:"註冊日期"},{key:"status",label:"狀態"},{key:"actions",label:"操作"}]),o=async()=>{try{c.value=!0;const n=await N.getMembers({page:a.value,per_page:h.value,keyword:g.keyword});c.value=!1,s.value=n.data.map(i=>({id:i.id,name:i.name,email:i.email,birthdate:i.birthdate,created_at:i.created_at,status:i.status==="active"})),k.value=n.total,a.value=n.current_page,h.value=n.per_page}catch(n){console.error("Failed to fetch member data:",n)}},V=n=>{u.push(`/member/edit/${n}`)},x=async n=>{try{c.value=!0,await N.memberStatus(n),o(),c.value=!1}catch(i){console.error("Failed to toggle member status:",i)}},D=n=>{u.push(`/member/grades/${n}`)},L=()=>{u.push("/member/add")};return R(()=>{o()}),{tableData:s,tableColumns:t,totalRecords:k,currentPage:a,pageSize:h,loading:c,searchForm:g,handleSearch:y,resetSearch:p,handlePageChange:f,handleEdit:V,handleToggleStatus:x,handleViewGrades:D,handleAddMember:L}}},I={class:"main-wrapper"},J={class:"page-wrapper"},O={class:"page-content"},Q={class:"row"},W={class:"col-md-12 grid-margin stretch-card"},X={class:"card"},Y={class:"card-body"},Z={class:"d-flex justify-content-between align-items-center mb-3"},$={class:"row mb-3"},ee={class:"col-md-6"},ae={class:"input-group"},te={class:"table-responsive"},se={class:"table table-hover"},ne=["onClick"],oe=["onClick"],le={class:"material-icons"},re=["onClick"],ie={key:0,class:"mt-3"},de={class:"pagination justify-content-center"},ce=["onClick"];function be(u,s,k,a,h,g){const c=v("Sidebar"),y=v("Navbar"),p=v("Footer"),f=v("Loading");return l(),d(_,null,[e("div",I,[C(c),e("div",J,[C(y),e("div",O,[e("div",Q,[e("div",W,[e("div",X,[e("div",Y,[e("div",Z,[s[8]||(s[8]=e("h6",{class:"card-title mb-0"},"會員列表",-1)),e("button",{class:"btn btn-primary",onClick:s[0]||(s[0]=(...t)=>a.handleAddMember&&a.handleAddMember(...t))},s[7]||(s[7]=[e("i",{class:"material-icons"},"add",-1),M(" 新增會員 ")]))]),e("div",$,[e("div",ee,[e("div",ae,[T(e("input",{type:"text",class:"form-control","onUpdate:modelValue":s[1]||(s[1]=t=>a.searchForm.keyword=t),placeholder:"搜尋會員...",onKeyup:s[2]||(s[2]=j((...t)=>a.handleSearch&&a.handleSearch(...t),["enter"]))},null,544),[[B,a.searchForm.keyword]]),e("button",{class:"btn btn-outline-primary",type:"button",onClick:s[3]||(s[3]=(...t)=>a.handleSearch&&a.handleSearch(...t))},s[9]||(s[9]=[e("i",{class:"material-icons"},"search",-1)])),e("button",{class:"btn btn-outline-secondary",type:"button",onClick:s[4]||(s[4]=(...t)=>a.resetSearch&&a.resetSearch(...t))},s[10]||(s[10]=[e("i",{class:"material-icons"},"refresh",-1)]))])])]),e("div",te,[e("table",se,[e("thead",null,[e("tr",null,[(l(!0),d(_,null,w(a.tableColumns,t=>(l(),d("th",{key:t.key},r(t.label),1))),128))])]),e("tbody",null,[(l(!0),d(_,null,w(a.tableData,t=>(l(),d("tr",{key:t.id},[e("td",null,r(t.id),1),e("td",null,r(t.name),1),e("td",null,r(t.birthdate),1),e("td",null,r(t.email),1),e("td",null,r(new Date(t.created_at).toLocaleDateString()),1),e("td",null,[e("span",{class:m(["badge",t.status?"bg-success":"bg-danger"])},r(t.status?"啟用":"停用"),3)]),e("td",null,[e("button",{class:"btn btn-sm btn-info me-1",onClick:o=>a.handleEdit(t.id)},s[11]||(s[11]=[e("i",{class:"material-icons"},"edit",-1)]),8,ne),e("button",{class:m(["btn btn-sm me-1",t.status?"btn-warning":"btn-success"]),onClick:o=>a.handleToggleStatus(t.id)},[e("i",le,r(t.status?"block":"check_circle"),1)],10,oe),e("button",{class:"btn btn-sm btn-primary me-1",onClick:o=>a.handleViewGrades(t.id)},s[12]||(s[12]=[e("i",{class:"material-icons"},"school",-1),M(" 學習紀錄 ")]),8,re)])]))),128))])])]),a.totalRecords>a.pageSize?(l(),d("nav",ie,[e("ul",de,[e("li",{class:m(["page-item",{disabled:a.currentPage===1}])},[e("a",{class:"page-link",href:"#",onClick:s[5]||(s[5]=S(t=>a.handlePageChange(a.currentPage-1),["prevent"]))}," 上一頁 ")],2),(l(!0),d(_,null,w(Math.ceil(a.totalRecords/a.pageSize),t=>(l(),d("li",{key:t,class:m(["page-item",{active:a.currentPage===t}])},[e("a",{class:"page-link",href:"#",onClick:S(o=>a.handlePageChange(t),["prevent"])},r(t),9,ce)],2))),128)),e("li",{class:m(["page-item",{disabled:a.currentPage===Math.ceil(a.totalRecords/a.pageSize)}])},[e("a",{class:"page-link",href:"#",onClick:s[6]||(s[6]=S(t=>a.handlePageChange(a.currentPage+1),["prevent"]))}," 下一頁 ")],2)])])):P("",!0)])])])])]),C(p)])]),a.loading?(l(),A(f,{key:0})):P("",!0)],64)}const ve=z(H,[["render",be]]);export{ve as default};
