import{A as Wt,B as Ge,_ as Jt,p as Qt,u as er,r as $,i as tr,j as Ee,o as B,c as q,k as Oe,b as v,a as Ke,l as Xe,t as ye,d as rr,e as me,g as ke,F as nr,f as or,v as ir}from"./index-c474f259.js";import{F as ar,N as lr,_ as sr,a as W}from"./sidebar-cb25b013.js";import{C as ur,U as fr}from"./UploadAdapter-caf955d8.js";function re(t){"@babel/helpers - typeof";return re=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},re(t)}function Ye(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,pr(r.key),r)}}function cr(t,e,n){return e&&Ye(t.prototype,e),n&&Ye(t,n),Object.defineProperty(t,"prototype",{writable:!1}),t}function pr(t){var e=hr(t,"string");return re(e)=="symbol"?e:e+""}function hr(t,e){if(re(t)!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e||"default");if(re(r)!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function dr(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function yr(t,e,n){return e=ue(e),mr(t,He()?Reflect.construct(e,n||[],ue(t).constructor):e.apply(t,n))}function mr(t,e){if(e&&(re(e)==="object"||typeof e=="function"))return e;if(e!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return vr(t)}function vr(t){if(t===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function gr(t,e){if(typeof e!="function"&&e!==null)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&se(t,e)}function je(t){var e=typeof Map=="function"?new Map:void 0;return je=function(r){if(r===null||!_r(r))return r;if(typeof r!="function")throw new TypeError("Super expression must either be null or a function");if(typeof e<"u"){if(e.has(r))return e.get(r);e.set(r,o)}function o(){return br(r,arguments,ue(this).constructor)}return o.prototype=Object.create(r.prototype,{constructor:{value:o,enumerable:!1,writable:!0,configurable:!0}}),se(o,r)},je(t)}function br(t,e,n){if(He())return Reflect.construct.apply(null,arguments);var r=[null];r.push.apply(r,e);var o=new(t.bind.apply(t,r));return n&&se(o,n.prototype),o}function He(){try{var t=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch{}return(He=function(){return!!t})()}function _r(t){try{return Function.toString.call(t).indexOf("[native code]")!==-1}catch{return typeof t=="function"}}function se(t,e){return se=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(r,o){return r.__proto__=o,r},se(t,e)}function ue(t){return ue=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(n){return n.__proto__||Object.getPrototypeOf(n)},ue(t)}var ve=function(t){function e(n){var r,o=arguments.length>1&&arguments[1]!==void 0?arguments[1]:null,l=arguments.length>2&&arguments[2]!==void 0?arguments[2]:null,u=arguments.length>3&&arguments[3]!==void 0?arguments[3]:null;if(dr(this,e),r=yr(this,e,[n]),r.originalRequest=l,r.originalResponse=u,r.causingError=o,o!=null&&(n+=", caused by ".concat(o.toString())),l!=null){var c=l.getHeader("X-Request-ID")||"n/a",f=l.getMethod(),p=l.getURL(),b=u?u.getStatus():"n/a",m=u?u.getBody()||"":"n/a";n+=", originated from request (method: ".concat(f,", url: ").concat(p,", response code: ").concat(b,", response text: ").concat(m,", request id: ").concat(c,")")}return r.message=n,r}return gr(e,t),cr(e)}(je(Error));function fe(t){"@babel/helpers - typeof";return fe=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},fe(t)}function wr(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function Ze(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,Ur(r.key),r)}}function Sr(t,e,n){return e&&Ze(t.prototype,e),n&&Ze(t,n),Object.defineProperty(t,"prototype",{writable:!1}),t}function Ur(t){var e=xr(t,"string");return fe(e)=="symbol"?e:e+""}function xr(t,e){if(fe(t)!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e||"default");if(fe(r)!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}var Pr=function(){function t(){wr(this,t)}return Sr(t,[{key:"listAllUploads",value:function(){return Promise.resolve([])}},{key:"findUploadsByFingerprint",value:function(n){return Promise.resolve([])}},{key:"removeUpload",value:function(n){return Promise.resolve()}},{key:"addUpload",value:function(n,r){return Promise.resolve(null)}}])}();const Et="3.7.7",Er=Et,oe=typeof Buffer=="function",We=typeof TextDecoder=="function"?new TextDecoder:void 0,Je=typeof TextEncoder=="function"?new TextEncoder:void 0,Or="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=",ae=Array.prototype.slice.call(Or),ge=(t=>{let e={};return t.forEach((n,r)=>e[n]=r),e})(ae),kr=/^(?:[A-Za-z\d+\/]{4})*?(?:[A-Za-z\d+\/]{2}(?:==)?|[A-Za-z\d+\/]{3}=?)?$/,k=String.fromCharCode.bind(String),Qe=typeof Uint8Array.from=="function"?Uint8Array.from.bind(Uint8Array):t=>new Uint8Array(Array.prototype.slice.call(t,0)),Ot=t=>t.replace(/=/g,"").replace(/[+\/]/g,e=>e=="+"?"-":"_"),kt=t=>t.replace(/[^A-Za-z0-9\+\/]/g,""),Rt=t=>{let e,n,r,o,l="";const u=t.length%3;for(let c=0;c<t.length;){if((n=t.charCodeAt(c++))>255||(r=t.charCodeAt(c++))>255||(o=t.charCodeAt(c++))>255)throw new TypeError("invalid character found");e=n<<16|r<<8|o,l+=ae[e>>18&63]+ae[e>>12&63]+ae[e>>6&63]+ae[e&63]}return u?l.slice(0,u-3)+"===".substring(u):l},ze=typeof btoa=="function"?t=>btoa(t):oe?t=>Buffer.from(t,"binary").toString("base64"):Rt,Te=oe?t=>Buffer.from(t).toString("base64"):t=>{let n=[];for(let r=0,o=t.length;r<o;r+=4096)n.push(k.apply(null,t.subarray(r,r+4096)));return ze(n.join(""))},be=(t,e=!1)=>e?Ot(Te(t)):Te(t),Rr=t=>{if(t.length<2){var e=t.charCodeAt(0);return e<128?t:e<2048?k(192|e>>>6)+k(128|e&63):k(224|e>>>12&15)+k(128|e>>>6&63)+k(128|e&63)}else{var e=65536+(t.charCodeAt(0)-55296)*1024+(t.charCodeAt(1)-56320);return k(240|e>>>18&7)+k(128|e>>>12&63)+k(128|e>>>6&63)+k(128|e&63)}},jr=/[\uD800-\uDBFF][\uDC00-\uDFFFF]|[^\x00-\x7F]/g,jt=t=>t.replace(jr,Rr),et=oe?t=>Buffer.from(t,"utf8").toString("base64"):Je?t=>Te(Je.encode(t)):t=>ze(jt(t)),te=(t,e=!1)=>e?Ot(et(t)):et(t),tt=t=>te(t,!0),Tr=/[\xC0-\xDF][\x80-\xBF]|[\xE0-\xEF][\x80-\xBF]{2}|[\xF0-\xF7][\x80-\xBF]{3}/g,Lr=t=>{switch(t.length){case 4:var e=(7&t.charCodeAt(0))<<18|(63&t.charCodeAt(1))<<12|(63&t.charCodeAt(2))<<6|63&t.charCodeAt(3),n=e-65536;return k((n>>>10)+55296)+k((n&1023)+56320);case 3:return k((15&t.charCodeAt(0))<<12|(63&t.charCodeAt(1))<<6|63&t.charCodeAt(2));default:return k((31&t.charCodeAt(0))<<6|63&t.charCodeAt(1))}},Tt=t=>t.replace(Tr,Lr),Lt=t=>{if(t=t.replace(/\s+/g,""),!kr.test(t))throw new TypeError("malformed base64.");t+="==".slice(2-(t.length&3));let e,n="",r,o;for(let l=0;l<t.length;)e=ge[t.charAt(l++)]<<18|ge[t.charAt(l++)]<<12|(r=ge[t.charAt(l++)])<<6|(o=ge[t.charAt(l++)]),n+=r===64?k(e>>16&255):o===64?k(e>>16&255,e>>8&255):k(e>>16&255,e>>8&255,e&255);return n},Be=typeof atob=="function"?t=>atob(kt(t)):oe?t=>Buffer.from(t,"base64").toString("binary"):Lt,Ct=oe?t=>Qe(Buffer.from(t,"base64")):t=>Qe(Be(t).split("").map(e=>e.charCodeAt(0))),At=t=>Ct(Dt(t)),Cr=oe?t=>Buffer.from(t,"base64").toString("utf8"):We?t=>We.decode(Ct(t)):t=>Tt(Be(t)),Dt=t=>kt(t.replace(/[-_]/g,e=>e=="-"?"+":"/")),Le=t=>Cr(Dt(t)),Ar=t=>{if(typeof t!="string")return!1;const e=t.replace(/\s+/g,"").replace(/={0,2}$/,"");return!/[^\s0-9a-zA-Z\+/]/.test(e)||!/[^\s0-9a-zA-Z\-_]/.test(e)},Ft=t=>({value:t,enumerable:!1,writable:!0,configurable:!0}),It=function(){const t=(e,n)=>Object.defineProperty(String.prototype,e,Ft(n));t("fromBase64",function(){return Le(this)}),t("toBase64",function(e){return te(this,e)}),t("toBase64URI",function(){return te(this,!0)}),t("toBase64URL",function(){return te(this,!0)}),t("toUint8Array",function(){return At(this)})},Nt=function(){const t=(e,n)=>Object.defineProperty(Uint8Array.prototype,e,Ft(n));t("toBase64",function(e){return be(this,e)}),t("toBase64URI",function(){return be(this,!0)}),t("toBase64URL",function(){return be(this,!0)})},Dr=()=>{It(),Nt()},Fr={version:Et,VERSION:Er,atob:Be,atobPolyfill:Lt,btoa:ze,btoaPolyfill:Rt,fromBase64:Le,toBase64:te,encode:te,encodeURI:tt,encodeURL:tt,utob:jt,btou:Tt,decode:Le,isValid:Ar,fromUint8Array:be,toUint8Array:At,extendString:It,extendUint8Array:Nt,extendBuiltins:Dr};var Ir=function(e,n){if(n=n.split(":")[0],e=+e,!e)return!1;switch(n){case"http":case"ws":return e!==80;case"https":case"wss":return e!==443;case"ftp":return e!==21;case"gopher":return e!==70;case"file":return!1}return e!==0},qe={},Nr=Object.prototype.hasOwnProperty,Hr;function rt(t){try{return decodeURIComponent(t.replace(/\+/g," "))}catch{return null}}function nt(t){try{return encodeURIComponent(t)}catch{return null}}function zr(t){for(var e=/([^=?#&]+)=?([^&]*)/g,n={},r;r=e.exec(t);){var o=rt(r[1]),l=rt(r[2]);o===null||l===null||o in n||(n[o]=l)}return n}function Br(t,e){e=e||"";var n=[],r,o;typeof e!="string"&&(e="?");for(o in t)if(Nr.call(t,o)){if(r=t[o],!r&&(r===null||r===Hr||isNaN(r))&&(r=""),o=nt(o),r=nt(r),o===null||r===null)continue;n.push(o+"="+r)}return n.length?e+n.join("&"):""}qe.stringify=Br;qe.parse=zr;var Ht=Ir,xe=qe,qr=/^[\x00-\x20\u00a0\u1680\u2000-\u200a\u2028\u2029\u202f\u205f\u3000\ufeff]+/,zt=/[\n\r\t]/g,$r=/^[A-Za-z][A-Za-z0-9+-.]*:\/\//,Bt=/:\d+$/,Mr=/^([a-z][a-z0-9.+-]*:)?(\/\/)?([\\/]+)?([\S\s]*)/i,Vr=/^[a-zA-Z]:/;function $e(t){return(t||"").toString().replace(qr,"")}var Ce=[["#","hash"],["?","query"],function(e,n){return I(n.protocol)?e.replace(/\\/g,"/"):e},["/","pathname"],["@","auth",1],[NaN,"host",void 0,1,1],[/:(\d*)$/,"port",void 0,1],[NaN,"hostname",void 0,1,1]],ot={hash:1,query:1};function qt(t){var e;typeof window<"u"?e=window:typeof Ge<"u"?e=Ge:typeof self<"u"?e=self:e={};var n=e.location||{};t=t||n;var r={},o=typeof t,l;if(t.protocol==="blob:")r=new N(unescape(t.pathname),{});else if(o==="string"){r=new N(t,{});for(l in ot)delete r[l]}else if(o==="object"){for(l in t)l in ot||(r[l]=t[l]);r.slashes===void 0&&(r.slashes=$r.test(t.href))}return r}function I(t){return t==="file:"||t==="ftp:"||t==="http:"||t==="https:"||t==="ws:"||t==="wss:"}function $t(t,e){t=$e(t),t=t.replace(zt,""),e=e||{};var n=Mr.exec(t),r=n[1]?n[1].toLowerCase():"",o=!!n[2],l=!!n[3],u=0,c;return o?l?(c=n[2]+n[3]+n[4],u=n[2].length+n[3].length):(c=n[2]+n[4],u=n[2].length):l?(c=n[3]+n[4],u=n[3].length):c=n[4],r==="file:"?u>=2&&(c=c.slice(2)):I(r)?c=n[4]:r?o&&(c=c.slice(2)):u>=2&&I(e.protocol)&&(c=n[4]),{protocol:r,slashes:o||I(r),slashesCount:u,rest:c}}function Gr(t,e){if(t==="")return e;for(var n=(e||"/").split("/").slice(0,-1).concat(t.split("/")),r=n.length,o=n[r-1],l=!1,u=0;r--;)n[r]==="."?n.splice(r,1):n[r]===".."?(n.splice(r,1),u++):u&&(r===0&&(l=!0),n.splice(r,1),u--);return l&&n.unshift(""),(o==="."||o==="..")&&n.push(""),n.join("/")}function N(t,e,n){if(t=$e(t),t=t.replace(zt,""),!(this instanceof N))return new N(t,e,n);var r,o,l,u,c,f,p=Ce.slice(),b=typeof e,m=this,C=0;for(b!=="object"&&b!=="string"&&(n=e,e=null),n&&typeof n!="function"&&(n=xe.parse),e=qt(e),o=$t(t||"",e),r=!o.protocol&&!o.slashes,m.slashes=o.slashes||r&&e.slashes,m.protocol=o.protocol||e.protocol||"",t=o.rest,(o.protocol==="file:"&&(o.slashesCount!==2||Vr.test(t))||!o.slashes&&(o.protocol||o.slashesCount<2||!I(m.protocol)))&&(p[3]=[/(.*)/,"pathname"]);C<p.length;C++){if(u=p[C],typeof u=="function"){t=u(t,m);continue}l=u[0],f=u[1],l!==l?m[f]=t:typeof l=="string"?(c=l==="@"?t.lastIndexOf(l):t.indexOf(l),~c&&(typeof u[2]=="number"?(m[f]=t.slice(0,c),t=t.slice(c+u[2])):(m[f]=t.slice(c),t=t.slice(0,c)))):(c=l.exec(t))&&(m[f]=c[1],t=t.slice(0,c.index)),m[f]=m[f]||r&&u[3]&&e[f]||"",u[4]&&(m[f]=m[f].toLowerCase())}n&&(m.query=n(m.query)),r&&e.slashes&&m.pathname.charAt(0)!=="/"&&(m.pathname!==""||e.pathname!=="")&&(m.pathname=Gr(m.pathname,e.pathname)),m.pathname.charAt(0)!=="/"&&I(m.protocol)&&(m.pathname="/"+m.pathname),Ht(m.port,m.protocol)||(m.host=m.hostname,m.port=""),m.username=m.password="",m.auth&&(c=m.auth.indexOf(":"),~c?(m.username=m.auth.slice(0,c),m.username=encodeURIComponent(decodeURIComponent(m.username)),m.password=m.auth.slice(c+1),m.password=encodeURIComponent(decodeURIComponent(m.password))):m.username=encodeURIComponent(decodeURIComponent(m.auth)),m.auth=m.password?m.username+":"+m.password:m.username),m.origin=m.protocol!=="file:"&&I(m.protocol)&&m.host?m.protocol+"//"+m.host:"null",m.href=m.toString()}function Kr(t,e,n){var r=this;switch(t){case"query":typeof e=="string"&&e.length&&(e=(n||xe.parse)(e)),r[t]=e;break;case"port":r[t]=e,Ht(e,r.protocol)?e&&(r.host=r.hostname+":"+e):(r.host=r.hostname,r[t]="");break;case"hostname":r[t]=e,r.port&&(e+=":"+r.port),r.host=e;break;case"host":r[t]=e,Bt.test(e)?(e=e.split(":"),r.port=e.pop(),r.hostname=e.join(":")):(r.hostname=e,r.port="");break;case"protocol":r.protocol=e.toLowerCase(),r.slashes=!n;break;case"pathname":case"hash":if(e){var o=t==="pathname"?"/":"#";r[t]=e.charAt(0)!==o?o+e:e}else r[t]=e;break;case"username":case"password":r[t]=encodeURIComponent(e);break;case"auth":var l=e.indexOf(":");~l?(r.username=e.slice(0,l),r.username=encodeURIComponent(decodeURIComponent(r.username)),r.password=e.slice(l+1),r.password=encodeURIComponent(decodeURIComponent(r.password))):r.username=encodeURIComponent(decodeURIComponent(e))}for(var u=0;u<Ce.length;u++){var c=Ce[u];c[4]&&(r[c[1]]=r[c[1]].toLowerCase())}return r.auth=r.password?r.username+":"+r.password:r.username,r.origin=r.protocol!=="file:"&&I(r.protocol)&&r.host?r.protocol+"//"+r.host:"null",r.href=r.toString(),r}function Xr(t){(!t||typeof t!="function")&&(t=xe.stringify);var e,n=this,r=n.host,o=n.protocol;o&&o.charAt(o.length-1)!==":"&&(o+=":");var l=o+(n.protocol&&n.slashes||I(n.protocol)?"//":"");return n.username?(l+=n.username,n.password&&(l+=":"+n.password),l+="@"):n.password?(l+=":"+n.password,l+="@"):n.protocol!=="file:"&&I(n.protocol)&&!r&&n.pathname!=="/"&&(l+="@"),(r[r.length-1]===":"||Bt.test(n.hostname)&&!n.port)&&(r+=":"),l+=r+n.pathname,e=typeof n.query=="object"?t(n.query):n.query,e&&(l+=e.charAt(0)!=="?"?"?"+e:e),n.hash&&(l+=n.hash),l}N.prototype={set:Kr,toString:Xr};N.extractProtocol=$t;N.location=qt;N.trimLeft=$e;N.qs=xe;var Yr=N;const Zr=Wt(Yr);function Wr(){return"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,function(t){var e=Math.random()*16|0,n=t==="x"?e:e&3|8;return n.toString(16)})}function Ae(){/*! regenerator-runtime -- Copyright (c) 2014-present, Facebook, Inc. -- license (MIT): https://github.com/facebook/regenerator/blob/main/LICENSE */Ae=function(){return e};var t,e={},n=Object.prototype,r=n.hasOwnProperty,o=Object.defineProperty||function(s,i,a){s[i]=a.value},l=typeof Symbol=="function"?Symbol:{},u=l.iterator||"@@iterator",c=l.asyncIterator||"@@asyncIterator",f=l.toStringTag||"@@toStringTag";function p(s,i,a){return Object.defineProperty(s,i,{value:a,enumerable:!0,configurable:!0,writable:!0}),s[i]}try{p({},"")}catch{p=function(a,h,y){return a[h]=y}}function b(s,i,a,h){var y=i&&i.prototype instanceof R?i:R,d=Object.create(y.prototype),g=new K(h||[]);return o(d,"_invoke",{value:V(s,a,g)}),d}function m(s,i,a){try{return{type:"normal",arg:s.call(i,a)}}catch(h){return{type:"throw",arg:h}}}e.wrap=b;var C="suspendedStart",M="suspendedYield",H="executing",D="completed",S={};function R(){}function j(){}function P(){}var A={};p(A,u,function(){return this});var z=Object.getPrototypeOf,_=z&&z(z(X([])));_&&_!==n&&r.call(_,u)&&(A=_);var x=P.prototype=R.prototype=Object.create(A);function E(s){["next","throw","return"].forEach(function(i){p(s,i,function(a){return this._invoke(i,a)})})}function F(s,i){function a(y,d,g,w){var U=m(s[y],s,d);if(U.type!=="throw"){var T=U.arg,O=T.value;return O&&Y(O)=="object"&&r.call(O,"__await")?i.resolve(O.__await).then(function(L){a("next",L,g,w)},function(L){a("throw",L,g,w)}):i.resolve(O).then(function(L){T.value=L,g(T)},function(L){return a("throw",L,g,w)})}w(U.arg)}var h;o(this,"_invoke",{value:function(d,g){function w(){return new i(function(U,T){a(d,g,U,T)})}return h=h?h.then(w,w):w()}})}function V(s,i,a){var h=C;return function(y,d){if(h===H)throw Error("Generator is already running");if(h===D){if(y==="throw")throw d;return{value:t,done:!0}}for(a.method=y,a.arg=d;;){var g=a.delegate;if(g){var w=ie(g,a);if(w){if(w===S)continue;return w}}if(a.method==="next")a.sent=a._sent=a.arg;else if(a.method==="throw"){if(h===C)throw h=D,a.arg;a.dispatchException(a.arg)}else a.method==="return"&&a.abrupt("return",a.arg);h=H;var U=m(s,i,a);if(U.type==="normal"){if(h=a.done?D:M,U.arg===S)continue;return{value:U.arg,done:a.done}}U.type==="throw"&&(h=D,a.method="throw",a.arg=U.arg)}}}function ie(s,i){var a=i.method,h=s.iterator[a];if(h===t)return i.delegate=null,a==="throw"&&s.iterator.return&&(i.method="return",i.arg=t,ie(s,i),i.method==="throw")||a!=="return"&&(i.method="throw",i.arg=new TypeError("The iterator does not provide a '"+a+"' method")),S;var y=m(h,s.iterator,i.arg);if(y.type==="throw")return i.method="throw",i.arg=y.arg,i.delegate=null,S;var d=y.arg;return d?d.done?(i[s.resultName]=d.value,i.next=s.nextLoc,i.method!=="return"&&(i.method="next",i.arg=t),i.delegate=null,S):d:(i.method="throw",i.arg=new TypeError("iterator result is not an object"),i.delegate=null,S)}function Pe(s){var i={tryLoc:s[0]};1 in s&&(i.catchLoc=s[1]),2 in s&&(i.finallyLoc=s[2],i.afterLoc=s[3]),this.tryEntries.push(i)}function G(s){var i=s.completion||{};i.type="normal",delete i.arg,s.completion=i}function K(s){this.tryEntries=[{tryLoc:"root"}],s.forEach(Pe,this),this.reset(!0)}function X(s){if(s||s===""){var i=s[u];if(i)return i.call(s);if(typeof s.next=="function")return s;if(!isNaN(s.length)){var a=-1,h=function y(){for(;++a<s.length;)if(r.call(s,a))return y.value=s[a],y.done=!1,y;return y.value=t,y.done=!0,y};return h.next=h}}throw new TypeError(Y(s)+" is not iterable")}return j.prototype=P,o(x,"constructor",{value:P,configurable:!0}),o(P,"constructor",{value:j,configurable:!0}),j.displayName=p(P,f,"GeneratorFunction"),e.isGeneratorFunction=function(s){var i=typeof s=="function"&&s.constructor;return!!i&&(i===j||(i.displayName||i.name)==="GeneratorFunction")},e.mark=function(s){return Object.setPrototypeOf?Object.setPrototypeOf(s,P):(s.__proto__=P,p(s,f,"GeneratorFunction")),s.prototype=Object.create(x),s},e.awrap=function(s){return{__await:s}},E(F.prototype),p(F.prototype,c,function(){return this}),e.AsyncIterator=F,e.async=function(s,i,a,h,y){y===void 0&&(y=Promise);var d=new F(b(s,i,a,h),y);return e.isGeneratorFunction(i)?d:d.next().then(function(g){return g.done?g.value:d.next()})},E(x),p(x,f,"Generator"),p(x,u,function(){return this}),p(x,"toString",function(){return"[object Generator]"}),e.keys=function(s){var i=Object(s),a=[];for(var h in i)a.push(h);return a.reverse(),function y(){for(;a.length;){var d=a.pop();if(d in i)return y.value=d,y.done=!1,y}return y.done=!0,y}},e.values=X,K.prototype={constructor:K,reset:function(i){if(this.prev=0,this.next=0,this.sent=this._sent=t,this.done=!1,this.delegate=null,this.method="next",this.arg=t,this.tryEntries.forEach(G),!i)for(var a in this)a.charAt(0)==="t"&&r.call(this,a)&&!isNaN(+a.slice(1))&&(this[a]=t)},stop:function(){this.done=!0;var i=this.tryEntries[0].completion;if(i.type==="throw")throw i.arg;return this.rval},dispatchException:function(i){if(this.done)throw i;var a=this;function h(T,O){return g.type="throw",g.arg=i,a.next=T,O&&(a.method="next",a.arg=t),!!O}for(var y=this.tryEntries.length-1;y>=0;--y){var d=this.tryEntries[y],g=d.completion;if(d.tryLoc==="root")return h("end");if(d.tryLoc<=this.prev){var w=r.call(d,"catchLoc"),U=r.call(d,"finallyLoc");if(w&&U){if(this.prev<d.catchLoc)return h(d.catchLoc,!0);if(this.prev<d.finallyLoc)return h(d.finallyLoc)}else if(w){if(this.prev<d.catchLoc)return h(d.catchLoc,!0)}else{if(!U)throw Error("try statement without catch or finally");if(this.prev<d.finallyLoc)return h(d.finallyLoc)}}}},abrupt:function(i,a){for(var h=this.tryEntries.length-1;h>=0;--h){var y=this.tryEntries[h];if(y.tryLoc<=this.prev&&r.call(y,"finallyLoc")&&this.prev<y.finallyLoc){var d=y;break}}d&&(i==="break"||i==="continue")&&d.tryLoc<=a&&a<=d.finallyLoc&&(d=null);var g=d?d.completion:{};return g.type=i,g.arg=a,d?(this.method="next",this.next=d.finallyLoc,S):this.complete(g)},complete:function(i,a){if(i.type==="throw")throw i.arg;return i.type==="break"||i.type==="continue"?this.next=i.arg:i.type==="return"?(this.rval=this.arg=i.arg,this.method="return",this.next="end"):i.type==="normal"&&a&&(this.next=a),S},finish:function(i){for(var a=this.tryEntries.length-1;a>=0;--a){var h=this.tryEntries[a];if(h.finallyLoc===i)return this.complete(h.completion,h.afterLoc),G(h),S}},catch:function(i){for(var a=this.tryEntries.length-1;a>=0;--a){var h=this.tryEntries[a];if(h.tryLoc===i){var y=h.completion;if(y.type==="throw"){var d=y.arg;G(h)}return d}}throw Error("illegal catch attempt")},delegateYield:function(i,a,h){return this.delegate={iterator:X(i),resultName:a,nextLoc:h},this.method==="next"&&(this.arg=t),S}},e}function it(t,e,n,r,o,l,u){try{var c=t[l](u),f=c.value}catch(p){n(p);return}c.done?e(f):Promise.resolve(f).then(r,o)}function Jr(t){return function(){var e=this,n=arguments;return new Promise(function(r,o){var l=t.apply(e,n);function u(f){it(l,r,o,u,c,"next",f)}function c(f){it(l,r,o,u,c,"throw",f)}u(void 0)})}}function Mt(t,e){return tn(t)||en(t,e)||Vt(t,e)||Qr()}function Qr(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function en(t,e){var n=t==null?null:typeof Symbol<"u"&&t[Symbol.iterator]||t["@@iterator"];if(n!=null){var r,o,l,u,c=[],f=!0,p=!1;try{if(l=(n=n.call(t)).next,e===0){if(Object(n)!==n)return;f=!1}else for(;!(f=(r=l.call(n)).done)&&(c.push(r.value),c.length!==e);f=!0);}catch(b){p=!0,o=b}finally{try{if(!f&&n.return!=null&&(u=n.return(),Object(u)!==u))return}finally{if(p)throw o}}return c}}function tn(t){if(Array.isArray(t))return t}function Y(t){"@babel/helpers - typeof";return Y=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},Y(t)}function rn(t,e){var n=typeof Symbol<"u"&&t[Symbol.iterator]||t["@@iterator"];if(!n){if(Array.isArray(t)||(n=Vt(t))||e&&t&&typeof t.length=="number"){n&&(t=n);var r=0,o=function(){};return{s:o,n:function(){return r>=t.length?{done:!0}:{done:!1,value:t[r++]}},e:function(p){throw p},f:o}}throw new TypeError(`Invalid attempt to iterate non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}var l=!0,u=!1,c;return{s:function(){n=n.call(t)},n:function(){var p=n.next();return l=p.done,p},e:function(p){u=!0,c=p},f:function(){try{!l&&n.return!=null&&n.return()}finally{if(u)throw c}}}}function Vt(t,e){if(t){if(typeof t=="string")return at(t,e);var n=Object.prototype.toString.call(t).slice(8,-1);if(n==="Object"&&t.constructor&&(n=t.constructor.name),n==="Map"||n==="Set")return Array.from(t);if(n==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return at(t,e)}}function at(t,e){(e==null||e>t.length)&&(e=t.length);for(var n=0,r=new Array(e);n<e;n++)r[n]=t[n];return r}function lt(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(t);e&&(r=r.filter(function(o){return Object.getOwnPropertyDescriptor(t,o).enumerable})),n.push.apply(n,r)}return n}function J(t){for(var e=1;e<arguments.length;e++){var n=arguments[e]!=null?arguments[e]:{};e%2?lt(Object(n),!0).forEach(function(r){nn(t,r,n[r])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):lt(Object(n)).forEach(function(r){Object.defineProperty(t,r,Object.getOwnPropertyDescriptor(n,r))})}return t}function nn(t,e,n){return e=Gt(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function on(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function st(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,Gt(r.key),r)}}function an(t,e,n){return e&&st(t.prototype,e),n&&st(t,n),Object.defineProperty(t,"prototype",{writable:!1}),t}function Gt(t){var e=ln(t,"string");return Y(e)=="symbol"?e:e+""}function ln(t,e){if(Y(t)!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e||"default");if(Y(r)!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}var _e="tus-v1",we="ietf-draft-03",le="ietf-draft-05",sn={endpoint:null,uploadUrl:null,metadata:{},metadataForPartialUploads:{},fingerprint:null,uploadSize:null,onProgress:null,onChunkComplete:null,onSuccess:null,onError:null,onUploadUrlAvailable:null,overridePatchMethod:!1,headers:{},addRequestId:!1,onBeforeRequest:null,onAfterResponse:null,onShouldRetry:Kt,chunkSize:Number.POSITIVE_INFINITY,retryDelays:[0,1e3,3e3,5e3],parallelUploads:1,parallelUploadBoundaries:null,storeFingerprintForResuming:!0,removeFingerprintOnSuccess:!1,uploadLengthDeferred:!1,uploadDataDuringCreation:!1,urlStorage:null,fileReader:null,httpStack:null,protocol:_e},Se=function(){function t(e,n){on(this,t),"resume"in n&&console.log("tus: The `resume` option has been removed in tus-js-client v2. Please use the URL storage API instead."),this.options=n,this.options.chunkSize=Number(this.options.chunkSize),this._urlStorage=this.options.urlStorage,this.file=e,this.url=null,this._req=null,this._fingerprint=null,this._urlStorageKey=null,this._offset=null,this._aborted=!1,this._size=null,this._source=null,this._retryAttempt=0,this._retryTimeout=null,this._offsetBeforeRetry=0,this._parallelUploads=null,this._parallelUploadUrls=null}return an(t,[{key:"findPreviousUploads",value:function(){var n=this;return this.options.fingerprint(this.file,this.options).then(function(r){return n._urlStorage.findUploadsByFingerprint(r)})}},{key:"resumeFromPreviousUpload",value:function(n){this.url=n.uploadUrl||null,this._parallelUploadUrls=n.parallelUploadUrls||null,this._urlStorageKey=n.urlStorageKey}},{key:"start",value:function(){var n=this,r=this.file;if(!r){this._emitError(new Error("tus: no file or stream to upload provided"));return}if(![_e,we,le].includes(this.options.protocol)){this._emitError(new Error("tus: unsupported protocol ".concat(this.options.protocol)));return}if(!this.options.endpoint&&!this.options.uploadUrl&&!this.url){this._emitError(new Error("tus: neither an endpoint or an upload URL is provided"));return}var o=this.options.retryDelays;if(o!=null&&Object.prototype.toString.call(o)!=="[object Array]"){this._emitError(new Error("tus: the `retryDelays` option must either be an array or null"));return}if(this.options.parallelUploads>1)for(var l=0,u=["uploadUrl","uploadSize","uploadLengthDeferred"];l<u.length;l++){var c=u[l];if(this.options[c]){this._emitError(new Error("tus: cannot use the ".concat(c," option when parallelUploads is enabled")));return}}if(this.options.parallelUploadBoundaries){if(this.options.parallelUploads<=1){this._emitError(new Error("tus: cannot use the `parallelUploadBoundaries` option when `parallelUploads` is disabled"));return}if(this.options.parallelUploads!==this.options.parallelUploadBoundaries.length){this._emitError(new Error("tus: the `parallelUploadBoundaries` must have the same length as the value of `parallelUploads`"));return}}this.options.fingerprint(r,this.options).then(function(f){return n._fingerprint=f,n._source?n._source:n.options.fileReader.openFile(r,n.options.chunkSize)}).then(function(f){if(n._source=f,n.options.uploadLengthDeferred)n._size=null;else if(n.options.uploadSize!=null){if(n._size=Number(n.options.uploadSize),Number.isNaN(n._size)){n._emitError(new Error("tus: cannot convert `uploadSize` option into a number"));return}}else if(n._size=n._source.size,n._size==null){n._emitError(new Error("tus: cannot automatically derive upload's size from input. Specify it manually using the `uploadSize` option or use the `uploadLengthDeferred` option"));return}n.options.parallelUploads>1||n._parallelUploadUrls!=null?n._startParallelUpload():n._startSingleUpload()}).catch(function(f){n._emitError(f)})}},{key:"_startParallelUpload",value:function(){var n,r=this,o=this._size,l=0;this._parallelUploads=[];var u=this._parallelUploadUrls!=null?this._parallelUploadUrls.length:this.options.parallelUploads,c=(n=this.options.parallelUploadBoundaries)!==null&&n!==void 0?n:fn(this._source.size,u);this._parallelUploadUrls&&c.forEach(function(b,m){b.uploadUrl=r._parallelUploadUrls[m]||null}),this._parallelUploadUrls=new Array(c.length);var f=c.map(function(b,m){var C=0;return r._source.slice(b.start,b.end).then(function(M){var H=M.value;return new Promise(function(D,S){var R=J(J({},r.options),{},{uploadUrl:b.uploadUrl||null,storeFingerprintForResuming:!1,removeFingerprintOnSuccess:!1,parallelUploads:1,parallelUploadBoundaries:null,metadata:r.options.metadataForPartialUploads,headers:J(J({},r.options.headers),{},{"Upload-Concat":"partial"}),onSuccess:D,onError:S,onProgress:function(A){l=l-C+A,C=A,r._emitProgress(l,o)},onUploadUrlAvailable:function(){r._parallelUploadUrls[m]=j.url,r._parallelUploadUrls.filter(function(A){return!!A}).length===c.length&&r._saveUploadInUrlStorage()}}),j=new t(H,R);j.start(),r._parallelUploads.push(j)})})}),p;Promise.all(f).then(function(){p=r._openRequest("POST",r.options.endpoint),p.setHeader("Upload-Concat","final;".concat(r._parallelUploadUrls.join(" ")));var b=ut(r.options.metadata);return b!==""&&p.setHeader("Upload-Metadata",b),r._sendRequest(p,null)}).then(function(b){if(!Q(b.getStatus(),200)){r._emitHttpError(p,b,"tus: unexpected response while creating upload");return}var m=b.getHeader("Location");if(m==null){r._emitHttpError(p,b,"tus: invalid or missing Location header");return}r.url=ht(r.options.endpoint,m),"Created upload at ".concat(r.url),r._emitSuccess(b)}).catch(function(b){r._emitError(b)})}},{key:"_startSingleUpload",value:function(){if(this._aborted=!1,this.url!=null){"Resuming upload from previous URL: ".concat(this.url),this._resumeUpload();return}if(this.options.uploadUrl!=null){"Resuming upload from provided URL: ".concat(this.options.uploadUrl),this.url=this.options.uploadUrl,this._resumeUpload();return}this._createUpload()}},{key:"abort",value:function(n){var r=this;if(this._parallelUploads!=null){var o=rn(this._parallelUploads),l;try{for(o.s();!(l=o.n()).done;){var u=l.value;u.abort(n)}}catch(c){o.e(c)}finally{o.f()}}return this._req!==null&&this._req.abort(),this._aborted=!0,this._retryTimeout!=null&&(clearTimeout(this._retryTimeout),this._retryTimeout=null),!n||this.url==null?Promise.resolve():t.terminate(this.url,this.options).then(function(){return r._removeFromUrlStorage()})}},{key:"_emitHttpError",value:function(n,r,o,l){this._emitError(new ve(o,l,n,r))}},{key:"_emitError",value:function(n){var r=this;if(!this._aborted){if(this.options.retryDelays!=null){var o=this._offset!=null&&this._offset>this._offsetBeforeRetry;if(o&&(this._retryAttempt=0),pt(n,this._retryAttempt,this.options)){var l=this.options.retryDelays[this._retryAttempt++];this._offsetBeforeRetry=this._offset,this._retryTimeout=setTimeout(function(){r.start()},l);return}}if(typeof this.options.onError=="function")this.options.onError(n);else throw n}}},{key:"_emitSuccess",value:function(n){this.options.removeFingerprintOnSuccess&&this._removeFromUrlStorage(),typeof this.options.onSuccess=="function"&&this.options.onSuccess({lastResponse:n})}},{key:"_emitProgress",value:function(n,r){typeof this.options.onProgress=="function"&&this.options.onProgress(n,r)}},{key:"_emitChunkComplete",value:function(n,r,o){typeof this.options.onChunkComplete=="function"&&this.options.onChunkComplete(n,r,o)}},{key:"_createUpload",value:function(){var n=this;if(!this.options.endpoint){this._emitError(new Error("tus: unable to create upload because no endpoint is provided"));return}var r=this._openRequest("POST",this.options.endpoint);this.options.uploadLengthDeferred?r.setHeader("Upload-Defer-Length","1"):r.setHeader("Upload-Length","".concat(this._size));var o=ut(this.options.metadata);o!==""&&r.setHeader("Upload-Metadata",o);var l;this.options.uploadDataDuringCreation&&!this.options.uploadLengthDeferred?(this._offset=0,l=this._addChunkToRequest(r)):((this.options.protocol===we||this.options.protocol===le)&&r.setHeader("Upload-Complete","?0"),l=this._sendRequest(r,null)),l.then(function(u){if(!Q(u.getStatus(),200)){n._emitHttpError(r,u,"tus: unexpected response while creating upload");return}var c=u.getHeader("Location");if(c==null){n._emitHttpError(r,u,"tus: invalid or missing Location header");return}if(n.url=ht(n.options.endpoint,c),"Created upload at ".concat(n.url),typeof n.options.onUploadUrlAvailable=="function"&&n.options.onUploadUrlAvailable(),n._size===0){n._emitSuccess(u),n._source.close();return}n._saveUploadInUrlStorage().then(function(){n.options.uploadDataDuringCreation?n._handleUploadResponse(r,u):(n._offset=0,n._performUpload())})}).catch(function(u){n._emitHttpError(r,null,"tus: failed to create upload",u)})}},{key:"_resumeUpload",value:function(){var n=this,r=this._openRequest("HEAD",this.url),o=this._sendRequest(r,null);o.then(function(l){var u=l.getStatus();if(!Q(u,200)){if(u===423){n._emitHttpError(r,l,"tus: upload is currently locked; retry later");return}if(Q(u,400)&&n._removeFromUrlStorage(),!n.options.endpoint){n._emitHttpError(r,l,"tus: unable to resume upload (new upload cannot be created without an endpoint)");return}n.url=null,n._createUpload();return}var c=Number.parseInt(l.getHeader("Upload-Offset"),10);if(Number.isNaN(c)){n._emitHttpError(r,l,"tus: invalid or missing offset value");return}var f=Number.parseInt(l.getHeader("Upload-Length"),10);if(Number.isNaN(f)&&!n.options.uploadLengthDeferred&&n.options.protocol===_e){n._emitHttpError(r,l,"tus: invalid or missing length value");return}typeof n.options.onUploadUrlAvailable=="function"&&n.options.onUploadUrlAvailable(),n._saveUploadInUrlStorage().then(function(){if(c===f){n._emitProgress(f,f),n._emitSuccess(l);return}n._offset=c,n._performUpload()})}).catch(function(l){n._emitHttpError(r,null,"tus: failed to resume upload",l)})}},{key:"_performUpload",value:function(){var n=this;if(!this._aborted){var r;this.options.overridePatchMethod?(r=this._openRequest("POST",this.url),r.setHeader("X-HTTP-Method-Override","PATCH")):r=this._openRequest("PATCH",this.url),r.setHeader("Upload-Offset","".concat(this._offset));var o=this._addChunkToRequest(r);o.then(function(l){if(!Q(l.getStatus(),200)){n._emitHttpError(r,l,"tus: unexpected response while uploading chunk");return}n._handleUploadResponse(r,l)}).catch(function(l){n._aborted||n._emitHttpError(r,null,"tus: failed to upload chunk at offset ".concat(n._offset),l)})}}},{key:"_addChunkToRequest",value:function(n){var r=this,o=this._offset,l=this._offset+this.options.chunkSize;return n.setProgressHandler(function(u){r._emitProgress(o+u,r._size)}),this.options.protocol===_e?n.setHeader("Content-Type","application/offset+octet-stream"):this.options.protocol===le&&n.setHeader("Content-Type","application/partial-upload"),(l===Number.POSITIVE_INFINITY||l>this._size)&&!this.options.uploadLengthDeferred&&(l=this._size),this._source.slice(o,l).then(function(u){var c=u.value,f=u.done,p=c!=null&&c.size?c.size:0;r.options.uploadLengthDeferred&&f&&(r._size=r._offset+p,n.setHeader("Upload-Length","".concat(r._size)));var b=r._offset+p;return!r.options.uploadLengthDeferred&&f&&b!==r._size?Promise.reject(new Error("upload was configured with a size of ".concat(r._size," bytes, but the source is done after ").concat(b," bytes"))):c===null?r._sendRequest(n):((r.options.protocol===we||r.options.protocol===le)&&n.setHeader("Upload-Complete",f?"?1":"?0"),r._emitProgress(r._offset,r._size),r._sendRequest(n,c))})}},{key:"_handleUploadResponse",value:function(n,r){var o=Number.parseInt(r.getHeader("Upload-Offset"),10);if(Number.isNaN(o)){this._emitHttpError(n,r,"tus: invalid or missing offset value");return}if(this._emitProgress(o,this._size),this._emitChunkComplete(o-this._offset,o,this._size),this._offset=o,o===this._size){this._emitSuccess(r),this._source.close();return}this._performUpload()}},{key:"_openRequest",value:function(n,r){var o=ft(n,r,this.options);return this._req=o,o}},{key:"_removeFromUrlStorage",value:function(){var n=this;this._urlStorageKey&&(this._urlStorage.removeUpload(this._urlStorageKey).catch(function(r){n._emitError(r)}),this._urlStorageKey=null)}},{key:"_saveUploadInUrlStorage",value:function(){var n=this;if(!this.options.storeFingerprintForResuming||!this._fingerprint||this._urlStorageKey!==null)return Promise.resolve();var r={size:this._size,metadata:this.options.metadata,creationTime:new Date().toString()};return this._parallelUploads?r.parallelUploadUrls=this._parallelUploadUrls:r.uploadUrl=this.url,this._urlStorage.addUpload(this._fingerprint,r).then(function(o){n._urlStorageKey=o})}},{key:"_sendRequest",value:function(n){var r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:null;return ct(n,r,this.options)}}],[{key:"terminate",value:function(n){var r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},o=ft("DELETE",n,r);return ct(o,null,r).then(function(l){if(l.getStatus()!==204)throw new ve("tus: unexpected response while terminating upload",null,o,l)}).catch(function(l){if(l instanceof ve||(l=new ve("tus: failed to terminate upload",l,o,null)),!pt(l,0,r))throw l;var u=r.retryDelays[0],c=r.retryDelays.slice(1),f=J(J({},r),{},{retryDelays:c});return new Promise(function(p){return setTimeout(p,u)}).then(function(){return t.terminate(n,f)})})}}])}();function ut(t){return Object.entries(t).map(function(e){var n=Mt(e,2),r=n[0],o=n[1];return"".concat(r," ").concat(Fr.encode(String(o)))}).join(",")}function Q(t,e){return t>=e&&t<e+100}function ft(t,e,n){var r=n.httpStack.createRequest(t,e);n.protocol===we?r.setHeader("Upload-Draft-Interop-Version","5"):n.protocol===le?r.setHeader("Upload-Draft-Interop-Version","6"):r.setHeader("Tus-Resumable","1.0.0");for(var o=n.headers||{},l=0,u=Object.entries(o);l<u.length;l++){var c=Mt(u[l],2),f=c[0],p=c[1];r.setHeader(f,p)}if(n.addRequestId){var b=Wr();r.setHeader("X-Request-ID",b)}return r}function ct(t,e,n){return De.apply(this,arguments)}function De(){return De=Jr(Ae().mark(function t(e,n,r){var o;return Ae().wrap(function(u){for(;;)switch(u.prev=u.next){case 0:if(typeof r.onBeforeRequest!="function"){u.next=3;break}return u.next=3,r.onBeforeRequest(e);case 3:return u.next=5,e.send(n);case 5:if(o=u.sent,typeof r.onAfterResponse!="function"){u.next=9;break}return u.next=9,r.onAfterResponse(e,o);case 9:return u.abrupt("return",o);case 10:case"end":return u.stop()}},t)})),De.apply(this,arguments)}function un(){var t=!0;return typeof navigator<"u"&&navigator.onLine===!1&&(t=!1),t}function pt(t,e,n){return n.retryDelays==null||e>=n.retryDelays.length||t.originalRequest==null?!1:n&&typeof n.onShouldRetry=="function"?n.onShouldRetry(t,e,n):Kt(t)}function Kt(t){var e=t.originalResponse?t.originalResponse.getStatus():0;return(!Q(e,400)||e===409||e===423)&&un()}function ht(t,e){return new Zr(e,t).toString()}function fn(t,e){for(var n=Math.floor(t/e),r=[],o=0;o<e;o++)r.push({start:n*o,end:n*(o+1)});return r[e-1].end=t,r}Se.defaultOptions=sn;var Xt=function(){return typeof navigator<"u"&&typeof navigator.product=="string"&&navigator.product.toLowerCase()==="reactnative"};function cn(t){return new Promise(function(e,n){var r=new XMLHttpRequest;r.responseType="blob",r.onload=function(){var o=r.response;e(o)},r.onerror=function(o){n(o)},r.open("GET",t),r.send()})}var pn=function(){return typeof window<"u"&&(typeof window.PhoneGap<"u"||typeof window.Cordova<"u"||typeof window.cordova<"u")};function hn(t){return new Promise(function(e,n){var r=new FileReader;r.onload=function(){var o=new Uint8Array(r.result);e({value:o})},r.onerror=function(o){n(o)},r.readAsArrayBuffer(t)})}function ce(t){"@babel/helpers - typeof";return ce=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},ce(t)}function dn(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function dt(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,mn(r.key),r)}}function yn(t,e,n){return e&&dt(t.prototype,e),n&&dt(t,n),Object.defineProperty(t,"prototype",{writable:!1}),t}function mn(t){var e=vn(t,"string");return ce(e)=="symbol"?e:e+""}function vn(t,e){if(ce(t)!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e||"default");if(ce(r)!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}var yt=function(){function t(e){dn(this,t),this._file=e,this.size=e.size}return yn(t,[{key:"slice",value:function(n,r){if(pn())return hn(this._file.slice(n,r));var o=this._file.slice(n,r),l=r>=this.size;return Promise.resolve({value:o,done:l})}},{key:"close",value:function(){}}])}();function pe(t){"@babel/helpers - typeof";return pe=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},pe(t)}function gn(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function mt(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,_n(r.key),r)}}function bn(t,e,n){return e&&mt(t.prototype,e),n&&mt(t,n),Object.defineProperty(t,"prototype",{writable:!1}),t}function _n(t){var e=wn(t,"string");return pe(e)=="symbol"?e:e+""}function wn(t,e){if(pe(t)!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e||"default");if(pe(r)!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function vt(t){return t===void 0?0:t.size!==void 0?t.size:t.length}function Sn(t,e){if(t.concat)return t.concat(e);if(t instanceof Blob)return new Blob([t,e],{type:t.type});if(t.set){var n=new t.constructor(t.length+e.length);return n.set(t),n.set(e,t.length),n}throw new Error("Unknown data type")}var Un=function(){function t(e){gn(this,t),this._buffer=void 0,this._bufferOffset=0,this._reader=e,this._done=!1}return bn(t,[{key:"slice",value:function(n,r){return n<this._bufferOffset?Promise.reject(new Error("Requested data is before the reader's current offset")):this._readUntilEnoughDataOrDone(n,r)}},{key:"_readUntilEnoughDataOrDone",value:function(n,r){var o=this,l=r<=this._bufferOffset+vt(this._buffer);if(this._done||l){var u=this._getDataFromBuffer(n,r),c=u==null?this._done:!1;return Promise.resolve({value:u,done:c})}return this._reader.read().then(function(f){var p=f.value,b=f.done;return b?o._done=!0:o._buffer===void 0?o._buffer=p:o._buffer=Sn(o._buffer,p),o._readUntilEnoughDataOrDone(n,r)})}},{key:"_getDataFromBuffer",value:function(n,r){n>this._bufferOffset&&(this._buffer=this._buffer.slice(n-this._bufferOffset),this._bufferOffset=n);var o=vt(this._buffer)===0;return this._done&&o?null:this._buffer.slice(0,r-n)}},{key:"close",value:function(){this._reader.cancel&&this._reader.cancel()}}])}();function Z(t){"@babel/helpers - typeof";return Z=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},Z(t)}function Fe(){/*! regenerator-runtime -- Copyright (c) 2014-present, Facebook, Inc. -- license (MIT): https://github.com/facebook/regenerator/blob/main/LICENSE */Fe=function(){return e};var t,e={},n=Object.prototype,r=n.hasOwnProperty,o=Object.defineProperty||function(s,i,a){s[i]=a.value},l=typeof Symbol=="function"?Symbol:{},u=l.iterator||"@@iterator",c=l.asyncIterator||"@@asyncIterator",f=l.toStringTag||"@@toStringTag";function p(s,i,a){return Object.defineProperty(s,i,{value:a,enumerable:!0,configurable:!0,writable:!0}),s[i]}try{p({},"")}catch{p=function(a,h,y){return a[h]=y}}function b(s,i,a,h){var y=i&&i.prototype instanceof R?i:R,d=Object.create(y.prototype),g=new K(h||[]);return o(d,"_invoke",{value:V(s,a,g)}),d}function m(s,i,a){try{return{type:"normal",arg:s.call(i,a)}}catch(h){return{type:"throw",arg:h}}}e.wrap=b;var C="suspendedStart",M="suspendedYield",H="executing",D="completed",S={};function R(){}function j(){}function P(){}var A={};p(A,u,function(){return this});var z=Object.getPrototypeOf,_=z&&z(z(X([])));_&&_!==n&&r.call(_,u)&&(A=_);var x=P.prototype=R.prototype=Object.create(A);function E(s){["next","throw","return"].forEach(function(i){p(s,i,function(a){return this._invoke(i,a)})})}function F(s,i){function a(y,d,g,w){var U=m(s[y],s,d);if(U.type!=="throw"){var T=U.arg,O=T.value;return O&&Z(O)=="object"&&r.call(O,"__await")?i.resolve(O.__await).then(function(L){a("next",L,g,w)},function(L){a("throw",L,g,w)}):i.resolve(O).then(function(L){T.value=L,g(T)},function(L){return a("throw",L,g,w)})}w(U.arg)}var h;o(this,"_invoke",{value:function(d,g){function w(){return new i(function(U,T){a(d,g,U,T)})}return h=h?h.then(w,w):w()}})}function V(s,i,a){var h=C;return function(y,d){if(h===H)throw Error("Generator is already running");if(h===D){if(y==="throw")throw d;return{value:t,done:!0}}for(a.method=y,a.arg=d;;){var g=a.delegate;if(g){var w=ie(g,a);if(w){if(w===S)continue;return w}}if(a.method==="next")a.sent=a._sent=a.arg;else if(a.method==="throw"){if(h===C)throw h=D,a.arg;a.dispatchException(a.arg)}else a.method==="return"&&a.abrupt("return",a.arg);h=H;var U=m(s,i,a);if(U.type==="normal"){if(h=a.done?D:M,U.arg===S)continue;return{value:U.arg,done:a.done}}U.type==="throw"&&(h=D,a.method="throw",a.arg=U.arg)}}}function ie(s,i){var a=i.method,h=s.iterator[a];if(h===t)return i.delegate=null,a==="throw"&&s.iterator.return&&(i.method="return",i.arg=t,ie(s,i),i.method==="throw")||a!=="return"&&(i.method="throw",i.arg=new TypeError("The iterator does not provide a '"+a+"' method")),S;var y=m(h,s.iterator,i.arg);if(y.type==="throw")return i.method="throw",i.arg=y.arg,i.delegate=null,S;var d=y.arg;return d?d.done?(i[s.resultName]=d.value,i.next=s.nextLoc,i.method!=="return"&&(i.method="next",i.arg=t),i.delegate=null,S):d:(i.method="throw",i.arg=new TypeError("iterator result is not an object"),i.delegate=null,S)}function Pe(s){var i={tryLoc:s[0]};1 in s&&(i.catchLoc=s[1]),2 in s&&(i.finallyLoc=s[2],i.afterLoc=s[3]),this.tryEntries.push(i)}function G(s){var i=s.completion||{};i.type="normal",delete i.arg,s.completion=i}function K(s){this.tryEntries=[{tryLoc:"root"}],s.forEach(Pe,this),this.reset(!0)}function X(s){if(s||s===""){var i=s[u];if(i)return i.call(s);if(typeof s.next=="function")return s;if(!isNaN(s.length)){var a=-1,h=function y(){for(;++a<s.length;)if(r.call(s,a))return y.value=s[a],y.done=!1,y;return y.value=t,y.done=!0,y};return h.next=h}}throw new TypeError(Z(s)+" is not iterable")}return j.prototype=P,o(x,"constructor",{value:P,configurable:!0}),o(P,"constructor",{value:j,configurable:!0}),j.displayName=p(P,f,"GeneratorFunction"),e.isGeneratorFunction=function(s){var i=typeof s=="function"&&s.constructor;return!!i&&(i===j||(i.displayName||i.name)==="GeneratorFunction")},e.mark=function(s){return Object.setPrototypeOf?Object.setPrototypeOf(s,P):(s.__proto__=P,p(s,f,"GeneratorFunction")),s.prototype=Object.create(x),s},e.awrap=function(s){return{__await:s}},E(F.prototype),p(F.prototype,c,function(){return this}),e.AsyncIterator=F,e.async=function(s,i,a,h,y){y===void 0&&(y=Promise);var d=new F(b(s,i,a,h),y);return e.isGeneratorFunction(i)?d:d.next().then(function(g){return g.done?g.value:d.next()})},E(x),p(x,f,"Generator"),p(x,u,function(){return this}),p(x,"toString",function(){return"[object Generator]"}),e.keys=function(s){var i=Object(s),a=[];for(var h in i)a.push(h);return a.reverse(),function y(){for(;a.length;){var d=a.pop();if(d in i)return y.value=d,y.done=!1,y}return y.done=!0,y}},e.values=X,K.prototype={constructor:K,reset:function(i){if(this.prev=0,this.next=0,this.sent=this._sent=t,this.done=!1,this.delegate=null,this.method="next",this.arg=t,this.tryEntries.forEach(G),!i)for(var a in this)a.charAt(0)==="t"&&r.call(this,a)&&!isNaN(+a.slice(1))&&(this[a]=t)},stop:function(){this.done=!0;var i=this.tryEntries[0].completion;if(i.type==="throw")throw i.arg;return this.rval},dispatchException:function(i){if(this.done)throw i;var a=this;function h(T,O){return g.type="throw",g.arg=i,a.next=T,O&&(a.method="next",a.arg=t),!!O}for(var y=this.tryEntries.length-1;y>=0;--y){var d=this.tryEntries[y],g=d.completion;if(d.tryLoc==="root")return h("end");if(d.tryLoc<=this.prev){var w=r.call(d,"catchLoc"),U=r.call(d,"finallyLoc");if(w&&U){if(this.prev<d.catchLoc)return h(d.catchLoc,!0);if(this.prev<d.finallyLoc)return h(d.finallyLoc)}else if(w){if(this.prev<d.catchLoc)return h(d.catchLoc,!0)}else{if(!U)throw Error("try statement without catch or finally");if(this.prev<d.finallyLoc)return h(d.finallyLoc)}}}},abrupt:function(i,a){for(var h=this.tryEntries.length-1;h>=0;--h){var y=this.tryEntries[h];if(y.tryLoc<=this.prev&&r.call(y,"finallyLoc")&&this.prev<y.finallyLoc){var d=y;break}}d&&(i==="break"||i==="continue")&&d.tryLoc<=a&&a<=d.finallyLoc&&(d=null);var g=d?d.completion:{};return g.type=i,g.arg=a,d?(this.method="next",this.next=d.finallyLoc,S):this.complete(g)},complete:function(i,a){if(i.type==="throw")throw i.arg;return i.type==="break"||i.type==="continue"?this.next=i.arg:i.type==="return"?(this.rval=this.arg=i.arg,this.method="return",this.next="end"):i.type==="normal"&&a&&(this.next=a),S},finish:function(i){for(var a=this.tryEntries.length-1;a>=0;--a){var h=this.tryEntries[a];if(h.finallyLoc===i)return this.complete(h.completion,h.afterLoc),G(h),S}},catch:function(i){for(var a=this.tryEntries.length-1;a>=0;--a){var h=this.tryEntries[a];if(h.tryLoc===i){var y=h.completion;if(y.type==="throw"){var d=y.arg;G(h)}return d}}throw Error("illegal catch attempt")},delegateYield:function(i,a,h){return this.delegate={iterator:X(i),resultName:a,nextLoc:h},this.method==="next"&&(this.arg=t),S}},e}function gt(t,e,n,r,o,l,u){try{var c=t[l](u),f=c.value}catch(p){n(p);return}c.done?e(f):Promise.resolve(f).then(r,o)}function xn(t){return function(){var e=this,n=arguments;return new Promise(function(r,o){var l=t.apply(e,n);function u(f){gt(l,r,o,u,c,"next",f)}function c(f){gt(l,r,o,u,c,"throw",f)}u(void 0)})}}function Pn(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function bt(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,On(r.key),r)}}function En(t,e,n){return e&&bt(t.prototype,e),n&&bt(t,n),Object.defineProperty(t,"prototype",{writable:!1}),t}function On(t){var e=kn(t,"string");return Z(e)=="symbol"?e:e+""}function kn(t,e){if(Z(t)!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e||"default");if(Z(r)!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}var Rn=function(){function t(){Pn(this,t)}return En(t,[{key:"openFile",value:function(){var e=xn(Fe().mark(function r(o,l){var u;return Fe().wrap(function(f){for(;;)switch(f.prev=f.next){case 0:if(!(Xt()&&o&&typeof o.uri<"u")){f.next=11;break}return f.prev=1,f.next=4,cn(o.uri);case 4:return u=f.sent,f.abrupt("return",new yt(u));case 8:throw f.prev=8,f.t0=f.catch(1),new Error("tus: cannot fetch `file.uri` as Blob, make sure the uri is correct and accessible. ".concat(f.t0));case 11:if(!(typeof o.slice=="function"&&typeof o.size<"u")){f.next=13;break}return f.abrupt("return",Promise.resolve(new yt(o)));case 13:if(typeof o.read!="function"){f.next=18;break}if(l=Number(l),Number.isFinite(l)){f.next=17;break}return f.abrupt("return",Promise.reject(new Error("cannot create source for stream without a finite value for the `chunkSize` option")));case 17:return f.abrupt("return",Promise.resolve(new Un(o,l)));case 18:return f.abrupt("return",Promise.reject(new Error("source object may only be an instance of File, Blob, or Reader in this environment")));case 19:case"end":return f.stop()}},r,null,[[1,8]])}));function n(r,o){return e.apply(this,arguments)}return n}()}])}();function jn(t,e){return Xt()?Promise.resolve(Tn(t,e)):Promise.resolve(["tus-br",t.name,t.type,t.size,t.lastModified,e.endpoint].join("-"))}function Tn(t,e){var n=t.exif?Ln(JSON.stringify(t.exif)):"noexif";return["tus-rn",t.name||"noname",t.size||"nosize",n,e.endpoint].join("/")}function Ln(t){var e=0;if(t.length===0)return e;for(var n=0;n<t.length;n++){var r=t.charCodeAt(n);e=(e<<5)-e+r,e&=e}return e}function he(t){"@babel/helpers - typeof";return he=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},he(t)}function Me(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function _t(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,Cn(r.key),r)}}function Ve(t,e,n){return e&&_t(t.prototype,e),n&&_t(t,n),Object.defineProperty(t,"prototype",{writable:!1}),t}function Cn(t){var e=An(t,"string");return he(e)=="symbol"?e:e+""}function An(t,e){if(he(t)!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e||"default");if(he(r)!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}var Dn=function(){function t(){Me(this,t)}return Ve(t,[{key:"createRequest",value:function(n,r){return new Fn(n,r)}},{key:"getName",value:function(){return"XHRHttpStack"}}])}(),Fn=function(){function t(e,n){Me(this,t),this._xhr=new XMLHttpRequest,this._xhr.open(e,n,!0),this._method=e,this._url=n,this._headers={}}return Ve(t,[{key:"getMethod",value:function(){return this._method}},{key:"getURL",value:function(){return this._url}},{key:"setHeader",value:function(n,r){this._xhr.setRequestHeader(n,r),this._headers[n]=r}},{key:"getHeader",value:function(n){return this._headers[n]}},{key:"setProgressHandler",value:function(n){"upload"in this._xhr&&(this._xhr.upload.onprogress=function(r){r.lengthComputable&&n(r.loaded)})}},{key:"send",value:function(){var n=this,r=arguments.length>0&&arguments[0]!==void 0?arguments[0]:null;return new Promise(function(o,l){n._xhr.onload=function(){o(new In(n._xhr))},n._xhr.onerror=function(u){l(u)},n._xhr.send(r)})}},{key:"abort",value:function(){return this._xhr.abort(),Promise.resolve()}},{key:"getUnderlyingObject",value:function(){return this._xhr}}])}(),In=function(){function t(e){Me(this,t),this._xhr=e}return Ve(t,[{key:"getStatus",value:function(){return this._xhr.status}},{key:"getHeader",value:function(n){return this._xhr.getResponseHeader(n)}},{key:"getBody",value:function(){return this._xhr.responseText}},{key:"getUnderlyingObject",value:function(){return this._xhr}}])}();function de(t){"@babel/helpers - typeof";return de=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},de(t)}function Nn(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function wt(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,zn(r.key),r)}}function Hn(t,e,n){return e&&wt(t.prototype,e),n&&wt(t,n),Object.defineProperty(t,"prototype",{writable:!1}),t}function zn(t){var e=Bn(t,"string");return de(e)=="symbol"?e:e+""}function Bn(t,e){if(de(t)!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e||"default");if(de(r)!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}var Ie=!1;try{Ie="localStorage"in window;var Re="tusSupport",St=localStorage.getItem(Re);localStorage.setItem(Re,St),St===null&&localStorage.removeItem(Re)}catch(t){if(t.code===t.SECURITY_ERR||t.code===t.QUOTA_EXCEEDED_ERR)Ie=!1;else throw t}var qn=Ie,$n=function(){function t(){Nn(this,t)}return Hn(t,[{key:"findAllUploads",value:function(){var n=this._findEntries("tus::");return Promise.resolve(n)}},{key:"findUploadsByFingerprint",value:function(n){var r=this._findEntries("tus::".concat(n,"::"));return Promise.resolve(r)}},{key:"removeUpload",value:function(n){return localStorage.removeItem(n),Promise.resolve()}},{key:"addUpload",value:function(n,r){var o=Math.round(Math.random()*1e12),l="tus::".concat(n,"::").concat(o);return localStorage.setItem(l,JSON.stringify(r)),Promise.resolve(l)}},{key:"_findEntries",value:function(n){for(var r=[],o=0;o<localStorage.length;o++){var l=localStorage.key(o);if(l.indexOf(n)===0)try{var u=JSON.parse(localStorage.getItem(l));u.urlStorageKey=l,r.push(u)}catch{}}return r}}])}();function ne(t){"@babel/helpers - typeof";return ne=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},ne(t)}function Mn(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function Ut(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,Zt(r.key),r)}}function Vn(t,e,n){return e&&Ut(t.prototype,e),n&&Ut(t,n),Object.defineProperty(t,"prototype",{writable:!1}),t}function Gn(t,e,n){return e=Ue(e),Kn(t,Yt()?Reflect.construct(e,n||[],Ue(t).constructor):e.apply(t,n))}function Kn(t,e){if(e&&(ne(e)==="object"||typeof e=="function"))return e;if(e!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return Xn(t)}function Xn(t){if(t===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function Yt(){try{var t=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch{}return(Yt=function(){return!!t})()}function Ue(t){return Ue=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(n){return n.__proto__||Object.getPrototypeOf(n)},Ue(t)}function Yn(t,e){if(typeof e!="function"&&e!==null)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&Ne(t,e)}function Ne(t,e){return Ne=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(r,o){return r.__proto__=o,r},Ne(t,e)}function xt(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(t);e&&(r=r.filter(function(o){return Object.getOwnPropertyDescriptor(t,o).enumerable})),n.push.apply(n,r)}return n}function ee(t){for(var e=1;e<arguments.length;e++){var n=arguments[e]!=null?arguments[e]:{};e%2?xt(Object(n),!0).forEach(function(r){Zn(t,r,n[r])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):xt(Object(n)).forEach(function(r){Object.defineProperty(t,r,Object.getOwnPropertyDescriptor(n,r))})}return t}function Zn(t,e,n){return e=Zt(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function Zt(t){var e=Wn(t,"string");return ne(e)=="symbol"?e:e+""}function Wn(t,e){if(ne(t)!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e||"default");if(ne(r)!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}var Pt=ee(ee({},Se.defaultOptions),{},{httpStack:new Dn,fileReader:new Rn,urlStorage:qn?new $n:new Pr,fingerprint:jn}),Jn=function(t){function e(){var n=arguments.length>0&&arguments[0]!==void 0?arguments[0]:null,r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};return Mn(this,e),r=ee(ee({},Pt),r),Gn(this,e,[n,r])}return Yn(e,t),Vn(e,null,[{key:"terminate",value:function(r){var o=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};return o=ee(ee({},Pt),o),Se.terminate(r,o)}}])}(Se);const Qn={components:{Footer:ar,Navbar:lr,Sidebar:sr},setup(){const t=Qt(),e=er(),n=$(null),r=e.params.courseId,o=e.params.chapterId,l=$(!1),u=$(0),c=$(!1),f=$(""),p=$({title:"",description:"",status:"",pdf_file_url:null,vimeo_id:null,player_embed_url:"",manage_link:"",vimeo_status:"",notes:[{time:"",content:""}]}),b=()=>{p.value.notes.push({time:"",content:""})},m=_=>{p.value.notes.splice(_,1)},C=()=>{try{W.removeVimeo({chapterId:o}),p.value.vimeo_id=null,p.value.player_embed_url="",p.value.manage_link="",p.value.vimeo_status=""}catch(_){console.log(_)}},M=async _=>{const x=_.target.files[0];if(x)try{c.value=!0,S.value=!0,f.value="正在獲取上傳憑證...";const E=await W.getVimeoID(o,{size:x.size}),F=new Jn(x,{uploadUrl:E.upload_link,headers:{Accept:"application/vnd.vimeo.*+json;version=3.4"},method:"PUT",chunkSize:512e4,onError:V=>{f.value=`上傳失敗: ${V.message}`,_.target.value=""},onProgress:V=>{u.value=V/x.size*100,f.value=`上傳中: ${u.value.toFixed(1)}%`},onSuccess:()=>{p.value.vimeo_id=E.vimeo_id,p.value.player_embed_url=E.player_embed_url,p.value.manage_link=E.manage_link,W.changeVimeoStatus({vimeoID:p.value.vimeo_id}),f.value="上傳完成",_.target.value="",S.value=!1}});f.value="開始上傳資料...",F.start()}catch(E){f.value=`上傳失敗: ${E.message}`,_.target.value=""}finally{c.value=!1,S.value=!1,setTimeout(()=>{u.value=0},3e3)}},H=async()=>{try{const _=await W.getChapter(r,o);p.value=_}catch(_){console.error("獲取章節數據失敗:",_),alert("獲取章節數據失敗")}},D=async()=>{l.value=!0;try{await W.updateChapter(r,o,p.value),t.push(`/course/${e.params.courseId}/chapters`)}catch(_){console.error("保存章節失敗:",_),alert("保存章節失敗")}finally{l.value=!1}},S=$(!1),R=$(""),j=()=>{t.push(`/course/${r}/chapters`)},P=async _=>{const x=_.target.files[0];if(x&&x.type==="application/pdf")try{S.value=!0,R.value="PDF上傳中...";const E=await W.chapterPDFUpload(x);E.status&&(p.value.pdf_file_url=E.content,R.value="")}catch(E){R.value="PDF上傳失敗："+E.message,_.target.value=""}finally{S.value=!1,setTimeout(()=>{R.value=""},3e3)}else R.value="請上傳PDF格式的檔案",_.target.value=""},A=()=>{p.value.pdf_file_url=null};tr(async()=>{await H(),n.value=await ur.create(document.querySelector("#editor"),{removePlugins:["Markdown"],extraPlugins:[z],toolbar:["heading","|","bold","italic","link","bulletedList","numberedList","blockQuote","imageUpload"],heading:{options:[{model:"paragraph",title:"Paragraph",class:"ck-heading_paragraph"},{model:"heading1",view:"h2",title:"Heading 1",class:"ck-heading_heading1"},{model:"heading2",view:"h3",title:"Heading 2",class:"ck-heading_heading2"}]}}).then(_=>(_.model.document.on("change:data",()=>{p.value.description=_.getData()}),_)).catch(_=>{console.error(_)})});function z(_){_.plugins.get("FileRepository").createUploadAdapter=x=>new fr(x)}return{chapter:p,isUploading:S,isLoading:l,saveChapter:D,handlePdfUpload:P,handleVideoUpload:M,removePdf:A,removeVideo:C,addNote:b,removeNote:m,route:e,uploadStatusText:R,backToChapterList:j,videoUploadStatusText:f}}},eo={class:"main-wrapper"},to={class:"page-wrapper"},ro={class:"page-content"},no={class:"row"},oo={class:"col-12"},io={class:"card mb-3"},ao={class:"card-body"},lo={key:0,class:"video-preview mb-3"},so=["src"],uo={key:1},fo={key:1,class:"mt-2"},co=["href"],po={class:"col-12 grid-margin stretch-card"},ho={class:"card"},yo={class:"card-body"},mo={class:"mb-3"},vo={class:"mb-3"},go=["innerHTML"],bo={class:"mb-3"},_o={key:0,class:"mt-2"},wo=["href"],So={key:1,class:"text-muted mt-2"},Uo={class:"mb-3"},xo={class:"col-2"},Po=["onUpdate:modelValue"],Eo={class:"col-9"},Oo=["onUpdate:modelValue"],ko={class:"col-1"},Ro=["onClick"],jo={class:"row"},To={class:"col-3"},Lo={class:"mb-3"},Co=["disabled"];function Ao(t,e,n,r,o,l){const u=Ee("Sidebar"),c=Ee("Navbar"),f=Ee("Footer");return B(),q("div",eo,[Oe(u),v("div",to,[Oe(c),v("div",ro,[v("div",no,[v("div",oo,[v("div",io,[v("div",ao,[e[10]||(e[10]=v("label",{class:"form-label"},"影片檔案",-1)),r.chapter.vimeo_id?(B(),q("div",lo,[r.chapter.vimeo_status=="vimeo_ready"?(B(),q("iframe",{key:0,src:r.chapter.player_embed_url,width:"100%",height:"600",frameborder:"0",allow:"autoplay; fullscreen; picture-in-picture; clipboard-write; encrypted-media",title:"Untitled"},null,8,so)):(B(),q("p",uo,"已上傳Vimeo，Vimeo影片處理中，您可以繼續編輯"))])):Ke("",!0),v("input",{type:"file",class:"form-control",accept:".mp4,.mov",onChange:e[0]||(e[0]=(...p)=>r.handleVideoUpload&&r.handleVideoUpload(...p))},null,32),Xe(" "+ye(r.videoUploadStatusText)+" ",1),r.chapter.vimeo_id?(B(),q("div",fo,[v("button",{type:"button",class:"btn btn-danger btn-sm",onClick:e[1]||(e[1]=(...p)=>r.removeVideo&&r.removeVideo(...p))}," 移除 "),v("a",{href:`https://vimeo.com${r.chapter.manage_link}`,target:"_blank",class:"m-2 btn btn-info btn-sm"},e[9]||(e[9]=[v("i",{class:"material-icons align-middle me-1"},"edit",-1),Xe(" Vimeo編輯 ")]),8,co)])):Ke("",!0)])])]),v("div",po,[v("div",ho,[v("div",yo,[v("form",{onSubmit:e[8]||(e[8]=rr((...p)=>r.saveChapter&&r.saveChapter(...p),["prevent"]))},[v("div",mo,[e[11]||(e[11]=v("label",{for:"title",class:"form-label"},"章節標題",-1)),me(v("input",{type:"text",class:"form-control",id:"title","onUpdate:modelValue":e[2]||(e[2]=p=>r.chapter.title=p),required:""},null,512),[[ke,r.chapter.title]])]),v("div",vo,[e[12]||(e[12]=v("label",{for:"editor",class:"form-label"},"章節內容",-1)),v("div",{id:"editor",innerHTML:r.chapter.description},null,8,go)]),v("div",bo,[e[13]||(e[13]=v("label",{class:"form-label"},"PDF檔案",-1)),v("input",{type:"file",class:"form-control",accept:".pdf",onChange:e[3]||(e[3]=(...p)=>r.handlePdfUpload&&r.handlePdfUpload(...p))},null,32),r.chapter.pdf_file_url&&!r.uploadStatusText?(B(),q("div",_o,[v("a",{href:r.chapter.pdf_file_url,target:"_blank"},"上傳檔案："+ye(typeof r.chapter.pdf_file_url=="string"?r.chapter.pdf_file_url.split("/").pop():r.chapter.pdf_file_url.name),9,wo),v("button",{type:"button",class:"btn btn-danger btn-sm ms-2",onClick:e[4]||(e[4]=(...p)=>r.removePdf&&r.removePdf(...p))}," 移除 ")])):(B(),q("div",So,ye(r.uploadStatusText),1))]),v("div",Uo,[e[14]||(e[14]=v("label",{class:"form-label"},"影片筆記",-1)),(B(!0),q(nr,null,or(r.chapter.notes,(p,b)=>(B(),q("div",{key:b,class:"row mb-2"},[v("div",xo,[me(v("input",{type:"text",class:"form-control","onUpdate:modelValue":m=>p.time=m,placeholder:"HH:mm:ss",pattern:"\\d{2}:\\d{2}:\\d{2}",title:"請輸入正確的時間格式（時:分:秒）"},null,8,Po),[[ke,p.time]])]),v("div",Eo,[me(v("input",{type:"text",class:"form-control","onUpdate:modelValue":m=>p.content=m,placeholder:"筆記內容"},null,8,Oo),[[ke,p.content]])]),v("div",ko,[v("button",{type:"button",class:"btn btn-danger btn-sm",onClick:m=>r.removeNote(b)}," 刪除 ",8,Ro)])]))),128)),v("div",jo,[v("div",To,[v("button",{type:"button",class:"btn btn-primary mt-2",onClick:e[5]||(e[5]=(...p)=>r.addNote&&r.addNote(...p))}," 新增筆記 ")])])]),v("div",Lo,[e[16]||(e[16]=v("label",{for:"status",class:"form-label"},"狀態",-1)),me(v("select",{class:"form-select",id:"status","onUpdate:modelValue":e[6]||(e[6]=p=>r.chapter.status=p)},e[15]||(e[15]=[v("option",{value:"publish"},"顯示",-1),v("option",{value:"unpublish"},"隱藏",-1)]),512),[[ir,r.chapter.status]])]),v("button",{type:"submit",class:"btn btn-primary me-2",disabled:r.isLoading||r.isUploading},ye(r.isLoading?"儲存中...":"儲存"),9,Co),v("button",{type:"button",class:"btn btn-secondary",onClick:e[7]||(e[7]=p=>r.backToChapterList())}," 取消 ")],32)])])])])]),Oe(f)])])}const No=Jt(Qn,[["render",Ao],["__scopeId","data-v-8852ad81"]]);export{No as default};
