import{_ as x,u as C,p as L,r as l,i as N,j as _,o as h,c as f,k as b,b as e,e as y,g as S,v as U,n as E,h as F,a as H}from"./index-c9f32b28.js";import{F as P,N as A,_ as T,a as w}from"./sidebar-1418a09a.js";import{C as V,U as j}from"./UploadAdapter-71b848d5.js";const B={components:{Footer:P,Navbar:A,Sidebar:T},setup(){C(),L();const g=l([]),o=l({id:null,title:"",content:"",sort:0,status:"active",type:"post"}),i=l({}),t=l(!1),a=l(""),c=l(null),r=async()=>{try{const s=await w.getPost({type:"privacy"});o.value={...s}}catch(s){console.error("Error fetching post:",s),alert("獲取文章資料失敗，請稍後再試")}},p=async()=>{var s,d;try{const n=await w.updatePost(o.value.id,o.value);a.value="儲存成功",t.value=!0}catch(n){if(console.error("Failed to save member:",n),((d=(s=n.response)==null?void 0:s.data)==null?void 0:d.status)==="error")if(n.response.data.content){const u={};for(const[k,m]of Object.entries(n.response.data.content))u[k]=Array.isArray(m)?m[0].replace(/[\[\]"]/g,""):m;i.value=u;const M=Object.values(u).join("<br/>");a.value=M,t.value=!0}else a.value=n.response.data.message||"儲存失敗",t.value=!0;else a.value="儲存失敗",t.value=!0}};N(async()=>{await r(),c.value=await V.create(document.querySelector("#editor"),{removePlugins:["Markdown"],extraPlugins:[v],toolbar:["heading","|","bold","italic","link","bulletedList","numberedList","blockQuote","imageUpload"],heading:{options:[{model:"paragraph",title:"Paragraph",class:"ck-heading_paragraph"},{model:"heading1",view:"h2",title:"Heading 1",class:"ck-heading_heading1"},{model:"heading2",view:"h3",title:"Heading 2",class:"ck-heading_heading2"}]}}).then(s=>(s.model.document.on("change:data",()=>{o.value.content=s.getData()}),s)).catch(s=>{console.error(s)})});function v(s){s.plugins.get("FileRepository").createUploadAdapter=d=>new j(d)}return{postList:g,currentpost:o,editor:c,editpost:r,savepost:p,showModal:t,modalMessage:a,errors:i}}},R={class:"main-wrapper"},z={class:"page-wrapper"},D={class:"page-content"},O={class:"row"},q={class:"col-md-12 grid-margin stretch-card"},Q={class:"card"},G={class:"card-body"},J={class:"row mb-4"},K={class:"col-12"},W={class:"col-12 my-3"},X=["innerHTML"],Y={class:"col-6"},Z={class:"col-6 d-flex align-items-end"},I={class:"modal-dialog"},$={class:"modal-content"},ee={class:"modal-header"},oe=["innerHTML"],se={class:"modal-footer"},te={key:0,class:"modal-backdrop fade show"};function ae(g,o,i,t,a,c){const r=_("Navbar"),p=_("Sidebar"),v=_("Footer");return h(),f("div",R,[b(r),b(p),e("div",z,[e("div",D,[e("div",O,[e("div",q,[e("div",Q,[e("div",G,[o[9]||(o[9]=e("h6",{class:"card-title"},"隱私權政策編輯",-1)),e("div",J,[e("div",K,[o[5]||(o[5]=e("label",{class:"form-label"},"標題",-1)),y(e("input",{type:"text",class:"form-control",disabled:"","onUpdate:modelValue":o[0]||(o[0]=s=>t.currentpost.title=s)},null,512),[[S,t.currentpost.title]])]),e("div",W,[o[6]||(o[6]=e("label",{class:"form-label"},"內容編輯",-1)),e("div",{id:"editor",innerHTML:t.currentpost.content},null,8,X)]),e("div",Y,[o[8]||(o[8]=e("label",{class:"form-label"},"狀態",-1)),y(e("select",{class:"form-select","onUpdate:modelValue":o[1]||(o[1]=s=>t.currentpost.status=s)},o[7]||(o[7]=[e("option",{value:"active"},"啟用",-1),e("option",{value:"inactive"},"停用",-1)]),512),[[U,t.currentpost.status]])]),e("div",Z,[e("button",{class:"btn btn-primary w-100",onClick:o[2]||(o[2]=(...s)=>t.savepost&&t.savepost(...s))}," 儲存變更 ")])])])])])]),b(v)])]),e("div",{class:E(["modal fade",{show:t.showModal}]),tabindex:"-1",style:F({display:t.showModal?"block":"none"})},[e("div",I,[e("div",$,[e("div",ee,[o[10]||(o[10]=e("h5",{class:"modal-title"},"錯誤提示",-1)),e("button",{type:"button",class:"btn-close",onClick:o[3]||(o[3]=s=>t.showModal=!1)})]),e("div",{class:"modal-body",innerHTML:t.modalMessage},null,8,oe),e("div",se,[e("button",{type:"button",class:"btn btn-secondary",onClick:o[4]||(o[4]=s=>t.showModal=!1)}," 關閉 ")])])])],6),t.showModal?(h(),f("div",te)):H("",!0)])}const de=x(B,[["render",ae],["__scopeId","data-v-9f51ade8"]]);export{de as default};
