import{_ as S,p as D,u as M,r as c,q as N,i as F,j as m,o as l,c as r,k as _,b as e,l as C,t as n,F as k,f as p,n as y,d as w,a as V}from"./index-d90b8e7f.js";import{F as z,N as R,_ as x,a as q}from"./sidebar-35292d72.js";import{S as B}from"./StudentDetailModal-c7bce99b.js";const L={components:{Footer:z,Navbar:R,Sidebar:x,StudentDetailModal:B},setup(){D();const s=M().params.id,u=c({name:"",email:"",created_at:""}),t=c([]),b=c(!1),g=c({chapters:[]}),i=c(1),v=c(10),d=c(1),h=N([{key:"name",label:"課程名稱"},{key:"instructor",label:"課程講師"},{key:"category",label:"分類"},{key:"completion_rate",label:"完課率"},{key:"average_score",label:"平均分數"},{key:"actions",label:"操作"}]),a=async()=>{try{const o=await q.getStudentLearningRecord(s,{page:i.value,pageSize:v.value});u.value=o.student,t.value=o.courses,d.value=o.pagination.totalPages}catch(o){console.error("Failed to fetch member info:",o)}},f=o=>{console.log("Viewing details for course:",o),g.value=o,b.value=!0},I=async o=>{i.value=o,await a()};return F(()=>{a()}),{memberId:s,memberInfo:u,tableData:t,tableColumns:h,showModal:b,selectedCourse:g,handleViewDetails:f,currentPage:i,totalPages:d,handlePageChange:I}}},j={class:"main-wrapper"},E={class:"page-wrapper"},T={class:"page-content"},A={class:"row"},G={class:"col-md-12 grid-margin stretch-card"},U={class:"card"},H={class:"card-body"},J={class:"mb-4"},K={class:"row"},O={class:"col-md-4"},Q={class:"mb-2"},W={class:"col-md-4"},X={class:"mb-2"},Y={class:"col-md-4"},Z={class:"mb-2"},$={class:"table-responsive"},ee={class:"table table-hover"},te=["onClick"],ae={key:0,class:"mt-3"},se={class:"pagination justify-content-center"},oe=["onClick"];function ne(P,s,u,t,b,g){const i=m("Sidebar"),v=m("Navbar"),d=m("StudentDetailModal"),h=m("Footer");return l(),r("div",j,[_(i),e("div",E,[_(v),e("div",T,[e("div",A,[e("div",G,[e("div",U,[e("div",H,[s[7]||(s[7]=e("h6",{class:"card-title mb-4"},"學習紀錄統計",-1)),e("div",J,[e("div",K,[e("div",O,[e("p",Q,[s[3]||(s[3]=e("strong",null,"會員名稱：",-1)),C(" "+n(t.memberInfo.name),1)])]),e("div",W,[e("p",X,[s[4]||(s[4]=e("strong",null,"Email：",-1)),C(" "+n(t.memberInfo.email),1)])]),e("div",Y,[e("p",Z,[s[5]||(s[5]=e("strong",null,"註冊日期：",-1)),C(" "+n(new Date(t.memberInfo.created_at).toLocaleDateString()),1)])])])]),e("div",$,[e("table",ee,[e("thead",null,[e("tr",null,[(l(!0),r(k,null,p(t.tableColumns,a=>(l(),r("th",{key:a.key},n(a.label),1))),128))])]),e("tbody",null,[(l(!0),r(k,null,p(t.tableData,a=>(l(),r("tr",{key:a.id},[e("td",null,n(a.name),1),e("td",null,n(a.instructor),1),e("td",null,n(a.category),1),e("td",null,n(a.completion_rate),1),e("td",null,n(a.average_score),1),e("td",null,[e("button",{class:"btn btn-sm btn-info",onClick:f=>t.handleViewDetails(a)},s[6]||(s[6]=[e("i",{class:"material-icons"},"visibility",-1)]),8,te)])]))),128))])])]),t.totalPages>1?(l(),r("nav",ae,[e("ul",se,[e("li",{class:y(["page-item",{disabled:t.currentPage===1}])},[e("a",{class:"page-link",href:"#",onClick:s[0]||(s[0]=w(a=>t.handlePageChange(t.currentPage-1),["prevent"]))},"上一頁")],2),(l(!0),r(k,null,p(t.totalPages,a=>(l(),r("li",{key:a,class:y(["page-item",{active:t.currentPage===a}])},[e("a",{class:"page-link",href:"#",onClick:w(f=>t.handlePageChange(a),["prevent"])},n(a),9,oe)],2))),128)),e("li",{class:y(["page-item",{disabled:t.currentPage===t.totalPages}])},[e("a",{class:"page-link",href:"#",onClick:s[1]||(s[1]=w(a=>t.handlePageChange(t.currentPage+1),["prevent"]))},"下一頁")],2)])])):V("",!0),_(d,{show:t.showModal,"onUpdate:show":s[2]||(s[2]=a=>t.showModal=a),studentId:t.memberId,courseId:t.selectedCourse.id,student:{name:t.memberInfo.name,email:t.memberInfo.email,courseName:t.selectedCourse?t.selectedCourse.name:"-",totalTime:t.selectedCourse?"計算中":"-",lastAccess:t.memberInfo.created_at,progress:t.selectedCourse?parseInt(t.selectedCourse.completion_rate):0,chapterProgress:t.selectedCourse.chapter,quizResults:t.selectedCourse.quizResults}},null,8,["show","studentId","courseId","student"])])])])])]),_(h)])])}const ie=S(L,[["render",ne]]);export{ie as default};
