import{_ as U,p as F,r as v,j as x,o as s,c as l,b as e,k as B,d as I,l as V,e as c,g as _,n as r,t as d,a as i,v as j,m as N,F as S}from"./index-c9105bf4.js";import{F as A,N as P,_ as T,a as q}from"./sidebar-e3f393ae.js";import{L as E}from"./loading-c728061a.js";const R={components:{Footer:A,Navbar:P,Sidebar:T,Loading:E},setup(){const p=F(),t=v({title:"",subtitle_1:"",subtitle_2:"",content:"",action_link_href:"",action_link_text:"",action_link2_href:"",action_link2_text:"",status:"active",image:null,sort:0}),D=v({}),a=v(!1),f=v(!1),y=v(""),k=v(null),h=async()=>{var b,m;a.value=!0;try{const n=new FormData;n.append("title",t.value.title),n.append("subtitle_1",t.value.subtitle_1),n.append("subtitle_2",t.value.subtitle_2),n.append("content",t.value.content),n.append("action_link_href",t.value.action_link_href),n.append("action_link_text",t.value.action_link_text),n.append("action_link2_href",t.value.action_link2_href),n.append("action_link2_text",t.value.action_link2_text),n.append("status",t.value.status),t.value.image instanceof File&&n.append("image",t.value.image),n.append("sort",t.value.sort),await q.addBanner(n),w("橫幅新增成功"),p.push("/layout/banner")}catch(n){if(((m=(b=n.response)==null?void 0:b.data)==null?void 0:m.status)==="error")if(n.response.data.content){const g={};for(const[L,M]of Object.entries(n.response.data.content))g[L]=Array.isArray(M)?M[0].replace(/[\[\]"]/g,""):M;D.value=g;const C=Object.values(g).join("<br/>");u("橫幅新增失敗："+(C||"未知錯誤"))}else u("橫幅新增失敗："+(n.response.data.message||"儲存失敗"));else u("儲存失敗")}finally{a.value=!1}},u=b=>{y.value=b,f.value=!0},w=b=>{y.value=b,f.value=!0};return{bannerData:t,addBanner:h,goBack:()=>{p.push("/layout/banner")},errors:D,isLoading:a,showModal:f,modalMessage:y,closeModal:()=>{f.value=!1},handleImageChange:b=>{const m=b.target.files[0];if(m){t.value.image=m;const n=new FileReader;n.onload=g=>{k.value=g.target.result},n.readAsDataURL(m)}},imagePreview:k,clearImage:()=>{t.value.image=null,k.value=null}}}},H={class:"main-wrapper"},O={class:"page-wrapper"},z={class:"page-content"},G={class:"row"},J={class:"col-12"},K={class:"card"},Q={class:"card-body"},W={class:"row"},X={class:"col-md-6"},Y={class:"mb-3"},Z={key:0,class:"invalid-feedback"},$={class:"mb-3"},tt={key:0,class:"invalid-feedback"},at={class:"mb-3"},et={key:0,class:"invalid-feedback"},ot={class:"mb-3"},nt={key:0,class:"invalid-feedback"},st={class:"col-md-6"},lt={class:"mb-3"},it={key:0,class:"invalid-feedback"},rt={class:"mb-3"},dt={key:0,class:"invalid-feedback"},ct={class:"mb-3"},_t={key:0,class:"invalid-feedback"},bt={class:"mb-3"},mt={key:0,class:"invalid-feedback"},vt={class:"col-md-6"},ft={class:"mb-3"},kt={key:0,class:"invalid-feedback"},ut={class:"mb-3"},gt={key:0,class:"invalid-feedback"},yt={key:1,class:"mt-2"},xt=["src"],pt={class:"mb-3"},Dt={key:0,class:"invalid-feedback"},ht={class:"mt-4"},wt=["disabled"],Mt=["disabled"],Bt={class:"modal-dialog"},Vt={class:"modal-content"},Ct={class:"modal-header"},Lt=["innerHTML"],Ut={class:"modal-footer"},Ft={key:0,class:"modal-backdrop"};function It(p,t,D,a,f,y){const k=x("Sidebar"),h=x("Navbar"),u=x("Footer"),w=x("Loading");return s(),l(S,null,[e("div",H,[B(k),e("div",O,[B(h),e("div",z,[e("div",G,[e("div",J,[e("div",K,[e("div",Q,[t[30]||(t[30]=e("h4",{class:"card-title mb-4"},"新增橫幅",-1)),e("form",{onSubmit:t[13]||(t[13]=I((...o)=>a.addBanner&&a.addBanner(...o),["prevent"])),enctype:"multipart/form-data",class:"w-100"},[e("div",W,[e("div",X,[e("div",Y,[t[16]||(t[16]=e("label",{for:"title",class:"form-label"},[V("標題 "),e("span",{class:"text-danger"},"*")],-1)),c(e("input",{type:"text",class:r(["form-control",{"is-invalid":a.errors.title}]),id:"title","onUpdate:modelValue":t[0]||(t[0]=o=>a.bannerData.title=o),required:""},null,2),[[_,a.bannerData.title]]),a.errors.title?(s(),l("div",Z,d(a.errors.title),1)):i("",!0)]),e("div",$,[t[17]||(t[17]=e("label",{for:"subtitle_1",class:"form-label"},"副標題1",-1)),c(e("input",{type:"text",class:r(["form-control",{"is-invalid":a.errors.subtitle_1}]),id:"subtitle_1","onUpdate:modelValue":t[1]||(t[1]=o=>a.bannerData.subtitle_1=o)},null,2),[[_,a.bannerData.subtitle_1]]),a.errors.subtitle_1?(s(),l("div",tt,d(a.errors.subtitle_1),1)):i("",!0)]),e("div",at,[t[18]||(t[18]=e("label",{for:"subtitle_2",class:"form-label"},"副標題2",-1)),c(e("input",{type:"text",class:r(["form-control",{"is-invalid":a.errors.subtitle_2}]),id:"subtitle_2","onUpdate:modelValue":t[2]||(t[2]=o=>a.bannerData.subtitle_2=o)},null,2),[[_,a.bannerData.subtitle_2]]),a.errors.subtitle_2?(s(),l("div",et,d(a.errors.subtitle_2),1)):i("",!0)]),e("div",ot,[t[19]||(t[19]=e("label",{for:"content",class:"form-label"},[V("內容 "),e("span",{class:"text-danger"},"*")],-1)),c(e("textarea",{class:r(["form-control",{"is-invalid":a.errors.content}]),id:"content","onUpdate:modelValue":t[3]||(t[3]=o=>a.bannerData.content=o),required:""},null,2),[[_,a.bannerData.content]]),a.errors.content?(s(),l("div",nt,d(a.errors.content),1)):i("",!0)])]),e("div",st,[e("div",lt,[t[20]||(t[20]=e("label",{for:"action_link_href",class:"form-label"},"行動連結網址",-1)),c(e("input",{type:"text",class:r(["form-control",{"is-invalid":a.errors.action_link_href}]),id:"action_link_href","onUpdate:modelValue":t[4]||(t[4]=o=>a.bannerData.action_link_href=o)},null,2),[[_,a.bannerData.action_link_href]]),a.errors.action_link_href?(s(),l("div",it,d(a.errors.action_link_href),1)):i("",!0)]),e("div",rt,[t[21]||(t[21]=e("label",{for:"action_link_text",class:"form-label"},"行動連結文字",-1)),c(e("input",{type:"text",class:r(["form-control",{"is-invalid":a.errors.action_link_text}]),id:"action_link_text","onUpdate:modelValue":t[5]||(t[5]=o=>a.bannerData.action_link_text=o)},null,2),[[_,a.bannerData.action_link_text]]),a.errors.action_link_text?(s(),l("div",dt,d(a.errors.action_link_text),1)):i("",!0)]),e("div",ct,[t[22]||(t[22]=e("label",{for:"action_link2_href",class:"form-label"},"行動連結2網址",-1)),c(e("input",{type:"text",class:r(["form-control",{"is-invalid":a.errors.action_link2_href}]),id:"action_link2_href","onUpdate:modelValue":t[6]||(t[6]=o=>a.bannerData.action_link2_href=o)},null,2),[[_,a.bannerData.action_link2_href]]),a.errors.action_link2_href?(s(),l("div",_t,d(a.errors.action_link2_href),1)):i("",!0)]),e("div",bt,[t[23]||(t[23]=e("label",{for:"action_link2_text",class:"form-label"},"行動連結2文字",-1)),c(e("input",{type:"text",class:r(["form-control",{"is-invalid":a.errors.action_link2_text}]),id:"action_link2_text","onUpdate:modelValue":t[7]||(t[7]=o=>a.bannerData.action_link2_text=o)},null,2),[[_,a.bannerData.action_link2_text]]),a.errors.action_link2_text?(s(),l("div",mt,d(a.errors.action_link2_text),1)):i("",!0)])]),e("div",vt,[e("div",ft,[t[25]||(t[25]=e("label",{for:"status",class:"form-label"},"狀態",-1)),c(e("select",{class:r(["form-select",{"is-invalid":a.errors.status}]),id:"status","onUpdate:modelValue":t[8]||(t[8]=o=>a.bannerData.status=o)},t[24]||(t[24]=[e("option",{value:"active"},"啟用",-1),e("option",{value:"inactive"},"未啟用",-1)]),2),[[j,a.bannerData.status]]),a.errors.status?(s(),l("div",kt,d(a.errors.status),1)):i("",!0)]),e("div",ut,[t[27]||(t[27]=e("label",{for:"image",class:"form-label"},[V("圖片 "),e("span",{class:"text-danger"},"*")],-1)),e("input",{type:"file",class:r(["form-control",{"is-invalid":a.errors.image}]),name:"image",id:"image",onChange:t[9]||(t[9]=(...o)=>a.handleImageChange&&a.handleImageChange(...o)),accept:".jpg,.jpeg,.gif,.png,.webp",required:""},null,34),t[28]||(t[28]=e("small",{class:"form-text text-muted"},"只能上傳 jpg、jpeg、gif、png 或 webp 格式的圖片",-1)),a.errors.image?(s(),l("div",gt,d(a.errors.image),1)):i("",!0),a.imagePreview?(s(),l("div",yt,[e("img",{src:a.imagePreview,alt:"Banner Preview",class:"img-fluid",style:{"max-width":"200px"}},null,8,xt),t[26]||(t[26]=e("br",null,null,-1)),e("button",{type:"button",class:"btn btn-sm btn-danger mt-2",onClick:t[10]||(t[10]=(...o)=>a.clearImage&&a.clearImage(...o))},"清除圖片")])):i("",!0)]),e("div",pt,[t[29]||(t[29]=e("label",{for:"sort",class:"form-label"},"排序",-1)),c(e("input",{type:"number",class:r(["form-control",{"is-invalid":a.errors.sort}]),id:"sort","onUpdate:modelValue":t[11]||(t[11]=o=>a.bannerData.sort=o)},null,2),[[_,a.bannerData.sort]]),a.errors.sort?(s(),l("div",Dt,d(a.errors.sort),1)):i("",!0)])])]),e("div",ht,[e("button",{type:"submit",class:"btn btn-primary me-2",disabled:a.isLoading},d(a.isLoading?"新增中...":"新增橫幅"),9,wt),e("button",{type:"button",class:"btn btn-secondary",onClick:t[12]||(t[12]=(...o)=>a.goBack&&a.goBack(...o)),disabled:a.isLoading}," 返回 ",8,Mt)])],32)])])])])]),B(u)])]),e("div",{class:r(["modal",{"d-block":a.showModal}]),tabindex:"-1"},[e("div",Bt,[e("div",Vt,[e("div",Ct,[t[31]||(t[31]=e("h5",{class:"modal-title"},"提示",-1)),e("button",{type:"button",class:"btn-close",onClick:t[14]||(t[14]=(...o)=>a.closeModal&&a.closeModal(...o))})]),e("div",{class:"modal-body",innerHTML:a.modalMessage},null,8,Lt),e("div",Ut,[e("button",{type:"button",class:"btn btn-secondary",onClick:t[15]||(t[15]=(...o)=>a.closeModal&&a.closeModal(...o))},"關閉")])])])],2),a.showModal?(s(),l("div",Ft)):i("",!0),a.isLoading?(s(),N(w,{key:1})):i("",!0)],64)}const qt=U(R,[["render",It],["__scopeId","data-v-95e1af8a"]]);export{qt as default};
