import{_ as F,p as N,r as v,i as S,j as b,o as i,c as l,k as p,b as t,F as A,f as C,n as f,d as k,t as r}from"./index-c9f32b28.js";import{F as x,N as j,_ as B,a as w}from"./sidebar-1418a09a.js";const M={components:{Footer:x,Navbar:j,Sidebar:B},setup(){const m=N(),s=v([]),c=v(1),e=v(1),_=10,d=async(a=1)=>{try{const o=await w.getAdmins(a,_);s.value=o.data,e.value=Math.ceil(o.total/_),c.value=a}catch(o){console.error("Failed to fetch admin data:",o)}},u=a=>{m.push(`/admins/${a}/edit`)},g=async a=>{var o,y;if(confirm("您確定要刪除這個管理員嗎？"))try{await w.deleteAdmin(a),await d(c.value)}catch(P){console.error("Failed to delete admin:",P),alert(((y=(o=P.response)==null?void 0:o.data)==null?void 0:y.message)||"刪除管理員時發生錯誤")}},h=a=>{d(a)},n=()=>{m.push("/admins/add")};return S(()=>{d()}),{admins:s,currentPage:c,totalPages:e,editAdmin:u,deleteAdmin:g,changePage:h,addAdmin:n}}},V={class:"main-wrapper"},z={class:"page-wrapper"},D={class:"page-content"},E={class:"row"},I={class:"col-12 stretch-card"},L={class:"card"},R={class:"card-body"},q={class:"d-flex justify-content-between align-items-center mb-3"},G={class:"table-responsive"},H={class:"table"},J=["onClick"],K=["onClick"],O={class:"mt-4"},Q={class:"pagination justify-content-center"},T=["onClick"];function U(m,s,c,e,_,d){const u=b("Sidebar"),g=b("Navbar"),h=b("Footer");return i(),l("div",V,[p(u),t("div",z,[p(g),t("div",D,[t("div",E,[t("div",I,[t("div",L,[t("div",R,[t("div",q,[s[3]||(s[3]=t("h6",{class:"card-title"},"管理員列表",-1)),t("button",{onClick:s[0]||(s[0]=(...n)=>e.addAdmin&&e.addAdmin(...n)),class:"btn btn-primary"},"新增管理員")]),t("div",G,[t("table",H,[s[4]||(s[4]=t("thead",null,[t("tr",null,[t("th",null,"ID"),t("th",null,"名稱"),t("th",null,"電子郵件"),t("th",null,"權限群組"),t("th",null,"操作")])],-1)),t("tbody",null,[(i(!0),l(A,null,C(e.admins,n=>(i(),l("tr",{key:n.id},[t("td",null,r(n.id),1),t("td",null,r(n.name),1),t("td",null,r(n.email),1),t("td",null,r(n.permission_group.name),1),t("td",null,[t("button",{onClick:a=>e.editAdmin(n.id),class:"btn btn-primary btn-sm me-2"}," 編輯 ",8,J),t("button",{onClick:a=>e.deleteAdmin(n.id),class:"btn btn-danger btn-sm"}," 刪除 ",8,K)])]))),128))])])]),t("nav",O,[t("ul",Q,[t("li",{class:f(["page-item",{disabled:e.currentPage===1}])},[t("a",{class:"page-link",href:"#",onClick:s[1]||(s[1]=k(n=>e.changePage(e.currentPage-1),["prevent"]))},"上一頁")],2),(i(!0),l(A,null,C(e.totalPages,n=>(i(),l("li",{key:n,class:f(["page-item",{active:e.currentPage===n}])},[t("a",{class:"page-link",href:"#",onClick:k(a=>e.changePage(n),["prevent"])},r(n),9,T)],2))),128)),t("li",{class:f(["page-item",{disabled:e.currentPage===e.totalPages}])},[t("a",{class:"page-link",href:"#",onClick:s[2]||(s[2]=k(n=>e.changePage(e.currentPage+1),["prevent"]))},"下一頁")],2)])])])])])])]),p(h)])])}const Y=F(M,[["render",U]]);export{Y as default};
