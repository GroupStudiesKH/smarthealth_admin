import{_ as C,p as y,u as k,r as v,i as N,j as u,o as r,c as l,b as t,k as p,l as w,F as h,f as x,a as F,t as b,n as S}from"./index-925fa25c.js";import{F as V,N as $,_ as B,a as f}from"./sidebar-3b877dbe.js";const I={components:{Footer:V,Navbar:$,Sidebar:B},setup(){const i=y(),s=k(),o=v([]),e=v(!1),_=()=>{i.push(`/course/${s.params.courseId}/chapter/add`)},m=n=>{i.push(`/course/${s.params.courseId}/chapter/${n}/edit`)},d=async n=>{if(confirm("確定要刪除此章節嗎？"))try{e.value=!0,await f.deleteChapter(s.params.courseId,n),o.value=o.value.filter(a=>a.id!==n),e.value=!1}catch{e.value=!1,alert("刪除章節失敗")}},c=async()=>{try{e.value=!0;const n=await f.getChapters(s.params.courseId);e.value=!1,o.value=n}catch(n){e.value=!1,alert("獲取課程列表失敗"),console.log(n)}};return N(()=>{c()}),{chapters:o,loading:e,addChapter:_,editChapter:m,deleteChapter:d}}},j={class:"main-wrapper"},L={class:"page-wrapper"},R={class:"page-content"},z={class:"row"},D={class:"col-md-12 grid-margin stretch-card"},E={class:"card"},M={class:"card-body"},T={class:"d-flex justify-content-between align-items-center mb-4"},q={class:"table-responsive"},A={class:"table table-hover"},G=["onClick"],H=["onClick"],J={key:0,class:"loading-overlay"};function K(i,s,o,e,_,m){const d=u("Navbar"),c=u("Sidebar"),n=u("Footer");return r(),l(h,null,[t("div",j,[p(d),p(c),t("div",L,[t("div",R,[t("div",z,[t("div",D,[t("div",E,[t("div",M,[t("div",T,[s[2]||(s[2]=t("h6",{class:"card-title mb-0"},"章節管理",-1)),t("button",{type:"button",class:"btn btn-primary",onClick:s[0]||(s[0]=(...a)=>e.addChapter&&e.addChapter(...a))},s[1]||(s[1]=[t("i",{class:"link-icon","data-feather":"plus"},null,-1),w(" 新增章節 ")]))]),t("div",q,[t("table",A,[s[3]||(s[3]=t("thead",null,[t("tr",null,[t("th",null,"章節標題"),t("th",null,"狀態"),t("th",null,"新增日期"),t("th",null,"操作")])],-1)),t("tbody",null,[(r(!0),l(h,null,x(e.chapters,a=>(r(),l("tr",{key:a.id},[t("td",null,b(a.title),1),t("td",null,[t("span",{class:S({"badge bg-success":a.status==="publish","badge bg-warning":a.status==="unpublish"})},b(a.status=="publish"?"公開":"未公開"),3)]),t("td",null,b(a.created_at),1),t("td",null,[t("button",{class:"btn btn-sm btn-outline-primary me-2",onClick:g=>e.editChapter(a.id)}," 編輯 ",8,G),t("button",{class:"btn btn-sm btn-outline-danger",onClick:g=>e.deleteChapter(a.id)}," 刪除 ",8,H)])]))),128))])])])])])])])]),p(n)])]),e.loading?(r(),l("div",J,s[4]||(s[4]=[t("div",{class:"loading-spinner"},[t("div",{class:"spinner-border text-primary",role:"status"},[t("span",{class:"visually-hidden"},"載入中...")]),t("div",{class:"mt-2"},"載入中...")],-1)]))):F("",!0)],64)}const Q=C(I,[["render",K]]);export{Q as default};
