import{_ as D,p as M,r as l,i as O,H as R,j as y,o as n,c as r,k as b,b as t,e as F,g as B,v as Q,F as f,f as k,l as T,t as i,a as C,n as w,d as h}from"./index-7e071105.js";import{F as A,N as L,_ as U,a as V}from"./sidebar-bb7b1f1a.js";const H={components:{Footer:A,Navbar:L,Sidebar:U},setup(){const g=M(),e=l(""),P=async()=>{try{const a=await V.getTagsOption("category");p.value=[{id:"",name:"全部"},...a]}catch(a){console.error("獲取分類失敗:",a)}},o=a=>{g.push(`/exam/edit/${a}`)},m=l(""),u=l("asc"),_=a=>{m.value===a?u.value=u.value==="asc"?"desc":"asc":(m.value=a,u.value="asc")},v=l([]),p=l([]),s=l(""),d=l(1),z=l(10),x=l(1),S=l(!1),E=async()=>{S.value=!0;try{const a={category_id:s.value==="全部"?"":s.value,search:e.value,page:d.value,pageSize:z.value},N=await V.getExamLists(a);v.value=N.courses.map(c=>({id:c.id,courseName:c.title,instructor:c.instructors.join(", "),category:c.categories.join(", "),averageScore:c.averageScore,participantsCount:c.participantsCount,createdAt:c.created_at})),x.value=N.totalPages}catch(a){console.error("獲取測驗列表失敗:",a)}finally{S.value=!1}};O(()=>{E(),P()});const j=R(()=>v.value);return{examData:v,currentPageExams:j,searchQuery:e,selectedCategory:s,categories:p,currentPage:d,totalPages:x,editExam:a=>{g.push(`/exam/edit/${a}`)},viewResult:a=>{g.push(`/exam/result/${a}`)},goToPage:a=>{d.value=a},goToExamEdit:o,toggleSort:_,sortField:m,sortOrder:u,fetchExams:E}}},q={class:"main-wrapper"},G={class:"page-wrapper"},I={class:"page-content"},J={class:"row"},K={class:"col-md-12 grid-margin stretch-card"},W={class:"card"},X={class:"card-body"},Y={class:"row mb-3"},Z={class:"col-md-5"},$={class:"col-md-5"},tt=["value"],et={class:"col-md-2"},st={class:"table-responsive"},ot={class:"table table-hover"},at={key:0,class:"material-icons align-middle",style:{"font-size":"16px"}},nt={key:0,class:"material-icons align-middle",style:{"font-size":"16px"}},rt={key:0},lt={key:1},it=["onClick"],ct=["onClick"],dt={key:0,class:"mt-3"},gt={class:"pagination justify-content-center"},ut=["onClick"];function vt(g,e,P,o,m,u){const _=y("Sidebar"),v=y("Navbar"),p=y("Footer");return n(),r("div",q,[b(_),t("div",G,[b(v),t("div",I,[t("div",J,[t("div",K,[t("div",W,[t("div",X,[e[16]||(e[16]=t("h6",{class:"card-title"},"課程測驗列表",-1)),t("div",Y,[t("div",Z,[F(t("input",{type:"text",class:"form-control mb-2","onUpdate:modelValue":e[0]||(e[0]=s=>o.searchQuery=s),placeholder:"搜尋課程名稱或講師..."},null,512),[[B,o.searchQuery]])]),t("div",$,[F(t("select",{class:"form-select","onUpdate:modelValue":e[1]||(e[1]=s=>o.selectedCategory=s)},[(n(!0),r(f,null,k(o.categories,s=>(n(),r("option",{key:s.id,value:s.id},i(s.name),9,tt))),128))],512),[[Q,o.selectedCategory]])]),t("div",et,[t("button",{class:"btn btn-primary w-100",onClick:e[2]||(e[2]=(...s)=>o.fetchExams&&o.fetchExams(...s))}," 搜尋 ")])]),t("div",st,[t("table",ot,[t("thead",null,[t("tr",null,[e[9]||(e[9]=t("th",null,"課程名稱",-1)),e[10]||(e[10]=t("th",null,"課程講師",-1)),e[11]||(e[11]=t("th",null,"分類",-1)),t("th",{onClick:e[3]||(e[3]=s=>o.toggleSort("averageScore")),style:{cursor:"pointer"}},[e[7]||(e[7]=T(" 平均分數 ")),o.sortField==="averageScore"?(n(),r("i",at,i(o.sortOrder==="asc"?"arrow_upward":"arrow_downward"),1)):C("",!0)]),t("th",{onClick:e[4]||(e[4]=s=>o.toggleSort("participantsCount")),style:{cursor:"pointer"}},[e[8]||(e[8]=T(" 參與人數 ")),o.sortField==="participantsCount"?(n(),r("i",nt,i(o.sortOrder==="asc"?"arrow_upward":"arrow_downward"),1)):C("",!0)]),e[12]||(e[12]=t("th",null,"建立時間",-1)),e[13]||(e[13]=t("th",null,"操作",-1))])]),t("tbody",null,[g.loading?(n(),r("tr",rt,e[14]||(e[14]=[t("td",{colspan:"7",class:"text-center"},"載入中...",-1)]))):o.currentPageExams.length===0?(n(),r("tr",lt,e[15]||(e[15]=[t("td",{colspan:"7",class:"text-center"},"無資料",-1)]))):(n(!0),r(f,{key:2},k(o.currentPageExams,s=>(n(),r("tr",{key:s.id},[t("td",null,i(s.courseName),1),t("td",null,i(s.instructor),1),t("td",null,i(s.category),1),t("td",null,i(s.averageScore),1),t("td",null,i(s.participantsCount),1),t("td",null,i(s.createdAt),1),t("td",null,[t("button",{class:"btn btn-primary btn-sm me-2",onClick:d=>o.editExam(s.id)}," 編輯題目 ",8,it),t("button",{class:"btn btn-info btn-sm",onClick:d=>o.viewResult(s.id)}," 檢視結果 ",8,ct)])]))),128))])])]),o.totalPages>1?(n(),r("nav",dt,[t("ul",gt,[t("li",{class:w(["page-item",{disabled:o.currentPage===1}])},[t("a",{class:"page-link",href:"#",onClick:e[5]||(e[5]=h(s=>o.goToPage(o.currentPage-1),["prevent"]))}," 上一頁 ")],2),(n(!0),r(f,null,k(o.totalPages,s=>(n(),r("li",{key:s,class:w(["page-item",{active:o.currentPage===s}])},[t("a",{class:"page-link",href:"#",onClick:h(d=>o.goToPage(s),["prevent"])},i(s),9,ut)],2))),128)),t("li",{class:w(["page-item",{disabled:o.currentPage===o.totalPages}])},[t("a",{class:"page-link",href:"#",onClick:e[6]||(e[6]=h(s=>o.goToPage(o.currentPage+1),["prevent"]))}," 下一頁 ")],2)])])):C("",!0)])])])])]),b(p)])])}const ft=D(H,[["render",vt]]);export{ft as default};
