import{_ as D,p as z,r as u,q as S,i as E,j as y,o as i,c as d,k as p,b as e,l as F,e as R,g as T,E as j,F as f,f as C,n as c,d as w,a as A,t as l}from"./index-9b074a86.js";import{F as B,N as G,_ as K,a as M}from"./sidebar-9d2c40e1.js";const L={components:{Footer:B,Navbar:G,Sidebar:K},setup(){const b=z(),s=u([]),g=u(0),a=u(1),h=u(10),m=S({keyword:""}),v=()=>{a.value=1,o()},_=()=>{m.keyword="",a.value=1,o()},k=n=>{a.value=n,o()},t=S([{key:"id",label:"編號"},{key:"name",label:"會員名稱"},{key:"birthdate",label:"生日"},{key:"email",label:"Email帳號"},{key:"created_at",label:"註冊日期"},{key:"status",label:"狀態"},{key:"actions",label:"操作"}]),o=async()=>{try{const n=await M.getMembers({page:a.value,per_page:h.value,keyword:m.keyword});s.value=n.data.map(r=>({id:r.id,name:r.name,email:r.email,birthdate:r.birthdate,created_at:r.created_at,status:r.status==="active"})),g.value=n.total,a.value=n.current_page,h.value=n.per_page}catch(n){console.error("Failed to fetch member data:",n)}},P=n=>{b.push(`/member/edit/${n}`)},N=async n=>{try{await M.memberStatus(n),o()}catch(r){console.error("Failed to toggle member status:",r)}},V=n=>{b.push(`/member/grades/${n}`)},x=()=>{b.push("/member/add")};return E(()=>{o()}),{tableData:s,tableColumns:t,totalRecords:g,currentPage:a,pageSize:h,searchForm:m,handleSearch:v,resetSearch:_,handlePageChange:k,handleEdit:P,handleToggleStatus:N,handleViewGrades:V,handleAddMember:x}}},q={class:"main-wrapper"},U={class:"page-wrapper"},H={class:"page-content"},I={class:"row"},J={class:"col-md-12 grid-margin stretch-card"},O={class:"card"},Q={class:"card-body"},W={class:"d-flex justify-content-between align-items-center mb-3"},X={class:"row mb-3"},Y={class:"col-md-6"},Z={class:"input-group"},$={class:"table-responsive"},ee={class:"table table-hover"},ae=["onClick"],te=["onClick"],se={class:"material-icons"},ne=["onClick"],oe={key:0,class:"mt-3"},le={class:"pagination justify-content-center"},re=["onClick"];function ie(b,s,g,a,h,m){const v=y("Sidebar"),_=y("Navbar"),k=y("Footer");return i(),d("div",q,[p(v),e("div",U,[p(_),e("div",H,[e("div",I,[e("div",J,[e("div",O,[e("div",Q,[e("div",W,[s[8]||(s[8]=e("h6",{class:"card-title mb-0"},"會員列表",-1)),e("button",{class:"btn btn-primary",onClick:s[0]||(s[0]=(...t)=>a.handleAddMember&&a.handleAddMember(...t))},s[7]||(s[7]=[e("i",{class:"material-icons"},"add",-1),F(" 新增會員 ")]))]),e("div",X,[e("div",Y,[e("div",Z,[R(e("input",{type:"text",class:"form-control","onUpdate:modelValue":s[1]||(s[1]=t=>a.searchForm.keyword=t),placeholder:"搜尋會員...",onKeyup:s[2]||(s[2]=j((...t)=>a.handleSearch&&a.handleSearch(...t),["enter"]))},null,544),[[T,a.searchForm.keyword]]),e("button",{class:"btn btn-outline-primary",type:"button",onClick:s[3]||(s[3]=(...t)=>a.handleSearch&&a.handleSearch(...t))},s[9]||(s[9]=[e("i",{class:"material-icons"},"search",-1)])),e("button",{class:"btn btn-outline-secondary",type:"button",onClick:s[4]||(s[4]=(...t)=>a.resetSearch&&a.resetSearch(...t))},s[10]||(s[10]=[e("i",{class:"material-icons"},"refresh",-1)]))])])]),e("div",$,[e("table",ee,[e("thead",null,[e("tr",null,[(i(!0),d(f,null,C(a.tableColumns,t=>(i(),d("th",{key:t.key},l(t.label),1))),128))])]),e("tbody",null,[(i(!0),d(f,null,C(a.tableData,t=>(i(),d("tr",{key:t.id},[e("td",null,l(t.id),1),e("td",null,l(t.name),1),e("td",null,l(t.birthdate),1),e("td",null,l(t.email),1),e("td",null,l(new Date(t.created_at).toLocaleDateString()),1),e("td",null,[e("span",{class:c(["badge",t.status?"bg-success":"bg-danger"])},l(t.status?"啟用":"停用"),3)]),e("td",null,[e("button",{class:"btn btn-sm btn-info me-1",onClick:o=>a.handleEdit(t.id)},s[11]||(s[11]=[e("i",{class:"material-icons"},"edit",-1)]),8,ae),e("button",{class:c(["btn btn-sm me-1",t.status?"btn-warning":"btn-success"]),onClick:o=>a.handleToggleStatus(t.id)},[e("i",se,l(t.status?"block":"check_circle"),1)],10,te),e("button",{class:"btn btn-sm btn-primary me-1",onClick:o=>a.handleViewGrades(t.id)},s[12]||(s[12]=[e("i",{class:"material-icons"},"school",-1),F(" 學習紀錄 ")]),8,ne)])]))),128))])])]),a.totalRecords>a.pageSize?(i(),d("nav",oe,[e("ul",le,[e("li",{class:c(["page-item",{disabled:a.currentPage===1}])},[e("a",{class:"page-link",href:"#",onClick:s[5]||(s[5]=w(t=>a.handlePageChange(a.currentPage-1),["prevent"]))}," 上一頁 ")],2),(i(!0),d(f,null,C(Math.ceil(a.totalRecords/a.pageSize),t=>(i(),d("li",{key:t,class:c(["page-item",{active:a.currentPage===t}])},[e("a",{class:"page-link",href:"#",onClick:w(o=>a.handlePageChange(t),["prevent"])},l(t),9,re)],2))),128)),e("li",{class:c(["page-item",{disabled:a.currentPage===Math.ceil(a.totalRecords/a.pageSize)}])},[e("a",{class:"page-link",href:"#",onClick:s[6]||(s[6]=w(t=>a.handlePageChange(a.currentPage+1),["prevent"]))}," 下一頁 ")],2)])])):A("",!0)])])])])]),p(k)])])}const be=D(L,[["render",ie]]);export{be as default};
