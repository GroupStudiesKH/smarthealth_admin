import{_ as N,i as x,u as C,r,j as I,k as i,o as g,c as _,b as t,l as u,d as S,e as b,g as y,a as h,y as k,p as F,F as L,m as V}from"./index-d9a4837b.js";import{F as B,N as R,_ as T}from"./sidebar-8bac9383.js";import{a as w}from"./api-service-a37f4a4e.js";import{L as U}from"./loading-2df061c6.js";const j={components:{Footer:B,Navbar:R,Sidebar:T,Loading:U},setup(){const p=x(),e=C(),d=r(""),o=r(""),c=r(null),m=r(""),n=r(!1),l=r(null);return I(async()=>{try{const s=e.params.id;n.value=!0;const a=await w.getTag(s);n.value=!1,d.value=a.name,o.value=a.description||"",a.featured_image&&(m.value=a.featured_image,l.value=null)}catch(s){console.error("獲取分類失敗:",s),n.value=!1,l.value="無法載入分類資料"}finally{n.value=!1}}),{categoryName:d,description:o,handleSubmit:async()=>{try{const s=e.params.id;n.value=!0;const a=new FormData;a.append("name",d.value),a.append("description",o.value),c.value&&a.append("featured_image",c.value),await w.editTag(s,a),n.value=!1,p.push({name:"category-list"})}catch(s){console.error("更新失敗:",s),l.value="儲存分類時發生錯誤"}},handleImageChange:s=>{const a=s.target.files[0];a&&(c.value=a,m.value=URL.createObjectURL(a))},loading:n,imagePreview:m}}},D={class:"main-wrapper"},E={class:"page-wrapper"},M={class:"page-content"},P={class:"row mb-4"},q={class:"col-md-12 grid-margin stretch-card"},O={class:"card"},z={class:"card-body"},A={class:"mb-3"},G={class:"mb-3"},H={class:"mb-3"},J={key:0,class:"mt-2"},K=["src"],Q={class:"d-flex justify-content-end"};function W(p,e,d,o,c,m){const n=i("Sidebar"),l=i("Navbar"),f=i("router-link"),v=i("Footer"),s=i("Loading");return g(),_(L,null,[t("div",D,[u(n),t("div",E,[u(l),t("div",M,[t("div",P,[t("div",q,[t("div",O,[t("div",z,[e[9]||(e[9]=t("h6",{class:"card-title"},"編輯課程分類",-1)),t("form",{onSubmit:e[3]||(e[3]=S((...a)=>o.handleSubmit&&o.handleSubmit(...a),["prevent"]))},[t("div",A,[e[4]||(e[4]=t("label",{for:"categoryName",class:"form-label"},"分類名稱",-1)),b(t("input",{type:"text",class:"form-control",id:"categoryName","onUpdate:modelValue":e[0]||(e[0]=a=>o.categoryName=a),required:""},null,512),[[y,o.categoryName]])]),t("div",G,[e[5]||(e[5]=t("label",{for:"description",class:"form-label"},"分類描述",-1)),b(t("textarea",{class:"form-control",id:"description","onUpdate:modelValue":e[1]||(e[1]=a=>o.description=a),rows:"5"},null,512),[[y,o.description]])]),t("div",H,[e[6]||(e[6]=t("label",{for:"featuredImage",class:"form-label"},"分類圖片",-1)),t("input",{type:"file",class:"form-control",id:"featuredImage",onChange:e[2]||(e[2]=(...a)=>o.handleImageChange&&o.handleImageChange(...a)),accept:"image/*"},null,32),o.imagePreview?(g(),_("div",J,[t("img",{src:o.imagePreview,class:"img-preview",alt:"分類圖片預覽"},null,8,K)])):h("",!0)]),t("div",Q,[u(f,{class:"btn btn-secondary me-2",to:{name:"category-list"}},{default:k(()=>e[7]||(e[7]=[V(" 取消 ")])),_:1}),e[8]||(e[8]=t("button",{type:"submit",class:"btn btn-primary"},"儲存",-1))])],32)])])])])]),u(v)])]),o.loading?(g(),F(s,{key:0})):h("",!0)],64)}const ee=N(j,[["render",W],["__scopeId","data-v-925280cf"]]);export{ee as default};
