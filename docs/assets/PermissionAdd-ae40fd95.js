import{_ as w,p as F,r as p,i as P,j as f,o as r,c as a,k as g,b as s,e as M,g as B,d as D,F as k,f as y,t as u,z as N}from"./index-29c103aa.js";import{F as L,N as V,_ as E,a as j}from"./sidebar-e64f0f03.js";const C={components:{Footer:L,Navbar:V,Sidebar:E},setup(){const _=F(),o=p({name:"",permissions:{}}),d=p({}),e=p(!1),b=p({}),x=async()=>{try{const t={courseManagement:{title:"課程管理",list:{"course-management":{title:"課程管理",permissions:["list","create","edit","del"]},"course-list":{title:"課程列表",permissions:["list","create","edit","del"]},"course-category":{title:"分類管理",permissions:["list","create","edit","del"]},"course-tag":{title:"標籤管理",permissions:["list","create","edit","del"]},"course-instructor":{title:"講師管理",permissions:["list","create","edit","del"]}}},memberManagement:{title:"會員管理",list:{"member-management":{title:"會員管理",permissions:["list","create","edit","del"]},"member-list":{title:"會員列表",permissions:["list","create","edit","del"]}}},statisticsManagement:{title:"課程統計",list:{"course-statistics":{title:"課程統計",permissions:["list"]},"course-progress":{title:"學習進度統計",permissions:["list"]}}},examManagement:{title:"測驗管理",list:{"exam-management":{title:"測驗管理",permissions:["list","create","edit","del"]},"exam-statistics":{title:"課程測驗列表",permissions:["list"]}}},siteSettings:{title:"網站基本設定",list:{"site-settings":{title:"網站基本設定",permissions:["list","edit"]},"site-brand":{title:"品牌設定",permissions:["list","edit"]},"site-social":{title:"社群設定",permissions:["list","edit"]}}},layoutManagement:{title:"介紹頁面管理",list:{"layout-banner-management":{title:"首頁Banner管理",permissions:["list","create","edit","del"]},"content-faq":{title:"FAQ",permissions:["edit"]},"content-about":{title:"計劃緣起",permissions:["edit"]},"content-privacy":{title:"隱私權政策",permissions:["edit"]},"content-security":{title:"資安政策",permissions:["edit"]}}},permissionManagement:{title:"權限管理",list:{permissions_group:{title:"角色管理",permissions:["list","create","edit","del"]}}}};b.value=t,o.value.permissions=Object.keys(t).reduce((i,l)=>(Object.keys(t[l].list).forEach(m=>{i[m]=[]}),i),{})}catch(t){console.error("Error fetching permission options:",t)}},v=async()=>{e.value=!0;try{d.value={},await j.addPermission(o.value)?(console.log("Permission added successfully"),_.push("/permission")):(console.error("Failed to add permission"),alert("權限新增失敗，請稍後再試。"))}catch(t){console.error("Error adding permission:",t),t.response&&t.response.data&&(d.value=t.response.data.content||{}),alert("權限新增失敗："+(t.message||"未知錯誤"))}finally{e.value=!1}},h=()=>{_.push("/permission")};return P(async()=>{await x()}),{permissionData:o,permissionStructure:b,addPermission:v,goBack:h,errors:d,isLoading:e}}},O={class:"main-wrapper"},U={class:"page-wrapper"},A={class:"page-content"},q={class:"row"},z={class:"col-12 stretch-card"},I={class:"mb-3"},Q={class:"col-12 stretch-card"},R={class:"row"},T={class:"card h-100"},G={class:"card-body"},H={class:"mb-4"},J={class:"mb-3"},W={class:"d-flex flex-wrap"},X=["id","value","onUpdate:modelValue"],Y=["for"],Z=["disabled"],$=["disabled"];function K(_,o,d,e,b,x){const v=f("Sidebar"),h=f("Navbar"),t=f("Footer");return r(),a("div",O,[g(v),s("div",U,[g(h),s("div",A,[s("div",q,[s("div",z,[s("h4",I,[M(s("input",{"onUpdate:modelValue":o[0]||(o[0]=i=>e.permissionData.name=i),class:"form-control",type:"text",placeholder:"權限名稱"},null,512),[[B,e.permissionData.name]])])]),s("div",Q,[s("form",{onSubmit:o[2]||(o[2]=D((...i)=>e.addPermission&&e.addPermission(...i),["prevent"]))},[s("div",R,[(r(!0),a(k,null,y(e.permissionStructure,(i,l)=>(r(),a("div",{class:"col-md-3 mb-3",key:l},[s("div",T,[s("div",G,[s("div",H,[s("h5",J,u(i.title),1),(r(!0),a(k,null,y(i.list,(m,c)=>(r(),a("div",{key:c,class:"mb-3"},[s("p",null,u(m.title),1),s("div",W,[(r(!0),a(k,null,y(m.permissions,n=>(r(),a("div",{key:n,class:"form-check permissionItem me-3"},[M(s("input",{class:"form-check-input",type:"checkbox",id:`${l}-${c}-${n}`,value:n,"onUpdate:modelValue":S=>e.permissionData.permissions[c]=S},null,8,X),[[N,e.permissionData.permissions[c]]]),s("label",{class:"form-check-label",for:`${l}-${c}-${n}`},u(n==="list"?"列表":n==="create"?"新增":n==="edit"?"編輯":n==="del"?"刪除":n),9,Y)]))),128))])]))),128))])])])]))),128))]),s("button",{type:"submit",class:"btn btn-primary me-2",disabled:e.isLoading},u(e.isLoading?"新增中...":"新增權限"),9,Z),s("button",{type:"button",class:"btn btn-secondary",onClick:o[1]||(o[1]=(...i)=>e.goBack&&e.goBack(...i)),disabled:e.isLoading}," 返回 ",8,$)],32)])])]),g(t)])])}const ts=w(C,[["render",K]]);export{ts as default};
