import{_ as x,i as M,r,k as E,o as d,c,b as o,m as u,d as S,e as p,g as w,z as C,l as F,y as L,a as b,t as f,n as V,h as N,F as D}from"./index-61f48f03.js";import{a as k}from"./api-service-e3b33b42.js";import{F as I,N as z,_ as B}from"./sidebar-1e893977.js";const H={components:{Footer:I,Navbar:z,Sidebar:B},setup(){const v=M(),s=r(""),m=r(""),e=r(!1),l=r(!1),i=r(""),n=r(!1),a=r(!1);return{email:s,password:m,rememberMe:e,loginForm:async()=>{var g,_;a.value=!0,n.value=!0;try{const t=await k.adminLogin({email:s.value,password:m.value});if(t&&t.original.access_token){const h=t.original.access_token;e.value?localStorage.setItem("access_token",h):sessionStorage.setItem("access_token",h);const y=await k.adminMe();sessionStorage.setItem("userData",JSON.stringify(y)),v.push("/")}else i.value="登入失敗：無效的回應格式",l.value=!0,console.error("Invalid response format:",t)}catch(t){i.value="登入失敗："+(((_=(g=t.response)==null?void 0:g.data)==null?void 0:_.message)||"未知錯誤"),l.value=!0,console.error("Login error:",t)}finally{n.value=!1,a.value=""}},showErrorModal:l,errorMessage:i,closeErrorModal:()=>{l.value=!1},isLoading:n,showHint:a}}},U={class:"main-wrapper"},q={class:"page-wrapper full-page"},P={class:"page-content d-flex align-items-center justify-content-center"},T={class:"row w-100 mx-0 auth-page"},j={class:"col-md-10 col-lg-8 col-xl-6 mx-auto"},J={class:"card"},O={class:"row"},R={class:"col-md-8 ps-md-0"},A={class:"auth-form-wrapper px-4 py-5"},G={class:"mb-3"},K={class:"mb-3"},Q={class:"form-check mb-3"},W={class:"mb-3"},X=["disabled"],Y={key:0,class:"spinner-border spinner-border-sm me-1",role:"status","aria-hidden":"true"},Z={class:"mt-3 text-info",style:{"min-height":"30px"}},$={key:0},oo={class:"modal-dialog"},so={class:"modal-content"},eo={class:"modal-header"},ao={class:"modal-body"},to={class:"modal-footer"},ro={key:0,class:"modal-backdrop fade show"};function lo(v,s,m,e,l,i){const n=E("router-link");return d(),c(D,null,[o("div",U,[o("div",q,[o("div",P,[o("div",T,[o("div",j,[o("div",J,[o("div",O,[s[12]||(s[12]=o("div",{class:"col-md-4 pe-md-0"},[o("div",{class:"auth-side-wrapper",style:{"background-image":"url('assets/images/login.webp')"}})],-1)),o("div",R,[o("div",A,[s[10]||(s[10]=o("a",{href:"#",class:"nobleui-logo d-block mb-2"},[u("Smart"),o("span",null,"Health")],-1)),s[11]||(s[11]=o("h5",{class:"text-secondary fw-normal mb-4"}," 請輸入您的帳號密碼 ",-1)),o("form",{class:"forms-sample",onSubmit:s[3]||(s[3]=S((...a)=>e.loginForm&&e.loginForm(...a),["prevent"]))},[o("div",G,[s[6]||(s[6]=o("label",{for:"userEmail",class:"form-label"},"Email",-1)),p(o("input",{type:"email",class:"form-control","onUpdate:modelValue":s[0]||(s[0]=a=>e.email=a),id:"userEmail",placeholder:"Email",required:""},null,512),[[w,e.email]])]),o("div",K,[s[7]||(s[7]=o("label",{for:"userPassword",class:"form-label"},"密碼",-1)),p(o("input",{type:"password",class:"form-control",id:"userPassword",autocomplete:"current-password","onUpdate:modelValue":s[1]||(s[1]=a=>e.password=a),placeholder:"密碼",required:""},null,512),[[w,e.password]])]),o("div",Q,[p(o("input",{type:"checkbox",class:"form-check-input",id:"authCheck","onUpdate:modelValue":s[2]||(s[2]=a=>e.rememberMe=a)},null,512),[[C,e.rememberMe]]),s[8]||(s[8]=o("label",{class:"form-check-label",for:"authCheck"}," 記住我 ",-1))]),o("div",W,[F(n,{to:"/forgot-password",class:"text-primary text-decoration-none"},{default:L(()=>s[9]||(s[9]=[u(" 忘記密碼？ ")])),_:1})]),o("div",null,[o("button",{type:"submit",class:"btn btn-primary me-2 mb-2 mb-md-0 text-white",disabled:e.isLoading},[e.isLoading?(d(),c("span",Y)):b("",!0),u(" "+f(e.isLoading?"登入中...":"登入"),1)],8,X)])],32),o("div",Z,[e.showHint?(d(),c("span",$,f(e.isLoading?"正在處理您的登入請求...":"請稍候，我們正在驗證您的帳號..."),1)):b("",!0)])])])])])])])])])]),o("div",{class:V(["modal fade",{"show d-block":e.showErrorModal}]),tabindex:"-1",style:N({display:e.showErrorModal?"block":"none"})},[o("div",oo,[o("div",so,[o("div",eo,[s[13]||(s[13]=o("h5",{class:"modal-title"},"登入錯誤",-1)),o("button",{type:"button",class:"btn-close",onClick:s[4]||(s[4]=(...a)=>e.closeErrorModal&&e.closeErrorModal(...a))})]),o("div",ao,[o("p",null,f(e.errorMessage),1)]),o("div",to,[o("button",{type:"button",class:"btn btn-secondary",onClick:s[5]||(s[5]=(...a)=>e.closeErrorModal&&e.closeErrorModal(...a))}," 關閉 ")])])])],6),e.showErrorModal?(d(),c("div",ro)):b("",!0)],64)}const po=x(H,[["render",lo]]);export{po as default};
