import{_ as N,i as T,r as s,j as F,k as _,o as l,c as d,b as e,l as y,e as B,g as D,F as k,f as w,n as C,d as P,a as L,p as V,t as v}from"./index-955d0ec7.js";import{F as j,N as E,_ as Q}from"./sidebar-0f1fc19f.js";import{L as z}from"./loading-3ea249f0.js";import{a as S}from"./api-service-28558cf5.js";const A={components:{Footer:j,Navbar:E,Sidebar:Q,Loading:z},setup(){const p=T(),t=s([]),h=s(""),a=s(1),i=s(10),c=s(!1),u=s(0),g=s(""),r=async()=>{c.value=!0;try{const o=await S.getTags({type:"tag",page:a.value,per_page:i.value,search:h.value});t.value=o.data.map(b=>({id:b.id,name:b.name,courseCount:b.courses_count,createdAt:b.created_at})),i.value=o.pagination.per_page,u.value=o.pagination.last_page,a.value=o.pagination.current_page}catch(o){console.error("獲取標籤失敗:",o)}finally{c.value=!1}},f=o=>{p.push(`/course/tag/edit/${o}`)},n=o=>{g.value=o},m=async()=>{try{await S.delTag(g.value),r(),$("#delConfirmModal").modal("hide")}catch(o){console.error("刪除標籤失敗:",o)}},x=async o=>{a.value=o,await r()},M=()=>{a.value=1,r()};return F(()=>{r()}),{categories:t,searchQuery:h,currentPage:a,pageSize:i,loading:c,totalPages:u,handleEdit:f,handleDelete:n,changePage:x,handleSearch:M,delTag:m}}},I={class:"main-wrapper"},R={class:"page-wrapper"},U={class:"page-content"},q={class:"row mb-4"},G={class:"col-md-12 grid-margin stretch-card"},H={class:"card"},J={class:"card-body"},K={class:"d-flex justify-content-between align-items-center mb-4"},O={class:"mb-3 d-flex row gap-2"},W={class:"col-md-4"},X={class:"input-group"},Y={class:"table-responsive"},Z={class:"table"},ee=["onClick"],ae=["onClick"],te={key:0,class:"mt-4"},ne={class:"pagination justify-content-center"},oe=["onClick"],se={class:"modal fade",id:"delConfirmModal",tabindex:"-1","aria-labelledby":"delConfirmModalLabel","aria-hidden":"true"},le={class:"modal-dialog"},re={class:"modal-content"},de={class:"modal-footer"};function ie(p,t,h,a,i,c){const u=_("Sidebar"),g=_("Navbar"),r=_("Footer"),f=_("Loading");return l(),d(k,null,[e("div",I,[y(u),e("div",R,[y(g),e("div",U,[e("div",q,[e("div",G,[e("div",H,[e("div",J,[e("div",K,[t[6]||(t[6]=e("h6",{class:"card-title mb-0"},"課程標籤管理",-1)),e("button",{class:"btn btn-primary",onClick:t[0]||(t[0]=n=>p.$router.push("/course/tag/add"))}," 新增標籤 ")]),e("div",O,[e("div",W,[e("div",X,[B(e("input",{type:"text",class:"form-control","onUpdate:modelValue":t[1]||(t[1]=n=>a.searchQuery=n),placeholder:"搜尋標籤名稱"},null,512),[[D,a.searchQuery]]),e("button",{class:"btn btn-primary",onClick:t[2]||(t[2]=(...n)=>a.handleSearch&&a.handleSearch(...n))}," 搜尋 ")])])]),e("div",Y,[e("table",Z,[t[7]||(t[7]=e("thead",null,[e("tr",null,[e("th",null,"標籤名稱"),e("th",null,"課程數量"),e("th",null,"建立日期"),e("th",null,"操作")])],-1)),e("tbody",null,[(l(!0),d(k,null,w(a.categories,n=>(l(),d("tr",{key:n.id},[e("td",null,v(n.name),1),e("td",null,v(n.courseCount),1),e("td",null,v(n.createdAt),1),e("td",null,[e("button",{class:"btn btn-sm btn-outline-primary me-2",onClick:m=>a.handleEdit(n.id)}," 編輯 ",8,ee),e("button",{class:"btn btn-sm btn-outline-danger",onClick:m=>a.handleDelete(n.id),"data-bs-toggle":"modal","data-bs-target":"#delConfirmModal"}," 刪除 ",8,ae)])]))),128))])])]),a.totalPages>0?(l(),d("nav",te,[e("ul",ne,[e("li",{class:C(["page-item",{disabled:a.currentPage===1}])},[e("a",{class:"page-link",href:"#",onClick:t[3]||(t[3]=P(n=>a.changePage(a.currentPage>1?a.currentPage-1:1),["prevent"]))}," 上一頁 ")],2),(l(!0),d(k,null,w(a.totalPages,n=>(l(),d("li",{key:n,class:C(["page-item",{active:a.currentPage===n}])},[e("a",{class:"page-link",href:"#",onClick:P(m=>a.changePage(n),["prevent"])},v(n),9,oe)],2))),128)),e("li",{class:C(["page-item",{disabled:a.currentPage===a.totalPages}])},[e("a",{class:"page-link",href:"#",onClick:t[4]||(t[4]=P(n=>a.changePage(a.currentPage<a.totalPages?a.currentPage+1:a.totalPages),["prevent"]))}," 下一頁 ")],2)])])):L("",!0)])])])])]),e("div",se,[e("div",le,[e("div",re,[t[9]||(t[9]=e("div",{class:"modal-header"},[e("h5",{class:"modal-title",id:"delConfirmModalLabel"},"確認刪除？"),e("button",{type:"button",class:"btn-close","data-bs-dismiss":"modal","aria-label":"btn-close"})],-1)),t[10]||(t[10]=e("div",{class:"modal-body"},"請確認是否刪除",-1)),e("div",de,[t[8]||(t[8]=e("button",{type:"button",class:"btn btn-secondary","data-bs-dismiss":"modal"}," 關閉 ",-1)),e("button",{type:"button",class:"btn btn-primary",onClick:t[5]||(t[5]=n=>a.delTag())}," 確認 ")])])])]),y(r)])]),a.loading?(l(),V(f,{key:0})):L("",!0)],64)}const be=N(A,[["render",ie],["__scopeId","data-v-aebdab3e"]]);export{be as default};
