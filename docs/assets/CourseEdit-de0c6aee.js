import{_ as B,u as P,p as j,r as c,k as I,s as O,l as w,o as n,c as i,m as k,a as e,t as u,b as x,d as b,f as S,F as g,e as h,j as F,v as z,x as A}from"./index-05809435.js";import{F as W,N as G,_ as J}from"./sidebar-79652a8d.js";import{C as K}from"./ckeditor-c277b8db.js";const X={components:{Footer:W,Navbar:G,Sidebar:J},setup(){const v=P(),t=j(),f=c(null),o=c(null),a=c({title:"",instructor:"",content:"",category:"",tags:[],chapters:[],coverImage:null}),y=["醫療資訊系統","電子病歷","醫療標準規範","醫療資料交換"],_=["FHIR","標準規範","資料交換","系統整合","實務應用"],m=c([{id:1,title:"除了資料統一，規則統一，還要有應用程式市集"},{id:2,title:"統一台灣電子病歷的策略思考"},{id:3,title:"開發FHIR工具，FHIR資料中臺實現互通"},{id:4,title:"臺灣醫中電子病歷資料統一的架構"},{id:5,title:"FHIR 統一資料，但是沒有統一規則"},{id:6,title:"FHIR 統一資料"},{id:7,title:"LOINC標準碼"},{id:8,title:"RxNorm"},{id:9,title:"SNOMED CT"},{id:10,title:"TW CDI"}]),s=c([]),d=c(""),C=c(""),L=c([{id:1,name:"王教授",specialty:"醫療資訊系統"},{id:2,name:"李博士",specialty:"電子病歷"},{id:3,name:"張醫師",specialty:"醫療標準規範"},{id:4,name:"陳工程師",specialty:"醫療資料交換"}]),N=I(()=>{const l=d.value.toLowerCase();return L.value.filter(r=>r.name.toLowerCase().includes(l)||r.specialty.toLowerCase().includes(l))}),R=I(()=>{const l=C.value.toLowerCase();return m.value.filter(r=>r.title.toLowerCase().includes(l))}),T=l=>{a.value.instructor=l.name,d.value=""},U=()=>{a.value.chapters.push({id:null,title:"",order:a.value.chapters.length+1})},V=l=>{a.value.chapters.splice(l,1),a.value.chapters.forEach((r,p)=>{r.order=p+1})},E=l=>m.value.filter(r=>r.title.toLowerCase().includes(l.toLowerCase())),M=(l,r)=>{a.value.chapters[l].id=r.id,a.value.chapters[l].title=r.title,a.value.chapters[l].searchQuery=r.title},Q=()=>{console.log("儲存課程",a.value),t.push("/course/list")},q=l=>{const r=l.target.files[0];if(r){const p=new FileReader;p.onload=H=>{o.value=H.target.result,a.value.coverImage=r},p.readAsDataURL(r)}},D=()=>{o.value=null,a.value.coverImage=null};return O(()=>{f.value=K.create(document.querySelector("#editor")).catch(r=>{console.error(r)}),v.params.id&&(a.value={title:"基礎健康管理課程",instructor:"王大明",content:"課程簡介內容...",category:"健康管理",tags:["基礎","入門"],chapters:[{title:"第一章：健康管理概論",content:"章節內容...",order:1}]},s.value=a.value.tags)}),{course:a,categories:y,availableTags:_,selectedTags:s,addChapter:U,removeChapter:V,saveCourse:Q,route:v,handleCoverImageUpload:q,removeCoverImage:D,coverImagePreview:o,editor:f,instructorSearchQuery:d,chapterSearchQuery:C,filteredInstructors:N,filteredChapters:R,selectInstructor:T,getFilteredChapters:E,selectChapter:M}}},Y={class:"main-wrapper"},Z={class:"page-wrapper"},$={class:"page-content"},ee={class:"row mb-4"},te={class:"col-12 mx-auto stretch-card"},se={class:"card"},oe={class:"card-body"},re={class:"card-title"},le={class:"mb-3"},ae={class:"mb-3"},ne={class:"position-relative"},ie={key:0,class:"dropdown-menu show position-absolute w-100",style:{"z-index":"1000"}},ce=["onClick"],de={key:0,class:"mt-2"},ue={class:"mb-3"},ve=["value"],me={class:"mb-3"},pe={class:"d-flex flex-wrap gap-2"},be=["id","value"],fe=["for"],_e={class:"mb-3"},ge={class:"cover-image-container"},he={key:0,class:"cover-preview"},ye=["src"],Ce={key:1,class:"upload-placeholder"},Ie={class:"d-flex justify-content-end gap-2"};function we(v,t,f,o,a,y){const _=w("Sidebar"),m=w("Navbar");return n(),i("div",Y,[k(_),e("div",Z,[k(m),e("div",$,[e("div",ee,[e("div",te,[e("div",se,[e("div",oe,[e("h6",re,u(o.route.params.id?"編輯課程":"新增課程"),1),e("form",{onSubmit:t[7]||(t[7]=x((...s)=>o.saveCourse&&o.saveCourse(...s),["prevent"]))},[e("div",le,[t[8]||(t[8]=e("label",{class:"form-label"},"課程標題",-1)),b(e("input",{type:"text",class:"form-control","onUpdate:modelValue":t[0]||(t[0]=s=>o.course.title=s),required:""},null,512),[[S,o.course.title]])]),e("div",ae,[t[9]||(t[9]=e("label",{class:"form-label"},"講師",-1)),e("div",ne,[b(e("input",{type:"text",class:"form-control","onUpdate:modelValue":t[1]||(t[1]=s=>o.instructorSearchQuery=s),placeholder:"搜尋講師..."},null,512),[[S,o.instructorSearchQuery]]),o.instructorSearchQuery&&o.filteredInstructors.length>0?(n(),i("div",ie,[(n(!0),i(g,null,h(o.filteredInstructors,s=>(n(),i("a",{key:s.id,class:"dropdown-item",href:"#",onClick:x(d=>o.selectInstructor(s),["prevent"])},u(s.name)+" ("+u(s.specialty)+") ",9,ce))),128))])):F("",!0)]),o.course.instructor?(n(),i("div",de," 已選擇講師："+u(o.course.instructor),1)):F("",!0)]),e("div",ue,[t[11]||(t[11]=e("label",{class:"form-label"},"課程分類",-1)),b(e("select",{class:"form-select","onUpdate:modelValue":t[2]||(t[2]=s=>o.course.category=s),required:""},[t[10]||(t[10]=e("option",{value:""},"請選擇分類",-1)),(n(!0),i(g,null,h(o.categories,s=>(n(),i("option",{key:s,value:s},u(s),9,ve))),128))],512),[[z,o.course.category]])]),t[15]||(t[15]=e("div",{class:"mb-3"},[e("label",{class:"form-label"},"課程簡介"),e("div",{id:"editor"})],-1)),e("div",me,[t[12]||(t[12]=e("label",{class:"form-label"},"課程標籤",-1)),e("div",pe,[(n(!0),i(g,null,h(o.availableTags,s=>(n(),i("div",{key:s,class:"form-check"},[b(e("input",{type:"checkbox",class:"form-check-input",id:`tag-${s}`,value:s,"onUpdate:modelValue":t[3]||(t[3]=d=>o.selectedTags=d)},null,8,be),[[A,o.selectedTags]]),e("label",{class:"form-check-label",for:`tag-${s}`},u(s),9,fe)]))),128))])]),e("div",_e,[t[13]||(t[13]=e("label",{class:"form-label"},"課程封面照片",-1)),e("div",ge,[o.coverImagePreview?(n(),i("div",he,[e("img",{src:o.coverImagePreview,alt:"課程封面預覽"},null,8,ye),e("button",{type:"button",class:"btn btn-danger btn-sm",onClick:t[4]||(t[4]=(...s)=>o.removeCoverImage&&o.removeCoverImage(...s))}," 移除封面 ")])):(n(),i("div",Ce,[e("input",{type:"file",class:"form-control",accept:"image/*",onChange:t[5]||(t[5]=(...s)=>o.handleCoverImageUpload&&o.handleCoverImageUpload(...s))},null,32)]))])]),e("div",Ie,[e("button",{type:"button",class:"btn btn-secondary",onClick:t[6]||(t[6]=s=>v.router.push("/course/list"))}," 取消 "),t[14]||(t[14]=e("button",{type:"submit",class:"btn btn-primary"},"儲存",-1))])],32)])])])])])])])}const Fe=B(X,[["render",we],["__scopeId","data-v-60389bbf"]]);export{Fe as default};
