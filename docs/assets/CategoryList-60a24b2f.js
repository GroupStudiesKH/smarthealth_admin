import{_ as F,p as L,r as o,i as T,j as h,o as l,c as r,b as e,k as y,e as D,g as V,F as f,f as P,n as C,d as k,a as w,t as m}from"./index-adc0a2d3.js";import{F as j,N as B,_ as E,a as x}from"./sidebar-d8222704.js";const Q={components:{Footer:j,Navbar:B,Sidebar:E},setup(){const _=L(),a=o([]),p=o(""),t=o(1),i=o(10),c=o(!1),u=o(0),g=o(""),d=async()=>{c.value=!0;try{const n=await x.getTags({type:"category",page:t.value,per_page:i.value,search:p.value});a.value=n.data.map(v=>({id:v.id,name:v.name,courseCount:v.courses_count,createdAt:v.created_at})),i.value=n.pagination.per_page,u.value=n.pagination.last_page,t.value=n.pagination.current_page}catch(n){console.error("獲取分類失敗:",n)}finally{c.value=!1}},s=n=>{_.push(`/course/category/edit/${n}`)},b=n=>{g.value=n},S=async()=>{try{await x.delTag(g.value),d(),$("#delConfirmModal").modal("hide")}catch(n){console.error("刪除標籤失敗:",n)}},M=async n=>{t.value=n,await d()},N=()=>{t.value=1,d()};return T(()=>{d()}),{categories:a,searchQuery:p,currentPage:t,pageSize:i,loading:c,totalPages:u,handleEdit:s,handleDelete:b,changePage:M,handleSearch:N,delTag:S}}},z={class:"main-wrapper"},A={class:"page-wrapper"},I={class:"page-content"},R={class:"row mb-4"},U={class:"col-md-12 grid-margin stretch-card"},q={class:"card"},G={class:"card-body"},H={class:"d-flex justify-content-between align-items-center mb-4"},J={class:"mb-3 d-flex row gap-2"},K={class:"col-md-4"},O={class:"input-group"},W={class:"table-responsive"},X={class:"table"},Y=["onClick"],Z=["onClick"],ee={key:0,class:"mt-4"},te={class:"pagination justify-content-center"},ae=["onClick"],se={class:"modal fade",id:"delConfirmModal",tabindex:"-1","aria-labelledby":"delConfirmModalLabel","aria-hidden":"true"},ne={class:"modal-dialog"},oe={class:"modal-content"},le={class:"modal-footer"},re={key:0,class:"loading-overlay"};function de(_,a,p,t,i,c){const u=h("Sidebar"),g=h("Navbar"),d=h("Footer");return l(),r(f,null,[e("div",z,[y(u),e("div",A,[y(g),e("div",I,[e("div",R,[e("div",U,[e("div",q,[e("div",G,[e("div",H,[a[6]||(a[6]=e("h6",{class:"card-title mb-0"},"課程分類管理",-1)),e("button",{class:"btn btn-primary",onClick:a[0]||(a[0]=s=>_.$router.push("/course/category/add"))}," 新增分類 ")]),e("div",J,[e("div",K,[e("div",O,[D(e("input",{type:"text",class:"form-control","onUpdate:modelValue":a[1]||(a[1]=s=>t.searchQuery=s),placeholder:"搜尋分類名稱"},null,512),[[V,t.searchQuery]]),e("button",{class:"btn btn-primary",onClick:a[2]||(a[2]=(...s)=>t.handleSearch&&t.handleSearch(...s))}," 搜尋 ")])])]),e("div",W,[e("table",X,[a[7]||(a[7]=e("thead",null,[e("tr",null,[e("th",null,"分類名稱"),e("th",null,"課程數量"),e("th",null,"建立日期"),e("th",null,"操作")])],-1)),e("tbody",null,[(l(!0),r(f,null,P(t.categories,s=>(l(),r("tr",{key:s.id},[e("td",null,m(s.name),1),e("td",null,m(s.courseCount),1),e("td",null,m(s.createdAt),1),e("td",null,[e("button",{class:"btn btn-sm btn-outline-primary me-2",onClick:b=>t.handleEdit(s.id)}," 編輯 ",8,Y),e("button",{class:"btn btn-sm btn-outline-danger",onClick:b=>t.handleDelete(s.id),"data-bs-toggle":"modal","data-bs-target":"#delConfirmModal"}," 刪除 ",8,Z)])]))),128))])])]),t.totalPages>0?(l(),r("nav",ee,[e("ul",te,[e("li",{class:C(["page-item",{disabled:t.currentPage===1}])},[e("a",{class:"page-link",href:"#",onClick:a[3]||(a[3]=k(s=>t.changePage(t.currentPage>1?t.currentPage-1:1),["prevent"]))}," 上一頁 ")],2),(l(!0),r(f,null,P(t.totalPages,s=>(l(),r("li",{key:s,class:C(["page-item",{active:t.currentPage===s}])},[e("a",{class:"page-link",href:"#",onClick:k(b=>t.changePage(s),["prevent"])},m(s),9,ae)],2))),128)),e("li",{class:C(["page-item",{disabled:t.currentPage===t.totalPages}])},[e("a",{class:"page-link",href:"#",onClick:a[4]||(a[4]=k(s=>t.changePage(t.currentPage<t.totalPages?t.currentPage+1:t.totalPages),["prevent"]))}," 下一頁 ")],2)])])):w("",!0)])])])])]),e("div",se,[e("div",ne,[e("div",oe,[a[9]||(a[9]=e("div",{class:"modal-header"},[e("h5",{class:"modal-title",id:"delConfirmModalLabel"},"確認刪除？"),e("button",{type:"button",class:"btn-close","data-bs-dismiss":"modal","aria-label":"btn-close"})],-1)),a[10]||(a[10]=e("div",{class:"modal-body"},"請確認是否刪除",-1)),e("div",le,[a[8]||(a[8]=e("button",{type:"button",class:"btn btn-secondary","data-bs-dismiss":"modal"}," 關閉 ",-1)),e("button",{type:"button",class:"btn btn-primary",onClick:a[5]||(a[5]=s=>t.delTag())}," 確認 ")])])])]),y(d)])]),t.loading?(l(),r("div",re,a[11]||(a[11]=[e("div",{class:"loading-spinner"},[e("div",{class:"spinner-border text-primary",role:"status"},[e("span",{class:"visually-hidden"},"載入中...")]),e("div",{class:"mt-2"},"載入中...")],-1)]))):w("",!0)],64)}const ue=F(Q,[["render",de],["__scopeId","data-v-cb9b0ce2"]]);export{ue as default};
