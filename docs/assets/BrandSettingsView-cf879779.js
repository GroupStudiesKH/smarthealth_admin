import{_ as C,r as i,j as N,k as p,o as r,c,b as t,l as S,d as x,e as v,g as u,a as g,n as B,t as w,p as I,F as T}from"./index-fd32de25.js";import{a as M}from"./api-service-a37f4a4e.js";import{F as D,N as U,_ as F}from"./sidebar-00f7f4b6.js";import{L as V}from"./loading-40382ee7.js";const L={components:{Footer:D,Navbar:U,Sidebar:F,Loading:V},setup(){const l=i(!1),e=i({siteName:"",metaTitle:"",metaDescription:"",metaImage:"",logo:"",trackingCode:""}),y=i({}),a=i(!1),d=i(""),m=i(""),n=i({metaImage:null,logo:null}),b=(s,k)=>{const f=s.target.files[0];f&&(n.value[k]=f,e.value[k]=URL.createObjectURL(f))},_=async()=>{try{l.value=!0;const s=[{meta_key:"site_name",meta_value:e.value.siteName},{meta_key:"meta_title",meta_value:e.value.metaTitle},{meta_key:"meta_description",meta_value:e.value.metaDescription},{meta_key:"tracking_code",meta_value:e.value.trackingCode}];n.value.metaImage&&s.push({meta_key:"meta_img",meta_value:n.value.metaImage}),n.value.logo&&s.push({meta_key:"logo_img",meta_value:n.value.logo}),await M.updateSiteMetaBatch(s),m.value="成功",d.value="品牌設定已更新",a.value=!0,l.value=!1}catch(s){console.error("Error saving brand settings:",s),m.value="錯誤",d.value="更新設定失敗，請稍後再試",a.value=!0,l.value=!1}},o=()=>{a.value=!1},h=async()=>{try{l.value=!0;const s=await M.getBrandSetting();e.value={siteName:s.site_name,metaTitle:s.meta_title,metaDescription:s.meta_description,metaImage:s.meta_img,logo:s.logo_img,trackingCode:s.tracking_code},l.value=!1}catch(s){l.value=!1,console.error("獲取品牌設定失敗:",s),m.value="錯誤",d.value="獲取設定失敗，請重新整理頁面",a.value=!0}};return N(()=>{h()}),{brandSettings:e,errors:y,showModal:a,modalMessage:d,modalTitle:m,handleFileUpload:b,saveBrandSettings:_,closeModal:o,loading:l}}},q={class:"main-wrapper"},j={class:"page-wrapper"},E={class:"page-content"},R={class:"row"},z={class:"col-md-12 grid-margin stretch-card"},A={class:"card"},G={class:"card-body"},O={class:"mb-3"},H={class:"mb-3"},J={class:"mb-3"},K={class:"row mb-3"},P={class:"col-md-6"},Q=["src"],W={class:"col-md-6"},X=["src"],Y={class:"mb-3"},Z={class:"modal-dialog"},$={class:"modal-content"},ee={class:"modal-header"},te={class:"modal-title"},ae={class:"modal-body"},oe={class:"modal-footer"},se={key:1,class:"modal-backdrop fade show"};function le(l,e,y,a,d,m){const n=p("Sidebar"),b=p("Navbar"),_=p("Loading");return r(),c(T,null,[t("div",q,[S(n),t("div",j,[S(b),t("div",E,[t("div",R,[t("div",z,[t("div",A,[t("div",G,[e[16]||(e[16]=t("h6",{class:"card-title"},"品牌設定",-1)),t("form",{onSubmit:e[6]||(e[6]=x((...o)=>a.saveBrandSettings&&a.saveBrandSettings(...o),["prevent"]))},[t("div",O,[e[9]||(e[9]=t("label",{for:"siteName",class:"form-label"},"網站名稱",-1)),v(t("input",{type:"text",class:"form-control",id:"siteName","onUpdate:modelValue":e[0]||(e[0]=o=>a.brandSettings.siteName=o),required:""},null,512),[[u,a.brandSettings.siteName]])]),t("div",H,[e[10]||(e[10]=t("label",{for:"metaTitle",class:"form-label"},"Meta 標題",-1)),v(t("input",{type:"text",class:"form-control",id:"metaTitle","onUpdate:modelValue":e[1]||(e[1]=o=>a.brandSettings.metaTitle=o),required:""},null,512),[[u,a.brandSettings.metaTitle]])]),t("div",J,[e[11]||(e[11]=t("label",{for:"metaDescription",class:"form-label"},"Meta 描述",-1)),v(t("textarea",{class:"form-control",id:"metaDescription","onUpdate:modelValue":e[2]||(e[2]=o=>a.brandSettings.metaDescription=o),rows:"3",required:""},null,512),[[u,a.brandSettings.metaDescription]])]),t("div",K,[t("div",P,[e[12]||(e[12]=t("label",{for:"metaImage",class:"form-label"},"Meta 圖片",-1)),t("input",{type:"file",class:"form-control",id:"metaImage",accept:"image/*",onChange:e[3]||(e[3]=o=>a.handleFileUpload(o,"metaImage"))},null,32),a.brandSettings.metaImage?(r(),c("img",{key:0,src:a.brandSettings.metaImage,class:"mt-2",style:{"max-width":"200px"}},null,8,Q)):g("",!0)]),t("div",W,[e[13]||(e[13]=t("label",{for:"logo",class:"form-label"},"Logo",-1)),t("input",{type:"file",class:"form-control",id:"logo",accept:"image/*",onChange:e[4]||(e[4]=o=>a.handleFileUpload(o,"logo"))},null,32),a.brandSettings.logo?(r(),c("img",{key:0,src:a.brandSettings.logo,class:"mt-2",style:{"max-width":"200px"}},null,8,X)):g("",!0)])]),t("div",Y,[e[14]||(e[14]=t("label",{for:"trackingCode",class:"form-label"},"追蹤碼",-1)),v(t("textarea",{class:"form-control",id:"trackingCode","onUpdate:modelValue":e[5]||(e[5]=o=>a.brandSettings.trackingCode=o),rows:"5",placeholder:"請輸入 Google Analytics 或其他追蹤碼"},null,512),[[u,a.brandSettings.trackingCode]])]),e[15]||(e[15]=t("button",{type:"submit",class:"btn btn-primary me-2"},"儲存設定",-1))],32)])])])])]),a.showModal?(r(),c("div",{key:0,class:B(["modal fade",{show:a.showModal}]),tabindex:"-1",style:{display:"block"}},[t("div",Z,[t("div",$,[t("div",ee,[t("h5",te,w(a.modalTitle),1),t("button",{type:"button",class:"btn-close",onClick:e[7]||(e[7]=(...o)=>a.closeModal&&a.closeModal(...o))})]),t("div",ae,[t("p",null,w(a.modalMessage),1)]),t("div",oe,[t("button",{type:"button",class:"btn btn-secondary",onClick:e[8]||(e[8]=(...o)=>a.closeModal&&a.closeModal(...o))},"關閉")])])])],2)):g("",!0),a.showModal?(r(),c("div",se)):g("",!0)])]),a.loading?(r(),I(_,{key:0})):g("",!0)],64)}const me=C(L,[["render",le]]);export{me as default};
