import{_ as N,i as S,r as _,j as L,k as u,o as i,c,b as e,l as f,F as k,f as w,n as y,d as P,p as x,a as B,t as d}from"./index-b26c6ec2.js";import{a as F}from"./api-service-28558cf5.js";import{F as V,N as j,_ as M}from"./sidebar-3b8b7882.js";import{L as z}from"./loading-4e587441.js";const D={components:{Footer:V,Navbar:j,Sidebar:M,Loading:z},setup(){const g=S(),a=_([]),m=_(1),t=_(1),v=10,l=_(!1),r=async(s=1)=>{try{l.value=!0;const o=await F.getAdmins(s,v);a.value=o.data,t.value=Math.ceil(o.total/v),m.value=s,l.value=!1}catch(o){console.error("Failed to fetch admin data:",o)}},h=s=>{g.push(`/admins/${s}/edit`)},b=async s=>{var o,C;if(confirm("您確定要刪除這個管理員嗎？"))try{l.value=!0,await F.deleteAdmin(s),await r(m.value),l.value=!1}catch(A){console.error("Failed to delete admin:",A),alert(((C=(o=A.response)==null?void 0:o.data)==null?void 0:C.message)||"刪除管理員時發生錯誤")}},p=s=>{r(s)},n=()=>{g.push("/admins/add")};return L(()=>{r()}),{admins:a,loading:l,currentPage:m,totalPages:t,editAdmin:h,deleteAdmin:b,changePage:p,addAdmin:n}}},E={class:"main-wrapper"},I={class:"page-wrapper"},R={class:"page-content"},q={class:"row"},G={class:"col-12 stretch-card"},H={class:"card"},J={class:"card-body"},K={class:"d-flex justify-content-between align-items-center mb-3"},O={class:"table-responsive"},Q={class:"table"},T=["onClick"],U=["onClick"],W={class:"mt-4"},X={class:"pagination justify-content-center"},Y=["onClick"];function Z(g,a,m,t,v,l){const r=u("Sidebar"),h=u("Navbar"),b=u("Footer"),p=u("Loading");return i(),c(k,null,[e("div",E,[f(r),e("div",I,[f(h),e("div",R,[e("div",q,[e("div",G,[e("div",H,[e("div",J,[e("div",K,[a[3]||(a[3]=e("h6",{class:"card-title"},"管理員列表",-1)),e("button",{onClick:a[0]||(a[0]=(...n)=>t.addAdmin&&t.addAdmin(...n)),class:"btn btn-primary"}," 新增管理員 ")]),e("div",O,[e("table",Q,[a[4]||(a[4]=e("thead",null,[e("tr",null,[e("th",null,"ID"),e("th",null,"名稱"),e("th",null,"電子郵件"),e("th",null,"權限群組"),e("th",null,"操作")])],-1)),e("tbody",null,[(i(!0),c(k,null,w(t.admins,n=>(i(),c("tr",{key:n.id},[e("td",null,d(n.id),1),e("td",null,d(n.name),1),e("td",null,d(n.email),1),e("td",null,d(n.permission_group.name),1),e("td",null,[e("button",{onClick:s=>t.editAdmin(n.id),class:"btn btn-primary btn-sm me-2"}," 編輯 ",8,T),e("button",{onClick:s=>t.deleteAdmin(n.id),class:"btn btn-danger btn-sm"}," 刪除 ",8,U)])]))),128))])])]),e("nav",W,[e("ul",X,[e("li",{class:y(["page-item",{disabled:t.currentPage===1}])},[e("a",{class:"page-link",href:"#",onClick:a[1]||(a[1]=P(n=>t.changePage(t.currentPage-1),["prevent"]))},"上一頁")],2),(i(!0),c(k,null,w(t.totalPages,n=>(i(),c("li",{key:n,class:y(["page-item",{active:t.currentPage===n}])},[e("a",{class:"page-link",href:"#",onClick:P(s=>t.changePage(n),["prevent"])},d(n),9,Y)],2))),128)),e("li",{class:y(["page-item",{disabled:t.currentPage===t.totalPages}])},[e("a",{class:"page-link",href:"#",onClick:a[2]||(a[2]=P(n=>t.changePage(t.currentPage+1),["prevent"]))},"下一頁")],2)])])])])])])]),f(b)])]),t.loading?(i(),x(p,{key:0})):B("",!0)],64)}const ae=N(D,[["render",Z]]);export{ae as default};
