import{_ as h,r,i as C,j as y,o as m,c,k,b as e,d as N,e as g,g as v,a as b,n as x,t as S}from"./index-208bfc7c.js";import{F as B,N as I,_ as T,a as w}from"./sidebar-ffb56a4c.js";const D={components:{Footer:B,Navbar:I,Sidebar:T},setup(){const l=r({siteName:"",metaTitle:"",metaDescription:"",metaImage:"",logo:"",trackingCode:""}),t=r({}),n=r(!1),a=r(""),d=r(""),i=r({metaImage:null,logo:null}),_=(s,p)=>{const f=s.target.files[0];f&&(i.value[p]=f,l.value[p]=URL.createObjectURL(f))},u=async()=>{try{const s=[{meta_key:"site_name",meta_value:l.value.siteName},{meta_key:"meta_title",meta_value:l.value.metaTitle},{meta_key:"meta_description",meta_value:l.value.metaDescription},{meta_key:"tracking_code",meta_value:l.value.trackingCode}];i.value.metaImage&&s.push({meta_key:"meta_img",meta_value:i.value.metaImage}),i.value.logo&&s.push({meta_key:"logo_img",meta_value:i.value.logo}),await w.updateSiteMetaBatch(s),d.value="成功",a.value="品牌設定已更新",n.value=!0}catch(s){console.error("Error saving brand settings:",s),d.value="錯誤",a.value="更新設定失敗，請稍後再試",n.value=!0}},o=()=>{n.value=!1},M=async()=>{try{const s=await w.getBrandSetting();l.value={siteName:s.site_name,metaTitle:s.meta_title,metaDescription:s.meta_description,metaImage:s.meta_img,logo:s.logo_img,trackingCode:s.tracking_code}}catch(s){console.error("獲取品牌設定失敗:",s),d.value="錯誤",a.value="獲取設定失敗，請重新整理頁面",n.value=!0}};return C(()=>{M()}),{brandSettings:l,errors:t,showModal:n,modalMessage:a,modalTitle:d,handleFileUpload:_,saveBrandSettings:u,closeModal:o}}},U={class:"main-wrapper"},V={class:"page-wrapper"},F={class:"page-content"},q={class:"row"},L={class:"col-md-12 grid-margin stretch-card"},j={class:"card"},E={class:"card-body"},R={class:"mb-3"},z={class:"mb-3"},A={class:"mb-3"},G={class:"row mb-3"},O={class:"col-md-6"},H=["src"],J={class:"col-md-6"},K=["src"],P={class:"mb-3"},Q={class:"modal-dialog"},W={class:"modal-content"},X={class:"modal-header"},Y={class:"modal-title"},Z={class:"modal-body"},$={class:"modal-footer"},ee={key:1,class:"modal-backdrop fade show"};function te(l,t,n,a,d,i){const _=y("Sidebar"),u=y("Navbar");return m(),c("div",U,[k(_),e("div",V,[k(u),e("div",F,[e("div",q,[e("div",L,[e("div",j,[e("div",E,[t[16]||(t[16]=e("h6",{class:"card-title"},"品牌設定",-1)),e("form",{onSubmit:t[6]||(t[6]=N((...o)=>a.saveBrandSettings&&a.saveBrandSettings(...o),["prevent"]))},[e("div",R,[t[9]||(t[9]=e("label",{for:"siteName",class:"form-label"},"網站名稱",-1)),g(e("input",{type:"text",class:"form-control",id:"siteName","onUpdate:modelValue":t[0]||(t[0]=o=>a.brandSettings.siteName=o),required:""},null,512),[[v,a.brandSettings.siteName]])]),e("div",z,[t[10]||(t[10]=e("label",{for:"metaTitle",class:"form-label"},"Meta 標題",-1)),g(e("input",{type:"text",class:"form-control",id:"metaTitle","onUpdate:modelValue":t[1]||(t[1]=o=>a.brandSettings.metaTitle=o),required:""},null,512),[[v,a.brandSettings.metaTitle]])]),e("div",A,[t[11]||(t[11]=e("label",{for:"metaDescription",class:"form-label"},"Meta 描述",-1)),g(e("textarea",{class:"form-control",id:"metaDescription","onUpdate:modelValue":t[2]||(t[2]=o=>a.brandSettings.metaDescription=o),rows:"3",required:""},null,512),[[v,a.brandSettings.metaDescription]])]),e("div",G,[e("div",O,[t[12]||(t[12]=e("label",{for:"metaImage",class:"form-label"},"Meta 圖片",-1)),e("input",{type:"file",class:"form-control",id:"metaImage",accept:"image/*",onChange:t[3]||(t[3]=o=>a.handleFileUpload(o,"metaImage"))},null,32),a.brandSettings.metaImage?(m(),c("img",{key:0,src:a.brandSettings.metaImage,class:"mt-2",style:{"max-width":"200px"}},null,8,H)):b("",!0)]),e("div",J,[t[13]||(t[13]=e("label",{for:"logo",class:"form-label"},"Logo",-1)),e("input",{type:"file",class:"form-control",id:"logo",accept:"image/*",onChange:t[4]||(t[4]=o=>a.handleFileUpload(o,"logo"))},null,32),a.brandSettings.logo?(m(),c("img",{key:0,src:a.brandSettings.logo,class:"mt-2",style:{"max-width":"200px"}},null,8,K)):b("",!0)])]),e("div",P,[t[14]||(t[14]=e("label",{for:"trackingCode",class:"form-label"},"追蹤碼",-1)),g(e("textarea",{class:"form-control",id:"trackingCode","onUpdate:modelValue":t[5]||(t[5]=o=>a.brandSettings.trackingCode=o),rows:"5",placeholder:"請輸入 Google Analytics 或其他追蹤碼"},null,512),[[v,a.brandSettings.trackingCode]])]),t[15]||(t[15]=e("button",{type:"submit",class:"btn btn-primary me-2"},"儲存設定",-1))],32)])])])])]),a.showModal?(m(),c("div",{key:0,class:x(["modal fade",{show:a.showModal}]),tabindex:"-1",style:{display:"block"}},[e("div",Q,[e("div",W,[e("div",X,[e("h5",Y,S(a.modalTitle),1),e("button",{type:"button",class:"btn-close",onClick:t[7]||(t[7]=(...o)=>a.closeModal&&a.closeModal(...o))})]),e("div",Z,[e("p",null,S(a.modalMessage),1)]),e("div",$,[e("button",{type:"button",class:"btn btn-secondary",onClick:t[8]||(t[8]=(...o)=>a.closeModal&&a.closeModal(...o))},"關閉")])])])],2)):b("",!0),a.showModal?(m(),c("div",ee)):b("",!0)])])}const se=h(D,[["render",te]]);export{se as default};
