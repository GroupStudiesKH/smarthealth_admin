import{_ as y,i as N,u as w,r as m,j as x,k as c,o as i,c as h,b as t,l as v,t as d,m as C,F as g,f as F,p as L,a as S,n as B}from"./index-c34474c4.js";import{F as T,N as V,_ as I}from"./sidebar-01ba7568.js";import{L as j}from"./loading-5656bda6.js";import{a as k}from"./api-service-a37f4a4e.js";const R={components:{Footer:T,Navbar:V,Sidebar:I,Loading:j},setup(){const r=N(),e=w(),n=m([]),a=m({id:0,title:""}),o=m(!1),f=()=>{r.push(`/course/${e.params.courseId}/chapter/add`)},u=s=>{r.push(`/course/${e.params.courseId}/chapter/${s}/edit`)},p=async s=>{if(confirm("確定要刪除此章節嗎？"))try{o.value=!0,await k.deleteChapter(e.params.courseId,s),n.value=n.value.filter(l=>l.id!==s),o.value=!1}catch{o.value=!1,alert("刪除章節失敗")}},b=()=>{r.push("/course")},_=async()=>{try{o.value=!0;const s=await k.getChapters(e.params.courseId);o.value=!1,n.value=s.chapters,a.value=s.course}catch(s){o.value=!1,alert("獲取課程列表失敗"),console.log(s)}};return x(()=>{_()}),{chapters:n,course:a,loading:o,addChapter:f,editChapter:u,deleteChapter:p,backToCourse:b}}},z={class:"main-wrapper"},D={class:"page-wrapper"},E={class:"page-content"},M={class:"row"},$={class:"col-md-12 grid-margin stretch-card"},q={class:"card"},A={class:"card-body"},G={class:"d-flex justify-content-between align-items-center mb-4"},H={class:"card-title mb-0"},J={class:"d-flex gap-2"},K={class:"table-responsive"},O={class:"table table-hover"},P=["onClick"],Q=["onClick"];function U(r,e,n,a,o,f){const u=c("Navbar"),p=c("Sidebar"),b=c("Footer"),_=c("Loading");return i(),h(g,null,[t("div",z,[v(u),v(p),t("div",D,[t("div",E,[t("div",M,[t("div",$,[t("div",q,[t("div",A,[t("div",G,[t("h6",H,d(a.course.title)+" 章節管理",1),t("div",J,[t("button",{type:"button",class:"btn btn-primary",onClick:e[0]||(e[0]=(...s)=>a.addChapter&&a.addChapter(...s))},e[2]||(e[2]=[t("i",{class:"link-icon","data-feather":"plus"},null,-1),C(" 新增章節 ")])),t("button",{type:"button",class:"btn btn-secondary",onClick:e[1]||(e[1]=(...s)=>a.backToCourse&&a.backToCourse(...s))},e[3]||(e[3]=[t("i",{class:"link-icon","data-feather":"plus"},null,-1),C(" 返回課程 ")]))])]),t("div",K,[t("table",O,[e[4]||(e[4]=t("thead",null,[t("tr",null,[t("th",null,"章節標題"),t("th",null,"狀態"),t("th",null,"新增日期"),t("th",null,"操作")])],-1)),t("tbody",null,[(i(!0),h(g,null,F(a.chapters,s=>(i(),h("tr",{key:s.id},[t("td",null,d(s.title),1),t("td",null,[t("span",{class:B({"badge bg-success":s.status==="publish","badge bg-warning":s.status==="unpublish"})},d(s.status=="publish"?"公開":"未公開"),3)]),t("td",null,d(s.created_at),1),t("td",null,[t("button",{class:"btn btn-sm btn-outline-primary me-2",onClick:l=>a.editChapter(s.id)}," 編輯 ",8,P),t("button",{class:"btn btn-sm btn-outline-danger",onClick:l=>a.deleteChapter(s.id)}," 刪除 ",8,Q)])]))),128))])])])])])])])]),v(b)])]),a.loading?(i(),L(_,{key:0})):S("",!0)],64)}const tt=y(R,[["render",U]]);export{tt as default};
