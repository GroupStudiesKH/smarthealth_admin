import{_ as N,i as S,u as F,r as l,j as C,k as b,o as t,c as n,b as o,l as M,d as U,e as c,g as w,n as v,t as d,a as m,v as A,F as L,f as B,p as T}from"./index-fd32de25.js";import{a as h}from"./api-service-a37f4a4e.js";import{L as q}from"./loading-40382ee7.js";import{F as P,N as R,_ as j}from"./sidebar-00f7f4b6.js";const z={components:{Footer:P,Navbar:R,Sidebar:j,Loading:q},setup(){const D=S(),a=F(),y=l([]),s=l({id:a.params.id,name:"",email:"",permission_group_id:"",password:"",password_confirmation:""}),p=l(!1),g=l(""),u=l(""),_=l({}),i=l(!1),k=()=>{i.value=!0,h.updateAdmin(s.value).then(r=>{e("成功","管理員資料已成功更新"),D.push("/admins"),i.value=!1}).catch(r=>{var f;_.value=((f=r.response)==null?void 0:f.data.content)||{},i.value=!1,e("錯誤","更新管理員失敗，請檢查輸入並再試一次")})},e=(r,f)=>{u.value=r,g.value=f,p.value=!0},V=()=>{p.value=!1},x=async()=>{try{i.value=!0;const r=await h.getPermissionGroups();y.value=r,i.value=!1}catch(r){console.error("Error fetching permission list:",r),e("錯誤","獲取權限列表失敗，請再試一次")}},E=async()=>{try{i.value=!0;const r=await h.getAdmin(s.value.id);s.value=r,i.value=!1}catch(r){console.error("Error fetching admin data:",r),e("錯誤","獲取管理員資料失敗，請再試一次")}};return C(async()=>{await x(),E()}),{userData:s,adminEdit:k,permissionList:y,showModal:p,modalMessage:g,modalTitle:u,closeModal:V,errors:_,isLoading:i}}},G={class:"main-wrapper"},H={class:"page-wrapper"},I={class:"page-content"},J={class:"row mb-4"},K={class:"col-12 col-lg-8 mx-auto stretch-card"},O={class:"card"},Q={class:"card-body"},W={class:"mb-3"},X={key:0,class:"invalid-feedback"},Y={class:"mb-3"},Z={class:"mb-3"},$=["value"],ss={key:0,class:"invalid-feedback"},os={class:"mb-3"},as={key:0,class:"invalid-feedback"},es={class:"mb-3"},rs={key:0,class:"invalid-feedback"},is={class:"modal-dialog"},ts={class:"modal-content"},ns={class:"modal-header"},ls={class:"modal-title"},ds={class:"modal-body"},ms={class:"modal-footer"},cs={key:1,class:"modal-backdrop fade show"};function vs(D,a,y,s,p,g){const u=b("Sidebar"),_=b("Navbar"),i=b("Footer"),k=b("Loading");return t(),n(L,null,[o("div",G,[M(u),o("div",H,[M(_),o("div",I,[o("div",J,[o("div",K,[o("div",O,[o("div",Q,[a[15]||(a[15]=o("h6",{class:"card-title"},"編輯管理員資料",-1)),o("form",{onSubmit:a[5]||(a[5]=U((...e)=>s.adminEdit&&s.adminEdit(...e),["prevent"]))},[o("div",W,[a[8]||(a[8]=o("label",{for:"name",class:"form-label"},"姓名",-1)),c(o("input",{type:"text",class:v(["form-control",{"is-invalid":s.errors.name}]),id:"name","onUpdate:modelValue":a[0]||(a[0]=e=>s.userData.name=e),required:""},null,2),[[w,s.userData.name]]),s.errors.name?(t(),n("div",X,d(s.errors.name[0]),1)):m("",!0)]),o("div",Y,[a[9]||(a[9]=o("label",{for:"email",class:"form-label"},"電子郵件",-1)),c(o("input",{type:"email",class:"form-control",id:"email","onUpdate:modelValue":a[1]||(a[1]=e=>s.userData.email=e),disabled:""},null,512),[[w,s.userData.email]])]),o("div",Z,[a[11]||(a[11]=o("label",{for:"permission_group_id",class:"form-label"},"權限群組",-1)),c(o("select",{class:v(["form-select",{"is-invalid":s.errors.permission_group_id}]),id:"permission_group_id","onUpdate:modelValue":a[2]||(a[2]=e=>s.userData.permission_group_id=e),required:""},[a[10]||(a[10]=o("option",{value:""},"請選擇權限群組",-1)),(t(!0),n(L,null,B(s.permissionList,e=>(t(),n("option",{key:e.id,value:e.id},d(e.name),9,$))),128))],2),[[A,s.userData.permission_group_id]]),s.errors.permission_group_id?(t(),n("div",ss,d(s.errors.permission_group_id[0]),1)):m("",!0)]),o("div",os,[a[12]||(a[12]=o("label",{for:"password",class:"form-label"},"密碼",-1)),c(o("input",{type:"password",class:v(["form-control",{"is-invalid":s.errors.password}]),id:"password","onUpdate:modelValue":a[3]||(a[3]=e=>s.userData.password=e)},null,2),[[w,s.userData.password]]),s.errors.password?(t(),n("div",as,d(s.errors.password[0]),1)):m("",!0)]),o("div",es,[a[13]||(a[13]=o("label",{for:"password_confirmation",class:"form-label"},"確認密碼",-1)),c(o("input",{type:"password",class:v(["form-control",{"is-invalid":s.errors.password}]),id:"password_confirmation","onUpdate:modelValue":a[4]||(a[4]=e=>s.userData.password_confirmation=e)},null,2),[[w,s.userData.password_confirmation]]),s.errors.password?(t(),n("div",rs,d(s.errors.password[0]),1)):m("",!0)]),a[14]||(a[14]=o("button",{type:"submit",class:"btn btn-primary"},"更新資料",-1))],32)])])])]),s.showModal?(t(),n("div",{key:0,class:v(["modal fade",{show:s.showModal}]),tabindex:"-1",style:{display:"block"}},[o("div",is,[o("div",ts,[o("div",ns,[o("h5",ls,d(s.modalTitle),1),o("button",{type:"button",class:"btn-close",onClick:a[6]||(a[6]=(...e)=>s.closeModal&&s.closeModal(...e))})]),o("div",ds,[o("p",null,d(s.modalMessage),1)]),o("div",ms,[o("button",{type:"button",class:"btn btn-secondary",onClick:a[7]||(a[7]=(...e)=>s.closeModal&&s.closeModal(...e))},"關閉")])])])],2)):m("",!0),s.showModal?(t(),n("div",cs)):m("",!0)]),M(i)])]),s.isLoading?(t(),T(k,{key:0})):m("",!0)],64)}const bs=N(z,[["render",vs]]);export{bs as default};
