import{_ as C,i as L,u as P,r as D,q as j,j as O,k as p,o as t,c as r,b as a,l as k,t as d,d as B,m as n,e,g as i,n as f,a as m,s as T,v as R,F as z,f as A,x as w,y as H,h as I,p as q}from"./index-a7a449ec.js";import{F as G,N as J,_ as K,a as S}from"./sidebar-071cb7ef.js";import{L as Q}from"./loading-6fc6d92d.js";const W={components:{Footer:G,Navbar:J,Sidebar:K,Loading:Q},setup(){const h=L(),o=P(),u=o.params.id!==void 0,l=o.params.id,c=D(!1),_=j({name:"",email:"",password:"",showPassword:!1,status:"active",created_at:"",last_login_at:"",registration_source:"",last_login_ip:"",role:"",roleOptions:[{value:"student",label:"學生"},{value:"teacher",label:"老師"},{value:"doctor",label:"醫師"},{value:"nurse",label:"護理人員"},{value:"vendor",label:"廠商"},{value:"other",label:"其他"}],organization:"",national_id:"",address:"",mobile:"",gender:"",birthdate:""}),g=D({}),b=D(!1),v=D(""),x=async()=>{if(u)try{c.value=!0;const s=await S.getMember(l);c.value=!1,Object.assign(_,s)}catch(s){console.error("Failed to fetch member data:",s),v.value="獲取會員資料失敗",b.value=!0,c.value=!1}},M=async()=>{var s,E;try{g.value={},c.value=!0,u?await S.editMember(l,_):await S.addMember(_),c.value=!1,h.push("/member")}catch(y){if(console.error("Failed to save member:",y),c.value=!1,((E=(s=y.response)==null?void 0:s.data)==null?void 0:E.status)==="error")if(y.response.data.content){const V={};for(const[N,U]of Object.entries(y.response.data.content))V[N]=Array.isArray(U)?U[0].replace(/[\[\]"]/g,""):U;g.value=V;const F=Object.values(V).join("<br/>");v.value=F,b.value=!0}else v.value=y.response.data.message||"儲存失敗",b.value=!0;else v.value="儲存失敗",b.value=!0,c.value=!1}};return O(()=>{u&&x()}),{formData:_,errors:g,isEdit:u,loading:c,showModal:b,modalMessage:v,handleSubmit:M}}},X={class:"main-wrapper"},Y={class:"page-wrapper"},Z={class:"page-content"},$={class:"row"},oo={class:"col-md-12 grid-margin stretch-card"},ao={class:"card"},lo={class:"card-body"},so={class:"card-title"},eo={class:"row"},to={class:"col-md-6 col-12 mb-3"},ro=["disabled"],no={key:0,class:"invalid-feedback"},io={class:"col-md-6 col-12 mb-3"},mo={key:0,class:"invalid-feedback"},co={class:"col-md-6 col-12 mb-3"},fo={class:"input-group"},bo=["type","placeholder"],vo={class:"material-icons"},uo={key:0,class:"invalid-feedback"},_o={class:"col-md-6 col-12 mb-3"},go=["value"],yo={key:0,class:"invalid-feedback"},po={class:"col-md-6 col-12 mb-3"},Do={key:0,class:"invalid-feedback"},ko={class:"col-md-6 col-12 mb-3"},wo={class:"col-md-6 col-12 mb-3"},xo={class:"col-md-6 col-12 mb-3"},Mo={key:0,class:"invalid-feedback"},Vo={class:"col-md-6 col-12 mb-3"},Uo={class:"form-check"},So={class:"form-check"},ho={key:0,class:"invalid-feedback"},Eo={class:"col-md-6 col-12 mb-3"},zo={class:"form-check"},Fo={class:"form-check"},No={class:"form-check"},Co={class:"col-md-6 col-12 mb-3"},Lo={key:0},Po={class:"col-md-6 col-12 mb-3"},jo={class:"col-md-6 col-12 mb-3"},Oo={class:"col-md-6 col-12 mb-3"},Bo={class:"col-md-6 col-12 mb-3"},To={class:"modal-dialog"},Ro={class:"modal-content"},Ao={class:"modal-header"},Ho=["innerHTML"],Io={class:"modal-footer"},qo={key:0,class:"modal-backdrop fade show"};function Go(h,o,u,l,c,_){const g=p("Sidebar"),b=p("Navbar"),v=p("router-link"),x=p("Footer"),M=p("Loading");return t(),r(z,null,[a("div",X,[k(g),a("div",Y,[k(b),a("div",Z,[a("div",$,[a("div",oo,[a("div",ao,[a("div",lo,[a("h6",so,d(l.isEdit?"編輯會員":"新增會員"),1),a("form",{onSubmit:o[18]||(o[18]=B((...s)=>l.handleSubmit&&l.handleSubmit(...s),["prevent"]))},[a("div",eo,[a("div",to,[o[21]||(o[21]=a("label",{class:"form-label"},[n("Email "),a("span",{class:"text-danger"},"*")],-1)),e(a("input",{type:"email",class:f(["form-control",{"is-invalid":l.errors.email}]),"onUpdate:modelValue":o[0]||(o[0]=s=>l.formData.email=s),disabled:l.isEdit},null,10,ro),[[i,l.formData.email]]),l.errors.email?(t(),r("div",no,d(l.errors.email),1)):m("",!0)]),a("div",io,[o[22]||(o[22]=a("label",{class:"form-label"},[n("會員名稱 "),a("span",{class:"text-danger"},"*")],-1)),e(a("input",{type:"text",class:f(["form-control",{"is-invalid":l.errors.name}]),"onUpdate:modelValue":o[1]||(o[1]=s=>l.formData.name=s)},null,2),[[i,l.formData.name]]),l.errors.name?(t(),r("div",mo,d(l.errors.name),1)):m("",!0)]),a("div",co,[o[23]||(o[23]=a("label",{class:"form-label"},[n("密碼 "),a("span",{class:"text-danger"},"*")],-1)),a("div",fo,[e(a("input",{type:l.formData.showPassword?"text":"password",class:f(["form-control",{"is-invalid":l.errors.password}]),"onUpdate:modelValue":o[2]||(o[2]=s=>l.formData.password=s),placeholder:l.isEdit?"不修改請留空":""},null,10,bo),[[T,l.formData.password]]),a("button",{class:"btn btn-outline-secondary",type:"button",onClick:o[3]||(o[3]=s=>l.formData.showPassword=!l.formData.showPassword)},[a("i",vo,d(l.formData.showPassword?"visibility_off":"visibility"),1)]),l.errors.password?(t(),r("div",uo,d(l.errors.password),1)):m("",!0)])]),a("div",_o,[o[25]||(o[25]=a("label",{class:"form-label"},[n("身份別 "),a("span",{class:"text-danger"},"*")],-1)),e(a("select",{class:f(["form-select",{"is-invalid":l.errors.role}]),"onUpdate:modelValue":o[4]||(o[4]=s=>l.formData.role=s)},[o[24]||(o[24]=a("option",{value:""},"請選擇身份別",-1)),(t(!0),r(z,null,A(l.formData.roleOptions,s=>(t(),r("option",{key:s.value,value:s.value},d(s.label),9,go))),128))],2),[[R,l.formData.role]]),l.errors.role?(t(),r("div",yo,d(l.errors.role),1)):m("",!0)]),a("div",po,[o[26]||(o[26]=a("label",{class:"form-label"},[n("任職單位 "),a("span",{class:"text-danger"},"*")],-1)),e(a("input",{type:"text",class:f(["form-control",{"is-invalid":l.errors.organization}]),"onUpdate:modelValue":o[5]||(o[5]=s=>l.formData.organization=s)},null,2),[[i,l.formData.organization]]),l.errors.organization?(t(),r("div",Do,d(l.errors.organization),1)):m("",!0)]),a("div",ko,[o[27]||(o[27]=a("label",{class:"form-label"},[n("身分證字號 "),a("span",{class:"text-danger"},"*")],-1)),e(a("input",{type:"text",class:f(["form-control",{"is-invalid":l.errors.national_id}]),"onUpdate:modelValue":o[6]||(o[6]=s=>l.formData.national_id=s)},null,2),[[i,l.formData.national_id]])]),a("div",wo,[o[28]||(o[28]=a("label",{class:"form-label"},[n("地址 "),a("span",{class:"text-danger"},"*")],-1)),e(a("input",{type:"text",class:f(["form-control",{"is-invalid":l.errors.address}]),"onUpdate:modelValue":o[7]||(o[7]=s=>l.formData.address=s)},null,2),[[i,l.formData.address]])]),a("div",xo,[o[29]||(o[29]=a("label",{class:"form-label"},[n("手機 "),a("span",{class:"text-danger"},"*")],-1)),e(a("input",{type:"tel",class:f(["form-control",{"is-invalid":l.errors.mobile}]),"onUpdate:modelValue":o[8]||(o[8]=s=>l.formData.mobile=s)},null,2),[[i,l.formData.mobile]]),l.errors.mobile?(t(),r("div",Mo,d(l.errors.mobile),1)):m("",!0)]),a("div",Vo,[o[32]||(o[32]=a("label",{class:"form-label"},[n("性別 "),a("span",{class:"text-danger"},"*")],-1)),a("div",Uo,[e(a("input",{type:"radio",class:"form-check-input",id:"male",value:"male","onUpdate:modelValue":o[9]||(o[9]=s=>l.formData.gender=s)},null,512),[[w,l.formData.gender]]),o[30]||(o[30]=a("label",{class:"form-check-label",for:"male"},"男性",-1))]),a("div",So,[e(a("input",{type:"radio",class:"form-check-input",id:"female",value:"female","onUpdate:modelValue":o[10]||(o[10]=s=>l.formData.gender=s)},null,512),[[w,l.formData.gender]]),o[31]||(o[31]=a("label",{class:"form-check-label",for:"female"},"女性",-1))]),l.errors.gender?(t(),r("div",ho,d(l.errors.gender),1)):m("",!0)]),a("div",Eo,[o[35]||(o[35]=a("label",{class:"form-label"},"狀態",-1)),a("div",zo,[a("div",Fo,[e(a("input",{type:"radio",class:"form-check-input",id:"active",value:"active","onUpdate:modelValue":o[11]||(o[11]=s=>l.formData.status=s)},null,512),[[w,l.formData.status]]),o[33]||(o[33]=a("label",{class:"form-check-label",for:"active"},"啟用",-1))]),a("div",No,[e(a("input",{type:"radio",class:"form-check-input",id:"inactive",value:"inactive","onUpdate:modelValue":o[12]||(o[12]=s=>l.formData.status=s)},null,512),[[w,l.formData.status]]),o[34]||(o[34]=a("label",{class:"form-check-label",for:"inactive"},"停用",-1))])])]),a("div",Co,[o[36]||(o[36]=a("label",{class:"form-label"},[n("生日 "),a("span",{class:"text-danger"},"*")],-1)),e(a("input",{type:"date",class:"form-control","onUpdate:modelValue":o[13]||(o[13]=s=>l.formData.birthdate=s)},null,512),[[i,l.formData.birthdate]])]),l.isEdit?(t(),r("div",Lo,[a("div",Po,[o[37]||(o[37]=a("label",{class:"form-label"},"註冊日期",-1)),e(a("input",{type:"text",class:"form-control","onUpdate:modelValue":o[14]||(o[14]=s=>l.formData.created_at=s),disabled:""},null,512),[[i,l.formData.created_at]])]),a("div",jo,[o[38]||(o[38]=a("label",{class:"form-label"},"上次登入日期",-1)),e(a("input",{type:"text",class:"form-control","onUpdate:modelValue":o[15]||(o[15]=s=>l.formData.last_login_at=s),disabled:""},null,512),[[i,l.formData.last_login_at]])]),a("div",Oo,[o[39]||(o[39]=a("label",{class:"form-label"},"註冊來源",-1)),e(a("input",{type:"text",class:"form-control","onUpdate:modelValue":o[16]||(o[16]=s=>l.formData.registration_source=s),disabled:""},null,512),[[i,l.formData.registration_source]])]),a("div",Bo,[o[40]||(o[40]=a("label",{class:"form-label"},"上次登入IP",-1)),e(a("input",{type:"text",class:"form-control","onUpdate:modelValue":o[17]||(o[17]=s=>l.formData.last_login_ip=s),disabled:""},null,512),[[i,l.formData.last_login_ip]])])])):m("",!0)]),o[42]||(o[42]=a("button",{type:"submit",class:"btn btn-primary me-2"},"儲存",-1)),k(v,{to:"/member",class:"btn btn-secondary"},{default:H(()=>o[41]||(o[41]=[n("取消")])),_:1})],32)])])])])]),k(x)]),a("div",{class:f(["modal fade",{show:l.showModal}]),tabindex:"-1",style:I({display:l.showModal?"block":"none"})},[a("div",To,[a("div",Ro,[a("div",Ao,[o[43]||(o[43]=a("h5",{class:"modal-title"},"錯誤提示",-1)),a("button",{type:"button",class:"btn-close",onClick:o[19]||(o[19]=s=>l.showModal=!1)})]),a("div",{class:"modal-body",innerHTML:l.modalMessage},null,8,Ho),a("div",Io,[a("button",{type:"button",class:"btn btn-secondary",onClick:o[20]||(o[20]=s=>l.showModal=!1)},"關閉")])])])],6),l.showModal?(t(),r("div",qo)):m("",!0)]),l.loading?(t(),q(M,{key:0})):m("",!0)],64)}const Wo=C(W,[["render",Go]]);export{Wo as default};
