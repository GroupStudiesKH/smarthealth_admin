import{_ as U,p as F,r as v,j as w,o as s,c as l,b as e,k as M,d as I,l as B,e as c,g as _,n as r,t as d,a as i,v as j,F as N}from"./index-0d87b40a.js";import{F as S,N as L,_ as A,a as P}from"./sidebar-541fb7fa.js";const T={components:{Footer:S,Navbar:L,Sidebar:A},setup(){const x=F(),t=v({title:"",subtitle_1:"",subtitle_2:"",content:"",action_link_href:"",action_link_text:"",action_link2_href:"",action_link2_text:"",status:"active",image:null,sort:0}),p=v({}),a=v(!1),f=v(!1),y=v(""),k=v(null),D=async()=>{var b,m;a.value=!0;try{const n=new FormData;n.append("title",t.value.title),n.append("subtitle_1",t.value.subtitle_1),n.append("subtitle_2",t.value.subtitle_2),n.append("content",t.value.content),n.append("action_link_href",t.value.action_link_href),n.append("action_link_text",t.value.action_link_text),n.append("action_link2_href",t.value.action_link2_href),n.append("action_link2_text",t.value.action_link2_text),n.append("status",t.value.status),t.value.image instanceof File&&n.append("image",t.value.image),n.append("sort",t.value.sort),await P.addBanner(n),o("橫幅新增成功"),x.push("/layout/banner")}catch(n){if(((m=(b=n.response)==null?void 0:b.data)==null?void 0:m.status)==="error")if(n.response.data.content){const g={};for(const[C,h]of Object.entries(n.response.data.content))g[C]=Array.isArray(h)?h[0].replace(/[\[\]"]/g,""):h;p.value=g;const V=Object.values(g).join("<br/>");u("橫幅新增失敗："+(V||"未知錯誤"))}else u("橫幅新增失敗："+(n.response.data.message||"儲存失敗"));else u("儲存失敗")}finally{a.value=!1}},u=b=>{y.value=b,f.value=!0},o=b=>{y.value=b,f.value=!0};return{bannerData:t,addBanner:D,goBack:()=>{x.push("/layout/banner")},errors:p,isLoading:a,showModal:f,modalMessage:y,closeModal:()=>{f.value=!1},handleImageChange:b=>{const m=b.target.files[0];if(m){t.value.image=m;const n=new FileReader;n.onload=g=>{k.value=g.target.result},n.readAsDataURL(m)}},imagePreview:k,clearImage:()=>{t.value.image=null,k.value=null}}}},q={class:"main-wrapper"},E={class:"page-wrapper"},R={class:"page-content"},H={class:"row"},O={class:"col-12"},z={class:"card"},G={class:"card-body"},J={class:"row"},K={class:"col-md-6"},Q={class:"mb-3"},W={key:0,class:"invalid-feedback"},X={class:"mb-3"},Y={key:0,class:"invalid-feedback"},Z={class:"mb-3"},$={key:0,class:"invalid-feedback"},tt={class:"mb-3"},at={key:0,class:"invalid-feedback"},et={class:"col-md-6"},ot={class:"mb-3"},nt={key:0,class:"invalid-feedback"},st={class:"mb-3"},lt={key:0,class:"invalid-feedback"},it={class:"mb-3"},rt={key:0,class:"invalid-feedback"},dt={class:"mb-3"},ct={key:0,class:"invalid-feedback"},_t={class:"col-md-6"},bt={class:"mb-3"},mt={key:0,class:"invalid-feedback"},vt={class:"mb-3"},ft={key:0,class:"invalid-feedback"},kt={key:1,class:"mt-2"},ut=["src"],gt={class:"mb-3"},yt={key:0,class:"invalid-feedback"},xt={class:"mt-4"},pt=["disabled"],Dt=["disabled"],ht={class:"modal-dialog"},wt={class:"modal-content"},Mt={class:"modal-header"},Bt=["innerHTML"],Vt={class:"modal-footer"},Ct={key:0,class:"modal-backdrop"};function Ut(x,t,p,a,f,y){const k=w("Sidebar"),D=w("Navbar"),u=w("Footer");return s(),l(N,null,[e("div",q,[M(k),e("div",E,[M(D),e("div",R,[e("div",H,[e("div",O,[e("div",z,[e("div",G,[t[30]||(t[30]=e("h4",{class:"card-title mb-4"},"新增橫幅",-1)),e("form",{onSubmit:t[13]||(t[13]=I((...o)=>a.addBanner&&a.addBanner(...o),["prevent"])),enctype:"multipart/form-data",class:"w-100"},[e("div",J,[e("div",K,[e("div",Q,[t[16]||(t[16]=e("label",{for:"title",class:"form-label"},[B("標題 "),e("span",{class:"text-danger"},"*")],-1)),c(e("input",{type:"text",class:r(["form-control",{"is-invalid":a.errors.title}]),id:"title","onUpdate:modelValue":t[0]||(t[0]=o=>a.bannerData.title=o),required:""},null,2),[[_,a.bannerData.title]]),a.errors.title?(s(),l("div",W,d(a.errors.title),1)):i("",!0)]),e("div",X,[t[17]||(t[17]=e("label",{for:"subtitle_1",class:"form-label"},"副標題1",-1)),c(e("input",{type:"text",class:r(["form-control",{"is-invalid":a.errors.subtitle_1}]),id:"subtitle_1","onUpdate:modelValue":t[1]||(t[1]=o=>a.bannerData.subtitle_1=o)},null,2),[[_,a.bannerData.subtitle_1]]),a.errors.subtitle_1?(s(),l("div",Y,d(a.errors.subtitle_1),1)):i("",!0)]),e("div",Z,[t[18]||(t[18]=e("label",{for:"subtitle_2",class:"form-label"},"副標題2",-1)),c(e("input",{type:"text",class:r(["form-control",{"is-invalid":a.errors.subtitle_2}]),id:"subtitle_2","onUpdate:modelValue":t[2]||(t[2]=o=>a.bannerData.subtitle_2=o)},null,2),[[_,a.bannerData.subtitle_2]]),a.errors.subtitle_2?(s(),l("div",$,d(a.errors.subtitle_2),1)):i("",!0)]),e("div",tt,[t[19]||(t[19]=e("label",{for:"content",class:"form-label"},[B("內容 "),e("span",{class:"text-danger"},"*")],-1)),c(e("textarea",{class:r(["form-control",{"is-invalid":a.errors.content}]),id:"content","onUpdate:modelValue":t[3]||(t[3]=o=>a.bannerData.content=o),required:""},null,2),[[_,a.bannerData.content]]),a.errors.content?(s(),l("div",at,d(a.errors.content),1)):i("",!0)])]),e("div",et,[e("div",ot,[t[20]||(t[20]=e("label",{for:"action_link_href",class:"form-label"},"行動連結網址",-1)),c(e("input",{type:"text",class:r(["form-control",{"is-invalid":a.errors.action_link_href}]),id:"action_link_href","onUpdate:modelValue":t[4]||(t[4]=o=>a.bannerData.action_link_href=o)},null,2),[[_,a.bannerData.action_link_href]]),a.errors.action_link_href?(s(),l("div",nt,d(a.errors.action_link_href),1)):i("",!0)]),e("div",st,[t[21]||(t[21]=e("label",{for:"action_link_text",class:"form-label"},"行動連結文字",-1)),c(e("input",{type:"text",class:r(["form-control",{"is-invalid":a.errors.action_link_text}]),id:"action_link_text","onUpdate:modelValue":t[5]||(t[5]=o=>a.bannerData.action_link_text=o)},null,2),[[_,a.bannerData.action_link_text]]),a.errors.action_link_text?(s(),l("div",lt,d(a.errors.action_link_text),1)):i("",!0)]),e("div",it,[t[22]||(t[22]=e("label",{for:"action_link2_href",class:"form-label"},"行動連結2網址",-1)),c(e("input",{type:"text",class:r(["form-control",{"is-invalid":a.errors.action_link2_href}]),id:"action_link2_href","onUpdate:modelValue":t[6]||(t[6]=o=>a.bannerData.action_link2_href=o)},null,2),[[_,a.bannerData.action_link2_href]]),a.errors.action_link2_href?(s(),l("div",rt,d(a.errors.action_link2_href),1)):i("",!0)]),e("div",dt,[t[23]||(t[23]=e("label",{for:"action_link2_text",class:"form-label"},"行動連結2文字",-1)),c(e("input",{type:"text",class:r(["form-control",{"is-invalid":a.errors.action_link2_text}]),id:"action_link2_text","onUpdate:modelValue":t[7]||(t[7]=o=>a.bannerData.action_link2_text=o)},null,2),[[_,a.bannerData.action_link2_text]]),a.errors.action_link2_text?(s(),l("div",ct,d(a.errors.action_link2_text),1)):i("",!0)])]),e("div",_t,[e("div",bt,[t[25]||(t[25]=e("label",{for:"status",class:"form-label"},"狀態",-1)),c(e("select",{class:r(["form-select",{"is-invalid":a.errors.status}]),id:"status","onUpdate:modelValue":t[8]||(t[8]=o=>a.bannerData.status=o)},t[24]||(t[24]=[e("option",{value:"active"},"啟用",-1),e("option",{value:"inactive"},"未啟用",-1)]),2),[[j,a.bannerData.status]]),a.errors.status?(s(),l("div",mt,d(a.errors.status),1)):i("",!0)]),e("div",vt,[t[27]||(t[27]=e("label",{for:"image",class:"form-label"},[B("圖片 "),e("span",{class:"text-danger"},"*")],-1)),e("input",{type:"file",class:r(["form-control",{"is-invalid":a.errors.image}]),name:"image",id:"image",onChange:t[9]||(t[9]=(...o)=>a.handleImageChange&&a.handleImageChange(...o)),accept:".jpg,.jpeg,.gif,.png,.webp",required:""},null,34),t[28]||(t[28]=e("small",{class:"form-text text-muted"},"只能上傳 jpg、jpeg、gif、png 或 webp 格式的圖片",-1)),a.errors.image?(s(),l("div",ft,d(a.errors.image),1)):i("",!0),a.imagePreview?(s(),l("div",kt,[e("img",{src:a.imagePreview,alt:"Banner Preview",class:"img-fluid",style:{"max-width":"200px"}},null,8,ut),t[26]||(t[26]=e("br",null,null,-1)),e("button",{type:"button",class:"btn btn-sm btn-danger mt-2",onClick:t[10]||(t[10]=(...o)=>a.clearImage&&a.clearImage(...o))},"清除圖片")])):i("",!0)]),e("div",gt,[t[29]||(t[29]=e("label",{for:"sort",class:"form-label"},"排序",-1)),c(e("input",{type:"number",class:r(["form-control",{"is-invalid":a.errors.sort}]),id:"sort","onUpdate:modelValue":t[11]||(t[11]=o=>a.bannerData.sort=o)},null,2),[[_,a.bannerData.sort]]),a.errors.sort?(s(),l("div",yt,d(a.errors.sort),1)):i("",!0)])])]),e("div",xt,[e("button",{type:"submit",class:"btn btn-primary me-2",disabled:a.isLoading},d(a.isLoading?"新增中...":"新增橫幅"),9,pt),e("button",{type:"button",class:"btn btn-secondary",onClick:t[12]||(t[12]=(...o)=>a.goBack&&a.goBack(...o)),disabled:a.isLoading}," 返回 ",8,Dt)])],32)])])])])]),M(u)])]),e("div",{class:r(["modal",{"d-block":a.showModal}]),tabindex:"-1"},[e("div",ht,[e("div",wt,[e("div",Mt,[t[31]||(t[31]=e("h5",{class:"modal-title"},"提示",-1)),e("button",{type:"button",class:"btn-close",onClick:t[14]||(t[14]=(...o)=>a.closeModal&&a.closeModal(...o))})]),e("div",{class:"modal-body",innerHTML:a.modalMessage},null,8,Bt),e("div",Vt,[e("button",{type:"button",class:"btn btn-secondary",onClick:t[15]||(t[15]=(...o)=>a.closeModal&&a.closeModal(...o))},"關閉")])])])],2),a.showModal?(s(),l("div",Ct)):i("",!0)],64)}const At=U(T,[["render",Ut],["__scopeId","data-v-f1667aee"]]);export{At as default};
