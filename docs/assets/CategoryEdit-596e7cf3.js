import{_ as h,i as w,u as N,r as i,j as C,k as d,o as g,c as p,b as a,l as u,d as I,e as x,g as S,a as y,y as k,p as F,F as L,m as V}from"./index-dd0c0eb2.js";import{F as B,N as R,_ as T}from"./sidebar-0cb9a7ca.js";import{a as b}from"./api-service-a37f4a4e.js";import{L as j}from"./loading-196c643f.js";const D={components:{Footer:B,Navbar:R,Sidebar:T,Loading:j},setup(){const _=w(),e=N(),c=i(""),t=i(null),m=i(""),n=i(!1),r=i(null);return C(async()=>{try{const s=e.params.id;n.value=!0;const o=await b.getTag(s);n.value=!1,c.value=o.name,o.featured_image&&(m.value=o.featured_image,r.value=null)}catch(s){console.error("獲取分類失敗:",s),n.value=!1,r.value="無法載入分類資料"}finally{n.value=!1}}),{categoryName:c,handleSubmit:async()=>{try{const s=e.params.id;n.value=!0;const o=new FormData;o.append("name",c.value),t.value&&o.append("featured_image",t.value),await b.editTag(s,o),n.value=!1,_.push({name:"category-list"})}catch(s){console.error("更新失敗:",s),r.value="儲存分類時發生錯誤"}},handleImageChange:s=>{const o=s.target.files[0];o&&(t.value=o,m.value=URL.createObjectURL(o))},loading:n,imagePreview:m}}},E={class:"main-wrapper"},M={class:"page-wrapper"},P={class:"page-content"},U={class:"row mb-4"},q={class:"col-md-12 grid-margin stretch-card"},O={class:"card"},z={class:"card-body"},A={class:"mb-3"},G={class:"mb-3"},H={key:0,class:"mt-2"},J=["src"],K={class:"d-flex justify-content-end"};function Q(_,e,c,t,m,n){const r=d("Sidebar"),v=d("Navbar"),f=d("router-link"),s=d("Footer"),o=d("Loading");return g(),p(L,null,[a("div",E,[u(r),a("div",M,[u(v),a("div",P,[a("div",U,[a("div",q,[a("div",O,[a("div",z,[e[7]||(e[7]=a("h6",{class:"card-title"},"編輯課程分類",-1)),a("form",{onSubmit:e[2]||(e[2]=I((...l)=>t.handleSubmit&&t.handleSubmit(...l),["prevent"]))},[a("div",A,[e[3]||(e[3]=a("label",{for:"categoryName",class:"form-label"},"分類名稱",-1)),x(a("input",{type:"text",class:"form-control",id:"categoryName","onUpdate:modelValue":e[0]||(e[0]=l=>t.categoryName=l),required:""},null,512),[[S,t.categoryName]])]),a("div",G,[e[4]||(e[4]=a("label",{for:"featuredImage",class:"form-label"},"分類圖片",-1)),a("input",{type:"file",class:"form-control",id:"featuredImage",onChange:e[1]||(e[1]=(...l)=>t.handleImageChange&&t.handleImageChange(...l)),accept:"image/*"},null,32),t.imagePreview?(g(),p("div",H,[a("img",{src:t.imagePreview,class:"img-preview",alt:"分類圖片預覽"},null,8,J)])):y("",!0)]),a("div",K,[u(f,{class:"btn btn-secondary me-2",to:{name:"category-list"}},{default:k(()=>e[5]||(e[5]=[V(" 取消 ")])),_:1}),e[6]||(e[6]=a("button",{type:"submit",class:"btn btn-primary"},"儲存",-1))])],32)])])])])]),u(s)])]),t.loading?(g(),F(o,{key:0})):y("",!0)],64)}const $=h(D,[["render",Q],["__scopeId","data-v-d3629289"]]);export{$ as default};
