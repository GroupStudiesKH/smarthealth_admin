import{_ as A,u as E,p as L,r as l,i as S,j as b,o as w,c as F,k as g,b as e,t as U,e as f,g as q,v as N,n as P,h as H,a as V}from"./index-c9f32b28.js";import{F as T,N as j,_ as Q,a as h}from"./sidebar-1418a09a.js";import{C as B,U as D}from"./UploadAdapter-71b848d5.js";const R={components:{Footer:T,Navbar:j,Sidebar:Q},setup(){const d=E(),o=L(),y=l([]),s=l({id:null,title:"",content:"",sort:0,status:"active",type:"faq"}),v=l({}),i=l(!1),r=l(""),c=l(null),u=l(!1),a=async()=>{try{const t=await h.getPost({id:d.params.id});s.value={...t}}catch(t){console.error("Error fetching FAQ:",t),alert("獲取FAQ資料失敗，請稍後再試")}},M=async()=>{var t,m;try{if(d.params.id){const n=await h.updatePost(s.value.id,s.value)}else{const n=await h.createPost(s.value)}o.push({name:"faqList"})}catch(n){if(console.error("Failed to save member:",n),((m=(t=n.response)==null?void 0:t.data)==null?void 0:m.status)==="error")if(n.response.data.content){const p={};for(const[C,_]of Object.entries(n.response.data.content))p[C]=Array.isArray(_)?_[0].replace(/[\[\]"]/g,""):_;v.value=p;const x=Object.values(p).join("<br/>");r.value=x,i.value=!0}else r.value=n.response.data.message||"儲存失敗",i.value=!0;else r.value="儲存失敗",i.value=!0}};S(async()=>{d.params.id&&(await a(),u.value=!0),c.value=await B.create(document.querySelector("#editor"),{removePlugins:["Markdown"],extraPlugins:[k],toolbar:["heading","|","bold","italic","link","bulletedList","numberedList","blockQuote","imageUpload"],heading:{options:[{model:"paragraph",title:"Paragraph",class:"ck-heading_paragraph"},{model:"heading1",view:"h2",title:"Heading 1",class:"ck-heading_heading1"},{model:"heading2",view:"h3",title:"Heading 2",class:"ck-heading_heading2"}]}}).then(t=>(t.model.document.on("change:data",()=>{s.value.content=t.getData()}),t)).catch(t=>{console.error(t)})});function k(t){t.plugins.get("FileRepository").createUploadAdapter=m=>new D(m)}return{faqList:y,currentFaq:s,editor:c,editFaq:a,saveFaq:M,showModal:i,modalMessage:r,errors:v,isEdit:u}}},z={class:"main-wrapper"},O={class:"page-wrapper"},G={class:"page-content"},J={class:"row"},K={class:"col-md-12 grid-margin stretch-card"},W={class:"card"},X={class:"card-body"},Y={class:"card-title"},Z={class:"row mb-4"},I={class:"col-12"},$={class:"col-12 my-3"},ee=["innerHTML"],oe={class:"col-6"},se={class:"col-6"},te={class:"col-12 d-flex align-items-end my-3"},ae={class:"modal-dialog"},ne={class:"modal-content"},le={class:"modal-header"},re=["innerHTML"],ie={class:"modal-footer"},de={key:0,class:"modal-backdrop fade show"};function ce(d,o,y,s,v,i){const r=b("Navbar"),c=b("Sidebar"),u=b("Footer");return w(),F("div",z,[g(r),g(c),e("div",O,[e("div",G,[e("div",J,[e("div",K,[e("div",W,[e("div",X,[e("h6",Y,"FAQ "+U(s.isEdit?"管理":"新增"),1),e("div",Z,[e("div",I,[o[6]||(o[6]=e("label",{class:"form-label"},"標題",-1)),f(e("input",{type:"text",class:"form-control","onUpdate:modelValue":o[0]||(o[0]=a=>s.currentFaq.title=a)},null,512),[[q,s.currentFaq.title]])]),e("div",$,[o[7]||(o[7]=e("label",{class:"form-label"},"內容編輯",-1)),e("div",{id:"editor",innerHTML:s.currentFaq.content},null,8,ee)]),e("div",oe,[o[9]||(o[9]=e("label",{class:"form-label"},"狀態",-1)),f(e("select",{class:"form-select","onUpdate:modelValue":o[1]||(o[1]=a=>s.currentFaq.status=a)},o[8]||(o[8]=[e("option",{value:"active"},"啟用",-1),e("option",{value:"inactive"},"停用",-1)]),512),[[N,s.currentFaq.status]])]),e("div",se,[o[10]||(o[10]=e("label",{class:"form-label"},"排序",-1)),f(e("input",{type:"number",class:"form-control","onUpdate:modelValue":o[2]||(o[2]=a=>s.currentFaq.sort=a)},null,512),[[q,s.currentFaq.sort,void 0,{number:!0}]])]),e("div",te,[e("button",{class:"btn btn-primary w-100",onClick:o[3]||(o[3]=(...a)=>s.saveFaq&&s.saveFaq(...a))}," 儲存變更 ")])])])])])]),g(u)])]),e("div",{class:P(["modal fade",{show:s.showModal}]),tabindex:"-1",style:H({display:s.showModal?"block":"none"})},[e("div",ae,[e("div",ne,[e("div",le,[o[11]||(o[11]=e("h5",{class:"modal-title"},"錯誤提示",-1)),e("button",{type:"button",class:"btn-close",onClick:o[4]||(o[4]=a=>s.showModal=!1)})]),e("div",{class:"modal-body",innerHTML:s.modalMessage},null,8,re),e("div",ie,[e("button",{type:"button",class:"btn btn-secondary",onClick:o[5]||(o[5]=a=>s.showModal=!1)}," 關閉 ")])])])],6),s.showModal?(w(),F("div",de)):V("",!0)])}const pe=A(R,[["render",ce],["__scopeId","data-v-9c612959"]]);export{pe as default};
