import{_ as F,p as N,u as C,q as P,r as V,i as j,j as g,o as t,c as r,k as p,b as a,t as d,d as O,l as n,e,g as i,n as m,a as c,s as T,v as B,F as L,f as R,x as D,y as A,h as H}from"./index-20bcdf47.js";import{F as I,N as q,_ as G,a as U}from"./sidebar-d8a107a2.js";const J={components:{Footer:I,Navbar:q,Sidebar:G},setup(){const S=N(),o=C(),_=o.params.id!==void 0,l=o.params.id,v=P({name:"",email:"",password:"",showPassword:!1,status:"active",created_at:"",last_login_at:"",registration_source:"",last_login_ip:"",role:"",roleOptions:[{value:"student",label:"學生"},{value:"teacher",label:"老師"},{value:"doctor",label:"醫師"},{value:"nurse",label:"護理人員"},{value:"vendor",label:"廠商"},{value:"other",label:"其他"}],organization:"",national_id:"",address:"",mobile:"",gender:"",birthdate:""}),y=V({}),b=V(!1),f=V(""),k=async()=>{if(_)try{const s=await U.getMember(l);Object.assign(v,s)}catch(s){console.error("Failed to fetch member data:",s),f.value="獲取會員資料失敗",b.value=!0}},w=async()=>{var s,h;try{y.value={},_?await U.editMember(l,v):await U.addMember(v),S.push("/member")}catch(u){if(console.error("Failed to save member:",u),((h=(s=u.response)==null?void 0:s.data)==null?void 0:h.status)==="error")if(u.response.data.content){const x={};for(const[z,M]of Object.entries(u.response.data.content))x[z]=Array.isArray(M)?M[0].replace(/[\[\]"]/g,""):M;y.value=x;const E=Object.values(x).join("<br/>");f.value=E,b.value=!0}else f.value=u.response.data.message||"儲存失敗",b.value=!0;else f.value="儲存失敗",b.value=!0}};return j(()=>{k()}),{formData:v,errors:y,isEdit:_,showModal:b,modalMessage:f,handleSubmit:w}}},K={class:"main-wrapper"},Q={class:"page-wrapper"},W={class:"page-content"},X={class:"row"},Y={class:"col-md-12 grid-margin stretch-card"},Z={class:"card"},$={class:"card-body"},oo={class:"card-title"},ao={class:"row"},lo={class:"col-md-6 col-12 mb-3"},so=["disabled"],eo={key:0,class:"invalid-feedback"},to={class:"col-md-6 col-12 mb-3"},ro={key:0,class:"invalid-feedback"},no={class:"col-md-6 col-12 mb-3"},io={class:"input-group"},mo=["type","placeholder"],co={class:"material-icons"},bo={key:0,class:"invalid-feedback"},fo={class:"col-md-6 col-12 mb-3"},vo=["value"],uo={key:0,class:"invalid-feedback"},_o={class:"col-md-6 col-12 mb-3"},yo={key:0,class:"invalid-feedback"},go={class:"col-md-6 col-12 mb-3"},po={class:"col-md-6 col-12 mb-3"},Do={class:"col-md-6 col-12 mb-3"},ko={key:0,class:"invalid-feedback"},wo={class:"col-md-6 col-12 mb-3"},xo={class:"form-check"},Mo={class:"form-check"},Vo={key:0,class:"invalid-feedback"},Uo={class:"col-md-6 col-12 mb-3"},So={class:"form-check"},ho={class:"form-check"},Eo={class:"form-check"},zo={class:"col-md-6 col-12 mb-3"},Fo={key:0},No={class:"col-md-6 col-12 mb-3"},Co={class:"col-md-6 col-12 mb-3"},Po={class:"col-md-6 col-12 mb-3"},jo={class:"col-md-6 col-12 mb-3"},Oo={class:"modal-dialog"},To={class:"modal-content"},Bo={class:"modal-header"},Lo=["innerHTML"],Ro={class:"modal-footer"},Ao={key:0,class:"modal-backdrop fade show"};function Ho(S,o,_,l,v,y){const b=g("Sidebar"),f=g("Navbar"),k=g("router-link"),w=g("Footer");return t(),r("div",K,[p(b),a("div",Q,[p(f),a("div",W,[a("div",X,[a("div",Y,[a("div",Z,[a("div",$,[a("h6",oo,d(l.isEdit?"編輯會員":"新增會員"),1),a("form",{onSubmit:o[18]||(o[18]=O((...s)=>l.handleSubmit&&l.handleSubmit(...s),["prevent"]))},[a("div",ao,[a("div",lo,[o[21]||(o[21]=a("label",{class:"form-label"},[n("Email "),a("span",{class:"text-danger"},"*")],-1)),e(a("input",{type:"email",class:m(["form-control",{"is-invalid":l.errors.email}]),"onUpdate:modelValue":o[0]||(o[0]=s=>l.formData.email=s),disabled:l.isEdit},null,10,so),[[i,l.formData.email]]),l.errors.email?(t(),r("div",eo,d(l.errors.email),1)):c("",!0)]),a("div",to,[o[22]||(o[22]=a("label",{class:"form-label"},[n("會員名稱 "),a("span",{class:"text-danger"},"*")],-1)),e(a("input",{type:"text",class:m(["form-control",{"is-invalid":l.errors.name}]),"onUpdate:modelValue":o[1]||(o[1]=s=>l.formData.name=s)},null,2),[[i,l.formData.name]]),l.errors.name?(t(),r("div",ro,d(l.errors.name),1)):c("",!0)]),a("div",no,[o[23]||(o[23]=a("label",{class:"form-label"},[n("密碼 "),a("span",{class:"text-danger"},"*")],-1)),a("div",io,[e(a("input",{type:l.formData.showPassword?"text":"password",class:m(["form-control",{"is-invalid":l.errors.password}]),"onUpdate:modelValue":o[2]||(o[2]=s=>l.formData.password=s),placeholder:l.isEdit?"不修改請留空":""},null,10,mo),[[T,l.formData.password]]),a("button",{class:"btn btn-outline-secondary",type:"button",onClick:o[3]||(o[3]=s=>l.formData.showPassword=!l.formData.showPassword)},[a("i",co,d(l.formData.showPassword?"visibility_off":"visibility"),1)]),l.errors.password?(t(),r("div",bo,d(l.errors.password),1)):c("",!0)])]),a("div",fo,[o[25]||(o[25]=a("label",{class:"form-label"},[n("身份別 "),a("span",{class:"text-danger"},"*")],-1)),e(a("select",{class:m(["form-select",{"is-invalid":l.errors.role}]),"onUpdate:modelValue":o[4]||(o[4]=s=>l.formData.role=s)},[o[24]||(o[24]=a("option",{value:""},"請選擇身份別",-1)),(t(!0),r(L,null,R(l.formData.roleOptions,s=>(t(),r("option",{key:s.value,value:s.value},d(s.label),9,vo))),128))],2),[[B,l.formData.role]]),l.errors.role?(t(),r("div",uo,d(l.errors.role),1)):c("",!0)]),a("div",_o,[o[26]||(o[26]=a("label",{class:"form-label"},[n("任職單位 "),a("span",{class:"text-danger"},"*")],-1)),e(a("input",{type:"text",class:m(["form-control",{"is-invalid":l.errors.organization}]),"onUpdate:modelValue":o[5]||(o[5]=s=>l.formData.organization=s)},null,2),[[i,l.formData.organization]]),l.errors.organization?(t(),r("div",yo,d(l.errors.organization),1)):c("",!0)]),a("div",go,[o[27]||(o[27]=a("label",{class:"form-label"},[n("身分證字號 "),a("span",{class:"text-danger"},"*")],-1)),e(a("input",{type:"text",class:m(["form-control",{"is-invalid":l.errors.national_id}]),"onUpdate:modelValue":o[6]||(o[6]=s=>l.formData.national_id=s)},null,2),[[i,l.formData.national_id]])]),a("div",po,[o[28]||(o[28]=a("label",{class:"form-label"},[n("地址 "),a("span",{class:"text-danger"},"*")],-1)),e(a("input",{type:"text",class:m(["form-control",{"is-invalid":l.errors.address}]),"onUpdate:modelValue":o[7]||(o[7]=s=>l.formData.address=s)},null,2),[[i,l.formData.address]])]),a("div",Do,[o[29]||(o[29]=a("label",{class:"form-label"},[n("手機 "),a("span",{class:"text-danger"},"*")],-1)),e(a("input",{type:"tel",class:m(["form-control",{"is-invalid":l.errors.mobile}]),"onUpdate:modelValue":o[8]||(o[8]=s=>l.formData.mobile=s)},null,2),[[i,l.formData.mobile]]),l.errors.mobile?(t(),r("div",ko,d(l.errors.mobile),1)):c("",!0)]),a("div",wo,[o[32]||(o[32]=a("label",{class:"form-label"},[n("性別 "),a("span",{class:"text-danger"},"*")],-1)),a("div",xo,[e(a("input",{type:"radio",class:"form-check-input",id:"male",value:"male","onUpdate:modelValue":o[9]||(o[9]=s=>l.formData.gender=s)},null,512),[[D,l.formData.gender]]),o[30]||(o[30]=a("label",{class:"form-check-label",for:"male"},"男性",-1))]),a("div",Mo,[e(a("input",{type:"radio",class:"form-check-input",id:"female",value:"female","onUpdate:modelValue":o[10]||(o[10]=s=>l.formData.gender=s)},null,512),[[D,l.formData.gender]]),o[31]||(o[31]=a("label",{class:"form-check-label",for:"female"},"女性",-1))]),l.errors.gender?(t(),r("div",Vo,d(l.errors.gender),1)):c("",!0)]),a("div",Uo,[o[35]||(o[35]=a("label",{class:"form-label"},"狀態",-1)),a("div",So,[a("div",ho,[e(a("input",{type:"radio",class:"form-check-input",id:"active",value:"active","onUpdate:modelValue":o[11]||(o[11]=s=>l.formData.status=s)},null,512),[[D,l.formData.status]]),o[33]||(o[33]=a("label",{class:"form-check-label",for:"active"},"啟用",-1))]),a("div",Eo,[e(a("input",{type:"radio",class:"form-check-input",id:"inactive",value:"inactive","onUpdate:modelValue":o[12]||(o[12]=s=>l.formData.status=s)},null,512),[[D,l.formData.status]]),o[34]||(o[34]=a("label",{class:"form-check-label",for:"inactive"},"停用",-1))])])]),a("div",zo,[o[36]||(o[36]=a("label",{class:"form-label"},[n("生日 "),a("span",{class:"text-danger"},"*")],-1)),e(a("input",{type:"date",class:"form-control","onUpdate:modelValue":o[13]||(o[13]=s=>l.formData.birthdate=s)},null,512),[[i,l.formData.birthdate]])]),l.isEdit?(t(),r("div",Fo,[a("div",No,[o[37]||(o[37]=a("label",{class:"form-label"},"註冊日期",-1)),e(a("input",{type:"text",class:"form-control","onUpdate:modelValue":o[14]||(o[14]=s=>l.formData.created_at=s),disabled:""},null,512),[[i,l.formData.created_at]])]),a("div",Co,[o[38]||(o[38]=a("label",{class:"form-label"},"上次登入日期",-1)),e(a("input",{type:"text",class:"form-control","onUpdate:modelValue":o[15]||(o[15]=s=>l.formData.last_login_at=s),disabled:""},null,512),[[i,l.formData.last_login_at]])]),a("div",Po,[o[39]||(o[39]=a("label",{class:"form-label"},"註冊來源",-1)),e(a("input",{type:"text",class:"form-control","onUpdate:modelValue":o[16]||(o[16]=s=>l.formData.registration_source=s),disabled:""},null,512),[[i,l.formData.registration_source]])]),a("div",jo,[o[40]||(o[40]=a("label",{class:"form-label"},"上次登入IP",-1)),e(a("input",{type:"text",class:"form-control","onUpdate:modelValue":o[17]||(o[17]=s=>l.formData.last_login_ip=s),disabled:""},null,512),[[i,l.formData.last_login_ip]])])])):c("",!0)]),o[42]||(o[42]=a("button",{type:"submit",class:"btn btn-primary me-2"},"儲存",-1)),p(k,{to:"/member",class:"btn btn-secondary"},{default:A(()=>o[41]||(o[41]=[n("取消")])),_:1})],32)])])])])]),p(w)]),a("div",{class:m(["modal fade",{show:l.showModal}]),tabindex:"-1",style:H({display:l.showModal?"block":"none"})},[a("div",Oo,[a("div",To,[a("div",Bo,[o[43]||(o[43]=a("h5",{class:"modal-title"},"錯誤提示",-1)),a("button",{type:"button",class:"btn-close",onClick:o[19]||(o[19]=s=>l.showModal=!1)})]),a("div",{class:"modal-body",innerHTML:l.modalMessage},null,8,Lo),a("div",Ro,[a("button",{type:"button",class:"btn btn-secondary",onClick:o[20]||(o[20]=s=>l.showModal=!1)},"關閉")])])])],6),l.showModal?(t(),r("div",Ao)):c("",!0)])}const Go=F(J,[["render",Ho]]);export{Go as default};
