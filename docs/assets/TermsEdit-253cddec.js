import{_ as C,u as F,i as N,r as a,j as S,k as v,o as b,c as y,b as e,l as f,e as w,g as T,v as U,n as E,h as H,a as k,p as P,F as A}from"./index-5d22d589.js";import{F as V,N as j,_ as B}from"./sidebar-5fc827b6.js";import{a as M}from"./api-service-a37f4a4e.js";import{C as R,U as z}from"./UploadAdapter-783db528.js";import{L as D}from"./loading-fb24fc9e.js";const O={components:{Footer:V,Navbar:j,Sidebar:B,Loading:D},setup(){F(),N();const h=a([]),o=a(!1),l=a({id:null,title:"",content:"",sort:0,status:"active",type:"post"}),t=a({}),n=a(!1),r=a(""),i=a(null),c=async()=>{try{o.value=!0;const s=await M.getPost({type:"terms"});l.value={...s},o.value=!1}catch(s){o.value=!1,console.error("Error fetching post:",s),alert("獲取文章資料失敗，請稍後再試")}},p=async()=>{var s,u;try{o.value=!0;const d=await M.updatePost(l.value.id,l.value);o.value=!1,r.value="儲存成功",n.value=!0}catch(d){if(o.value=!1,console.error("Failed to save member:",d),((u=(s=d.response)==null?void 0:s.data)==null?void 0:u.status)==="error")if(d.response.data.content){const _={};for(const[x,g]of Object.entries(d.response.data.content))_[x]=Array.isArray(g)?g[0].replace(/[\[\]"]/g,""):g;t.value=_;const L=Object.values(_).join("<br/>");r.value=L,n.value=!0}else r.value=d.response.data.message||"儲存失敗",n.value=!0;else r.value="儲存失敗",n.value=!0}};S(async()=>{await c(),i.value=await R.create(document.querySelector("#editor"),{removePlugins:["Markdown"],extraPlugins:[m],toolbar:["heading","|","bold","italic","link","bulletedList","numberedList","blockQuote","imageUpload"],heading:{options:[{model:"paragraph",title:"Paragraph",class:"ck-heading_paragraph"},{model:"heading1",view:"h2",title:"Heading 1",class:"ck-heading_heading1"},{model:"heading2",view:"h3",title:"Heading 2",class:"ck-heading_heading2"}]}}).then(s=>(s.model.document.on("change:data",()=>{l.value.content=s.getData()}),s)).catch(s=>{console.error(s)})});function m(s){s.plugins.get("FileRepository").createUploadAdapter=u=>new z(u)}return{postList:h,currentpost:l,editor:i,editpost:c,savepost:p,showModal:n,modalMessage:r,errors:t,loading:o}}},q={class:"main-wrapper"},Q={class:"page-wrapper"},G={class:"page-content"},J={class:"row"},K={class:"col-md-12 grid-margin stretch-card"},W={class:"card"},X={class:"card-body"},Y={class:"row mb-4"},Z={class:"col-12"},I={class:"col-12 my-3"},$=["innerHTML"],ee={class:"col-6"},oe={class:"col-6 d-flex align-items-end"},se={class:"modal-dialog"},te={class:"modal-content"},ae={class:"modal-header"},le=["innerHTML"],ne={class:"modal-footer"},re={key:0,class:"modal-backdrop fade show"};function de(h,o,l,t,n,r){const i=v("Navbar"),c=v("Sidebar"),p=v("Footer"),m=v("Loading");return b(),y(A,null,[e("div",q,[f(i),f(c),e("div",Q,[e("div",G,[e("div",J,[e("div",K,[e("div",W,[e("div",X,[o[9]||(o[9]=e("h6",{class:"card-title"},"使用者條款編輯",-1)),e("div",Y,[e("div",Z,[o[5]||(o[5]=e("label",{class:"form-label"},"標題",-1)),w(e("input",{type:"text",class:"form-control",disabled:"","onUpdate:modelValue":o[0]||(o[0]=s=>t.currentpost.title=s)},null,512),[[T,t.currentpost.title]])]),e("div",I,[o[6]||(o[6]=e("label",{class:"form-label"},"內容編輯",-1)),e("div",{id:"editor",innerHTML:t.currentpost.content},null,8,$)]),e("div",ee,[o[8]||(o[8]=e("label",{class:"form-label"},"狀態",-1)),w(e("select",{class:"form-select","onUpdate:modelValue":o[1]||(o[1]=s=>t.currentpost.status=s)},o[7]||(o[7]=[e("option",{value:"active"},"啟用",-1),e("option",{value:"inactive"},"停用",-1)]),512),[[U,t.currentpost.status]])]),e("div",oe,[e("button",{class:"btn btn-primary w-100",onClick:o[2]||(o[2]=(...s)=>t.savepost&&t.savepost(...s))}," 儲存變更 ")])])])])])]),f(p)])]),e("div",{class:E(["modal fade",{show:t.showModal}]),tabindex:"-1",style:H({display:t.showModal?"block":"none"})},[e("div",se,[e("div",te,[e("div",ae,[o[10]||(o[10]=e("h5",{class:"modal-title"},"錯誤提示",-1)),e("button",{type:"button",class:"btn-close",onClick:o[3]||(o[3]=s=>t.showModal=!1)})]),e("div",{class:"modal-body",innerHTML:t.modalMessage},null,8,le),e("div",ne,[e("button",{type:"button",class:"btn btn-secondary",onClick:o[4]||(o[4]=s=>t.showModal=!1)}," 關閉 ")])])])],6),t.showModal?(b(),y("div",re)):k("",!0)]),t.loading?(b(),P(m,{key:0})):k("",!0)],64)}const me=C(O,[["render",de],["__scopeId","data-v-56ba5f1a"]]);export{me as default};
