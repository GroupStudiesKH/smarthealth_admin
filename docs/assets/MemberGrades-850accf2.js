import{_ as D,p as I,u as M,r as c,q as N,i as x,j as m,o as l,c as r,k as _,b as e,l as C,t as o,F as k,f as p,n as y,d as w,a as F}from"./index-0d87b40a.js";import{F as V,N as E,_ as z,a as R}from"./sidebar-541fb7fa.js";import{S as B}from"./StudentDetailModal-6939d07a.js";const L={components:{Footer:V,Navbar:E,Sidebar:z,StudentDetailModal:B},setup(){I();const t=M().params.id,u=c({name:"",email:"",created_at:""}),a=c([]),b=c(!1),g=c(null),i=c(1),v=c(10),d=c(1),h=N([{key:"name",label:"課程名稱"},{key:"instructor",label:"課程講師"},{key:"category",label:"分類"},{key:"completion_rate",label:"完課率"},{key:"average_score",label:"平均分數"},{key:"actions",label:"操作"}]),s=async()=>{try{const n=await R.getStudentLearningRecord(t,{page:i.value,pageSize:v.value});u.value=n.student,a.value=n.courses,d.value=n.pagination.totalPages}catch(n){console.error("Failed to fetch member info:",n)}},f=n=>{g.value=n,b.value=!0},S=async n=>{i.value=n,await s()};return x(()=>{s()}),{memberInfo:u,tableData:a,tableColumns:h,showModal:b,selectedCourse:g,handleViewDetails:f,currentPage:i,totalPages:d,handlePageChange:S}}},j={class:"main-wrapper"},q={class:"page-wrapper"},T={class:"page-content"},A={class:"row"},G={class:"col-md-12 grid-margin stretch-card"},U={class:"card"},H={class:"card-body"},J={class:"mb-4"},K={class:"row"},O={class:"col-md-4"},Q={class:"mb-2"},W={class:"col-md-4"},X={class:"mb-2"},Y={class:"col-md-4"},Z={class:"mb-2"},$={class:"table-responsive"},ee={class:"table table-hover"},ae=["onClick"],se={key:0,class:"mt-3"},te={class:"pagination justify-content-center"},oe=["onClick"];function ne(P,t,u,a,b,g){const i=m("Sidebar"),v=m("Navbar"),d=m("StudentDetailModal"),h=m("Footer");return l(),r("div",j,[_(i),e("div",q,[_(v),e("div",T,[e("div",A,[e("div",G,[e("div",U,[e("div",H,[t[7]||(t[7]=e("h6",{class:"card-title mb-4"},"學習紀錄統計",-1)),e("div",J,[e("div",K,[e("div",O,[e("p",Q,[t[3]||(t[3]=e("strong",null,"會員名稱：",-1)),C(" "+o(a.memberInfo.name),1)])]),e("div",W,[e("p",X,[t[4]||(t[4]=e("strong",null,"Email：",-1)),C(" "+o(a.memberInfo.email),1)])]),e("div",Y,[e("p",Z,[t[5]||(t[5]=e("strong",null,"註冊日期：",-1)),C(" "+o(new Date(a.memberInfo.created_at).toLocaleDateString()),1)])])])]),e("div",$,[e("table",ee,[e("thead",null,[e("tr",null,[(l(!0),r(k,null,p(a.tableColumns,s=>(l(),r("th",{key:s.key},o(s.label),1))),128))])]),e("tbody",null,[(l(!0),r(k,null,p(a.tableData,s=>(l(),r("tr",{key:s.id},[e("td",null,o(s.name),1),e("td",null,o(s.instructor),1),e("td",null,o(s.category),1),e("td",null,o(s.completion_rate),1),e("td",null,o(s.average_score),1),e("td",null,[e("button",{class:"btn btn-sm btn-info",onClick:f=>a.handleViewDetails(s)},t[6]||(t[6]=[e("i",{class:"material-icons"},"visibility",-1)]),8,ae)])]))),128))])])]),a.totalPages>1?(l(),r("nav",se,[e("ul",te,[e("li",{class:y(["page-item",{disabled:a.currentPage===1}])},[e("a",{class:"page-link",href:"#",onClick:t[0]||(t[0]=w(s=>a.handlePageChange(a.currentPage-1),["prevent"]))},"上一頁")],2),(l(!0),r(k,null,p(a.totalPages,s=>(l(),r("li",{key:s,class:y(["page-item",{active:a.currentPage===s}])},[e("a",{class:"page-link",href:"#",onClick:w(f=>a.handlePageChange(s),["prevent"])},o(s),9,oe)],2))),128)),e("li",{class:y(["page-item",{disabled:a.currentPage===a.totalPages}])},[e("a",{class:"page-link",href:"#",onClick:t[1]||(t[1]=w(s=>a.handlePageChange(a.currentPage+1),["prevent"]))},"下一頁")],2)])])):F("",!0),_(d,{show:a.showModal,"onUpdate:show":t[2]||(t[2]=s=>a.showModal=s),student:{name:a.memberInfo.name,email:a.memberInfo.email,courseName:a.selectedCourse?a.selectedCourse.name:"-",totalTime:a.selectedCourse?"計算中":"-",lastAccess:a.memberInfo.created_at,progress:a.selectedCourse?parseInt(a.selectedCourse.completion_rate):0,chapterProgress:a.selectedCourse?a.selectedCourse.chapters.map(s=>({name:s.name,progress:s.completion?100:0,score:s.score})):[],quizResults:a.selectedCourse?[...a.selectedCourse.chapters.filter(s=>s.score).map(s=>({name:`${s.name}測驗`,score:s.score,date:"-",isExam:!1})),{name:"期中考試",score:85,date:"2023-12-01",isExam:!0},{name:"期末考試",score:90,date:"2023-12-15",isExam:!0}]:[]}},null,8,["show","student"])])])])])]),_(h)])])}const ie=D(L,[["render",ne]]);export{ie as default};
