import{_ as U,r as y,w as E,o as u,c,a as e,t as f,b as R,d as p,v as V,F as g,e as F,f as C,g as q,h as M,i as A,j as S,u as H,k as O,l as Q,m as x,n as N}from"./index-05809435.js";import{F as L,N as j,_ as B}from"./sidebar-79652a8d.js";const D={name:"QuestionModal",props:{show:{type:Boolean,required:!0},questionData:{type:Object,default:()=>({id:null,type:"是非題",content:"",chapter:"",options:[],answer:null,explanation:""})},isEdit:{type:Boolean,default:!1}},emits:["update:show","save"],setup(k,{emit:t}){const n=y({...k.questionData}),o=["是非題","單選題","多選題"],h=["第一章：FHIR基礎概念","第二章：FHIR應用","第三章：電子病歷系統","第四章：醫療標準規範","第五章：醫療資訊交換","期中考試","期末考試"],d=y(n.value.options||[]);E(()=>n.value.type,v=>{v==="是非題"?(n.value.answer=null,n.value.options=[]):(n.value.answer=v==="單選題"?null:[],d.value.length===0&&(d.value=["","","",""],n.value.options=d.value),v==="多選題"&&!Array.isArray(n.value.answer)&&(n.value.answer=[]))});const s=()=>{d.value.push(""),n.value.options=d.value},m=v=>{d.value.splice(v,1),n.value.options=d.value,n.value.type==="單選題"?n.value.answer>=v&&(n.value.answer=null):n.value.type==="多選題"&&(n.value.answer=n.value.answer.filter(w=>w<v))},r=(v,w)=>{d.value[v]=w,n.value.options=d.value},_=v=>{Array.isArray(n.value.answer)||(n.value.answer=[]);const w=n.value.answer.indexOf(v);w===-1?n.value.answer.push(v):n.value.answer.splice(w,1),n.value.answer.sort((a,i)=>a-i)},l=()=>{t("update:show",!1)};return{questionForm:n,questionTypes:o,chapterOptions:h,options:d,addOption:s,removeOption:m,updateOption:r,toggleMultipleAnswer:_,closeModal:l,saveQuestion:()=>{t("save",n.value),l()}}}},T={key:0,class:"modal fade show d-block",tabindex:"-1",role:"dialog","aria-hidden":"true"},z={class:"modal-dialog modal-lg",role:"document"},G={class:"modal-content"},J={class:"modal-header"},K={class:"modal-title"},P={class:"modal-body"},W={class:"mb-3"},X=["value"],Y={class:"mb-3"},Z=["value"],$={class:"mb-3"},ee={class:"mb-3"},te={key:0,class:"d-flex gap-3"},oe={class:"form-check"},se={class:"form-check"},ne={key:1},le={class:"mb-2 d-flex justify-content-end"},ae={class:"form-check flex-grow-1"},ie=["type","value","onChange"],re=["onUpdate:modelValue","onInput"],de=["onClick","disabled"],ue={class:"mb-3"},ce={class:"modal-footer"};function me(k,t,n,o,h,d){return n.show?(u(),c("div",T,[e("div",z,[e("div",G,[e("div",J,[e("h5",K,f(n.isEdit?"編輯題目":"新增題目"),1),e("button",{type:"button",class:"btn-close",onClick:t[0]||(t[0]=(...s)=>o.closeModal&&o.closeModal(...s))})]),e("div",P,[e("form",{onSubmit:t[10]||(t[10]=R((...s)=>o.saveQuestion&&o.saveQuestion(...s),["prevent"]))},[e("div",W,[t[11]||(t[11]=e("label",{class:"form-label"},"題型",-1)),p(e("select",{class:"form-select","onUpdate:modelValue":t[1]||(t[1]=s=>o.questionForm.type=s)},[(u(!0),c(g,null,F(o.questionTypes,s=>(u(),c("option",{key:s,value:s},f(s),9,X))),128))],512),[[V,o.questionForm.type]])]),e("div",Y,[t[13]||(t[13]=e("label",{class:"form-label"},"所屬範圍",-1)),p(e("select",{class:"form-select","onUpdate:modelValue":t[2]||(t[2]=s=>o.questionForm.chapter=s)},[t[12]||(t[12]=e("option",{value:""},"請選擇章節/考試範圍",-1)),(u(!0),c(g,null,F(o.chapterOptions,s=>(u(),c("option",{key:s,value:s},f(s),9,Z))),128))],512),[[V,o.questionForm.chapter]])]),e("div",$,[t[14]||(t[14]=e("label",{class:"form-label"},"題目內容",-1)),p(e("textarea",{class:"form-control","onUpdate:modelValue":t[3]||(t[3]=s=>o.questionForm.content=s),rows:"3",required:""},null,512),[[C,o.questionForm.content]])]),e("div",ee,[t[19]||(t[19]=e("label",{class:"form-label"},"答案設定",-1)),o.questionForm.type==="是非題"?(u(),c("div",te,[e("div",oe,[p(e("input",{type:"radio",class:"form-check-input",value:!0,"onUpdate:modelValue":t[4]||(t[4]=s=>o.questionForm.answer=s),required:""},null,512),[[q,o.questionForm.answer]]),t[15]||(t[15]=e("label",{class:"form-check-label"},"是",-1))]),e("div",se,[p(e("input",{type:"radio",class:"form-check-input",value:!1,"onUpdate:modelValue":t[5]||(t[5]=s=>o.questionForm.answer=s),required:""},null,512),[[q,o.questionForm.answer]]),t[16]||(t[16]=e("label",{class:"form-check-label"},"否",-1))])])):(u(),c("div",ne,[e("div",le,[e("button",{type:"button",class:"btn btn-outline-primary btn-sm",onClick:t[6]||(t[6]=(...s)=>o.addOption&&o.addOption(...s))},t[17]||(t[17]=[e("i",{class:"material-icons align-middle"},"add",-1),M(" 新增選項 ")]))]),(u(!0),c(g,null,F(o.options,(s,m)=>(u(),c("div",{key:m,class:"mb-2 d-flex gap-2 align-items-center"},[e("div",ae,[p(e("input",{type:o.questionForm.type==="單選題"?"radio":"checkbox",class:"form-check-input",value:m,"onUpdate:modelValue":t[7]||(t[7]=r=>o.questionForm.answer=r),onChange:r=>o.questionForm.type==="多選題"&&o.toggleMultipleAnswer(m),required:""},null,40,ie),[[A,o.questionForm.answer]]),p(e("input",{type:"text",class:"form-control","onUpdate:modelValue":r=>o.options[m]=r,onInput:r=>o.updateOption(m,r.target.value),placeholder:"請輸入選項內容",required:""},null,40,re),[[C,o.options[m]]])]),e("button",{type:"button",class:"btn btn-outline-danger btn-sm",onClick:r=>o.removeOption(m),disabled:o.options.length<=2},t[18]||(t[18]=[e("i",{class:"material-icons"},"delete",-1)]),8,de)]))),128))]))]),e("div",ue,[t[20]||(t[20]=e("label",{class:"form-label"},"答案說明",-1)),p(e("textarea",{class:"form-control","onUpdate:modelValue":t[8]||(t[8]=s=>o.questionForm.explanation=s),rows:"2",required:""},null,512),[[C,o.questionForm.explanation]])]),e("div",ce,[e("button",{type:"button",class:"btn btn-secondary",onClick:t[9]||(t[9]=(...s)=>o.closeModal&&o.closeModal(...s))},"取消"),t[21]||(t[21]=e("button",{type:"submit",class:"btn btn-primary"},"儲存",-1))])],32)])])])])):S("",!0)}const ve=U(D,[["render",me],["__scopeId","data-v-531a4e40"]]);const pe={components:{Footer:L,Navbar:j,Sidebar:B,QuestionModal:ve},setup(){H().params.id;const t=y(""),n=y("全部"),o=y([{id:1,type:"是非題",content:"FHIR是一種醫療資訊交換標準",chapter:"第一章：FHIR基礎概念",answer:!0,explanation:"FHIR是一種現代化的醫療資訊交換標準，用於促進醫療系統間的數據互通"},{id:2,type:"單選題",content:"下列哪個不是FHIR的主要目標？",chapter:"第二章：FHIR應用",options:["資料互通性","系統整合","資料加密","標準化"],answer:2,explanation:"FHIR的主要目標是實現醫療資訊的互通性、系統整合和標準化，而不是專注於資料加密"},{id:3,type:"多選題",content:"以下哪些是電子病歷系統的優點？",chapter:"第三章：電子病歷系統",options:["資料標準化","跨院所互通","即時更新","降低錯誤"],answer:[0,1,2,3],explanation:"電子病歷系統具有資料標準化、跨院所互通、即時更新和降低錯誤等多項優點"}]),h=O(()=>{const a=new Set(o.value.map(i=>i.chapter));return["全部",...Array.from(a)]}),d=O(()=>o.value.filter(a=>{const i=t.value.toLowerCase().trim()===""||a.content.toLowerCase().includes(t.value.toLowerCase())||a.explanation&&a.explanation.toLowerCase().includes(t.value.toLowerCase()),b=n.value==="全部"||a.chapter===n.value;return i&&b})),s=a=>a.type==="是非題"?a.answer?"是":"否":a.type==="單選題"?a.options[a.answer]:a.type==="多選題"?a.answer.map(i=>a.options[i]).join("、"):"",m=a=>{const i=o.value.findIndex(b=>b.id===a);i!==-1&&o.value.splice(i,1)},r=y(!1),_=y(null),l=y(!1);return{questions:d,searchQuery:t,selectedChapter:n,chapterOptions:h,formatAnswer:s,deleteQuestion:m,editQuestion:a=>{const i=o.value.find(b=>b.id===a);i&&(_.value={...i},l.value=!0,r.value=!0)},addQuestion:()=>{_.value=null,l.value=!1,r.value=!0},showQuestionModal:r,currentQuestion:_,isEditMode:l,saveQuestion:a=>{if(l.value){const i=o.value.findIndex(b=>b.id===a.id);i!==-1&&(o.value[i]=a)}else{const i=Math.max(...o.value.map(b=>b.id),0)+1;o.value.push({...a,id:i})}}}}},be={class:"main-wrapper"},fe={class:"page-wrapper"},ye={class:"page-content"},_e={class:"row"},we={class:"col-md-12 grid-margin stretch-card"},he={class:"card"},ge={class:"card-body"},Fe={class:"d-flex justify-content-between align-items-center mb-4"},ke={class:"row mb-3"},Qe={class:"col-md-6"},xe={class:"col-md-6"},Ce=["value"],Me={class:"table-responsive"},Ie={class:"table table-hover"},Ve=["onClick"],qe=["onClick"];function Oe(k,t,n,o,h,d){const s=Q("Sidebar"),m=Q("Navbar"),r=Q("Footer"),_=Q("QuestionModal");return u(),c("div",be,[x(s),e("div",fe,[x(m),e("div",ye,[e("div",_e,[e("div",we,[e("div",he,[e("div",ge,[e("div",Fe,[t[5]||(t[5]=e("h6",{class:"card-title mb-0"},"題目管理",-1)),e("button",{class:"btn btn-primary",onClick:t[0]||(t[0]=(...l)=>o.addQuestion&&o.addQuestion(...l))},t[4]||(t[4]=[e("i",{class:"material-icons align-middle me-1"},"add",-1),M(" 新增題目 ")]))]),e("div",ke,[e("div",Qe,[p(e("input",{type:"text",class:"form-control","onUpdate:modelValue":t[1]||(t[1]=l=>o.searchQuery=l),placeholder:"搜尋題目內容或答案說明..."},null,512),[[C,o.searchQuery]])]),e("div",xe,[p(e("select",{class:"form-select","onUpdate:modelValue":t[2]||(t[2]=l=>o.selectedChapter=l)},[(u(!0),c(g,null,F(o.chapterOptions,l=>(u(),c("option",{key:l,value:l},f(l),9,Ce))),128))],512),[[V,o.selectedChapter]])])]),e("div",Me,[e("table",Ie,[t[8]||(t[8]=e("thead",null,[e("tr",null,[e("th",null,"題型"),e("th",null,"題目內容"),e("th",null,"答案"),e("th",null,"答案說明"),e("th",null,"所屬章節/考試"),e("th",null,"操作")])],-1)),e("tbody",null,[(u(!0),c(g,null,F(o.questions,l=>(u(),c("tr",{key:l.id},[e("td",null,[e("span",{class:N(["badge",{"bg-primary":l.type==="單選題","bg-success":l.type==="多選題","bg-info":l.type==="是非題"}])},f(l.type),3)]),e("td",null,f(l.content),1),e("td",null,f(o.formatAnswer(l)),1),e("td",null,f(l.explanation),1),e("td",null,f(l.chapter),1),e("td",null,[e("button",{class:"btn btn-primary btn-sm me-2",onClick:I=>o.editQuestion(l.id)},t[6]||(t[6]=[e("i",{class:"material-icons align-middle"},"edit",-1),M(" 編輯 ")]),8,Ve),e("button",{class:"btn btn-danger btn-sm",onClick:I=>o.deleteQuestion(l.id)},t[7]||(t[7]=[e("i",{class:"material-icons align-middle"},"delete",-1),M(" 刪除 ")]),8,qe)])]))),128))])])])])])])])]),x(r),x(_,{show:o.showQuestionModal,"onUpdate:show":t[3]||(t[3]=l=>o.showQuestionModal=l),questionData:o.currentQuestion,isEdit:o.isEditMode,onSave:o.saveQuestion},null,8,["show","questionData","isEdit","onSave"])])])}const Re=U(pe,[["render",Oe],["__scopeId","data-v-5b955c3c"]]);export{Re as default};
