import{_ as N,i as D,u as M,r as c,q as x,j as z,k as u,o as l,c as r,l as g,b as e,m as k,t as n,F as y,f as C,n as I,d as P,a as F}from"./index-7097d872.js";import{a as R}from"./api-service-28558cf5.js";import{F as V,N as q,_ as T}from"./sidebar-e309ec1f.js";import{S as B}from"./StudentDetailModal-4eea9404.js";const L={components:{Footer:V,Navbar:q,Sidebar:T,StudentDetailModal:B},setup(){D();const s=M().params.id,i=c({name:"",email:"",created_at:"",total_study_hours:0,last_login:""}),t=c([]),b=c(!1),v=c({chapters:[]}),m=c(1),h=c(10),_=c(1),f=x([{key:"name",label:"課程名稱"},{key:"instructor",label:"課程講師"},{key:"category",label:"分類"},{key:"completion_rate",label:"完課率"},{key:"average_score",label:"平均分數"},{key:"actions",label:"操作"}]),a=async()=>{try{const o=await R.getStudentLearningRecord(s,{page:m.value,pageSize:h.value});i.value=o.student,t.value=o.courses,_.value=o.pagination.totalPages}catch(o){console.error("Failed to fetch member info:",o)}},p=o=>{v.value={id:o.id,courseId:o.id,studentId:s,name:i.value.name,email:i.value.email,courseName:o.name,completion_rate:o.completion_rate,totalTime:`${i.value.total_study_hours}小時`,lastAccess:i.value.last_login,chapter:o.chapter.map(d=>({title:d.title,progress:d.progress})),quizResults:o.quizResults.map(d=>({is_pass:d.is_pass,score:d.score,date:d.date||"-",time:d.time||"-"})),examIsPassed:o.examIsPassed},b.value=!0},S=async o=>{m.value=o,await a()};return z(()=>{a()}),{memberId:s,memberInfo:i,tableData:t,tableColumns:f,showModal:b,selectedCourse:v,handleViewDetails:p,currentPage:m,totalPages:_,handlePageChange:S}}},j={class:"main-wrapper"},A={class:"page-wrapper"},E={class:"page-content"},G={class:"row"},U={class:"col-md-12 grid-margin stretch-card"},H={class:"card"},J={class:"card-body"},K={class:"mb-4"},O={class:"row"},Q={class:"col-md-4"},W={class:"mb-2"},X={class:"col-md-4"},Y={class:"mb-2"},Z={class:"col-md-4"},$={class:"mb-2"},ee={class:"table-responsive"},te={class:"table table-hover"},ae=["onClick"],se={key:0,class:"mt-3"},oe={class:"pagination justify-content-center"},ne=["onClick"];function le(w,s,i,t,b,v){const m=u("Sidebar"),h=u("Navbar"),_=u("StudentDetailModal"),f=u("Footer");return l(),r("div",j,[g(m),e("div",A,[g(h),e("div",E,[e("div",G,[e("div",U,[e("div",H,[e("div",J,[s[7]||(s[7]=e("h6",{class:"card-title mb-4"},"學習紀錄統計",-1)),e("div",K,[e("div",O,[e("div",Q,[e("p",W,[s[3]||(s[3]=e("strong",null,"會員名稱：",-1)),k(" "+n(t.memberInfo.name),1)])]),e("div",X,[e("p",Y,[s[4]||(s[4]=e("strong",null,"Email：",-1)),k(" "+n(t.memberInfo.email),1)])]),e("div",Z,[e("p",$,[s[5]||(s[5]=e("strong",null,"註冊日期：",-1)),k(" "+n(new Date(t.memberInfo.created_at).toLocaleDateString()),1)])])])]),e("div",ee,[e("table",te,[e("thead",null,[e("tr",null,[(l(!0),r(y,null,C(t.tableColumns,a=>(l(),r("th",{key:a.key},n(a.label),1))),128))])]),e("tbody",null,[(l(!0),r(y,null,C(t.tableData,a=>(l(),r("tr",{key:a.id},[e("td",null,n(a.name),1),e("td",null,n(a.instructor),1),e("td",null,n(a.category),1),e("td",null,n(a.completion_rate),1),e("td",null,n(a.average_score),1),e("td",null,[e("button",{class:"btn btn-sm btn-info",onClick:p=>t.handleViewDetails(a)},s[6]||(s[6]=[e("i",{class:"material-icons"},"visibility",-1)]),8,ae)])]))),128))])])]),t.totalPages>1?(l(),r("nav",se,[e("ul",oe,[e("li",{class:I(["page-item",{disabled:t.currentPage===1}])},[e("a",{class:"page-link",href:"#",onClick:s[0]||(s[0]=P(a=>t.handlePageChange(t.currentPage-1),["prevent"]))},"上一頁")],2),(l(!0),r(y,null,C(t.totalPages,a=>(l(),r("li",{key:a,class:I(["page-item",{active:t.currentPage===a}])},[e("a",{class:"page-link",href:"#",onClick:P(p=>t.handlePageChange(a),["prevent"])},n(a),9,ne)],2))),128)),e("li",{class:I(["page-item",{disabled:t.currentPage===t.totalPages}])},[e("a",{class:"page-link",href:"#",onClick:s[1]||(s[1]=P(a=>t.handlePageChange(t.currentPage+1),["prevent"]))},"下一頁")],2)])])):F("",!0),g(_,{show:t.showModal,"onUpdate:show":s[2]||(s[2]=a=>t.showModal=a),studentId:t.memberId,courseId:t.selectedCourse.id,student:{name:t.memberInfo.name,email:t.memberInfo.email,courseName:t.selectedCourse.courseName,totalTime:t.selectedCourse.totalTime,lastAccess:t.memberInfo.created_at,progress:parseInt(t.selectedCourse.completion_rate),chapterProgress:t.selectedCourse.chapter,quizResults:t.selectedCourse.quizResults,examIsPassed:t.selectedCourse.examIsPassed}},null,8,["show","studentId","courseId","student"])])])])])]),g(f)])])}const me=N(L,[["render",le]]);export{me as default};
