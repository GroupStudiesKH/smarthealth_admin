import{_ as I,o as i,c as d,b as t,l as _,t as l,F as S,f as C,n as R,a as q,p as F,u as N,r as m,i as A,j as b,k as p,h as M,d as P}from"./index-c474f259.js";import{F as T,N as j,_ as z,a as x}from"./sidebar-cb25b013.js";import{S as H}from"./StudentDetailModal-777b3b5c.js";const B={name:"ExamReviewModal",props:{show:{type:Boolean,required:!0},examData:{type:Object,required:!0}},emits:["update:show"],setup(k,{emit:e}){return{closeModal:()=>{e("update:show",!1)}}}},V={key:0,class:"modal fade show d-block",tabindex:"-1",role:"dialog","aria-hidden":"true"},U={class:"modal-dialog modal-lg",role:"document"},L={class:"modal-content"},O={class:"modal-header"},G={class:"modal-body"},J={class:"exam-info mb-4"},K={class:"row"},Q={class:"col-md-6"},W={class:"answer-list"},X={class:"table-responsive"},Y={class:"table"},Z={key:0,class:"badge bg-success"},$={key:1,class:"badge bg-danger"};function tt(k,e,c,s,h,w){return c.show?(i(),d("div",V,[t("div",U,[t("div",L,[t("div",O,[e[1]||(e[1]=t("h5",{class:"modal-title"},"測驗閱卷詳情",-1)),t("button",{type:"button",class:"btn-close",onClick:e[0]||(e[0]=(...a)=>s.closeModal&&s.closeModal(...a))})]),t("div",G,[t("div",J,[t("div",K,[t("div",Q,[t("p",null,[e[2]||(e[2]=t("strong",null,"測驗名稱：",-1)),_(l(c.examData.examName),1)]),t("p",null,[e[3]||(e[3]=t("strong",null,"測驗時間：",-1)),_(l(c.examData.examTime),1)]),t("p",null,[e[4]||(e[4]=t("strong",null,"考試分數：",-1)),_(l(c.examData.score)+"分",1)])])])]),t("div",W,[e[6]||(e[6]=t("h6",null,"作答詳情",-1)),t("div",X,[t("table",Y,[e[5]||(e[5]=t("thead",null,[t("tr",null,[t("th",null,"題號"),t("th",null,"題目"),t("th",null,"學生答案"),t("th",null,"正確答案"),t("th",null,"是否正確"),t("th",null,"填答時間")])],-1)),t("tbody",null,[(i(!0),d(S,null,C(c.examData.answers,a=>(i(),d("tr",{key:a.questionId,class:R({"table-success":a.isCorrect,"table-danger":!a.isCorrect})},[t("td",null,l(a.questionId),1),t("td",null,l(a.question),1),t("td",null,l(a.studentAnswer),1),t("td",null,l(a.correctAnswer),1),t("td",null,[a.isCorrect?(i(),d("span",Z,"正確")):(i(),d("span",$,"錯誤"))]),t("td",null,l(a.answerTime),1)],2))),128))])])])])])])])])):q("",!0)}const et=I(B,[["render",tt],["__scopeId","data-v-fab8bc24"]]);const st={components:{Footer:T,Navbar:j,Sidebar:z,StudentDetailModal:H,ExamReviewModal:et},setup(){F();const e=N().params.id,c=m(!1),s=m(null),h=m(!1),w=m(null),a=m({name:"",instructor:"",category:"",completionRate:0,averageScore:0,chapters:[],students:[]}),f=m([]),D=m(0),y=m(0),E=async()=>{try{const n=await x.getCourseReport(e);a.value={name:n.title,instructor:n.instructors.join(", "),category:n.categories.join(", "),completionRate:n.completion_rate,averageScore:n.average_score,chapters:n.chapters.map(r=>({name:r.title,completionRate:r.completion_rate}))}}catch(n){console.error("Error loading course report:",n)}},v=async()=>{try{const n=await x.getCourseStudents(e,{page:g.value});f.value=n.students,D.value=n.total,y.value=n.totalPages}catch(n){console.error("Error loading students:",n)}},o=()=>{x.getCourseReportExcel(e)};A(()=>{E(),v()});const g=m(1);return{courseDetail:a,currentPage:g,students:f,totalStudentPages:y,handlePageChange:async n=>{g.value=n,await v()},viewStudent:async n=>{try{const r=await x.getCourseStudent(e,n);s.value={id:n,name:r.student_info.name,email:r.student_info.email,courseName:r.course_info.title,progress:r.course_info.progress,totalTime:`${r.student_info.total_study_hours}小時`,lastAccess:r.student_info.last_login,chapterProgress:r.chapters.map(u=>({name:u.title,progress:u.progress,score:u.quiz_score})),quizResults:r.chapters.map(u=>({name:`${u.title}測驗`,score:u.quiz_score,date:u.quiz_completed_at||"-"}))},c.value=!0}catch(r){console.error("Error fetching student details:",r)}},showStudentModal:c,selectedStudent:s,showExamModal:h,selectedExamData:w,viewExam:n=>{a.value.students.find(u=>u.id===n)&&(w.value={examName:"期末考試",examTime:"2024-01-20 14:30",score:91,answers:[{questionId:1,question:"什麼是FHIR（Fast Healthcare Interoperability Resources）？",studentAnswer:"FHIR是一種現代化的醫療資訊交換標準，用於促進醫療系統間的數據互通",correctAnswer:"FHIR是一種現代化的醫療資訊交換標準，用於促進醫療系統間的數據互通",isCorrect:!0,answerTime:"14:35"},{questionId:2,question:"FHIR的主要優勢是什麼？",studentAnswer:"RESTful API支援、現代網路技術整合",correctAnswer:"RESTful API支援、現代網路技術整合、彈性的資料模型",isCorrect:!1,answerTime:"14:37"}]},h.value=!0)},exportReport:o,courseId:e}}},ot={class:"main-wrapper"},nt={class:"page-wrapper"},lt={class:"page-content"},at={class:"row"},rt={class:"col-md-12 grid-margin stretch-card"},it={class:"card"},dt={class:"card-body"},ct={class:"d-flex justify-content-between align-items-center mb-3"},ut={class:"course-info mt-3"},mt={class:"row"},_t={class:"col-md-6"},gt={class:"col-md-6"},vt={class:"progress"},bt={class:"progress"},pt={class:"table-responsive"},ht={class:"table table-hover"},wt={class:"progress"},ft={class:"table-responsive"},yt={class:"table table-hover"},xt={class:"btn-group"},St=["onClick"],Ct=["onClick"],Rt={key:0,class:"mt-3"},kt={class:"pagination justify-content-center"},Dt=["onClick"];function Et(k,e,c,s,h,w){var v;const a=b("Sidebar"),f=b("Navbar"),D=b("StudentDetailModal"),y=b("ExamReviewModal"),E=b("Footer");return i(),d("div",ot,[p(a),t("div",nt,[p(f),t("div",lt,[t("div",at,[t("div",rt,[t("div",it,[t("div",dt,[t("div",ct,[e[6]||(e[6]=t("h6",{class:"card-title mb-0"},"課程詳細報表",-1)),t("button",{class:"btn btn-primary",onClick:e[0]||(e[0]=(...o)=>s.exportReport&&s.exportReport(...o))},e[5]||(e[5]=[t("i",{class:"material-icons align-middle me-1"},"file_download",-1),_(" 匯出報表 ")]))]),e[14]||(e[14]=t("hr",null,null,-1)),t("div",ut,[t("div",mt,[t("div",_t,[t("p",null,[e[7]||(e[7]=t("strong",null,"課程名稱：",-1)),_(l(s.courseDetail.name),1)]),t("p",null,[e[8]||(e[8]=t("strong",null,"講師：",-1)),_(l(s.courseDetail.instructor),1)]),t("p",null,[e[9]||(e[9]=t("strong",null,"課程分類：",-1)),_(l(s.courseDetail.category),1)])]),t("div",gt,[e[10]||(e[10]=t("strong",null,"總完課率：",-1)),t("div",vt,[t("div",{class:"progress-bar bg-success",role:"progressbar",style:M({width:s.courseDetail.completionRate+"%"})},l(s.courseDetail.completionRate)+"% ",5)]),e[11]||(e[11]=t("strong",null,"平均成績：",-1)),t("div",bt,[t("div",{class:"progress-bar bg-info",role:"progressbar",style:M({width:s.courseDetail.averageScore+"%"})},l(s.courseDetail.averageScore)+"分 ",5)])])])]),e[15]||(e[15]=t("h6",{class:"card-subtitle mt-3"},"章節完成率",-1)),e[16]||(e[16]=t("hr",null,null,-1)),t("div",pt,[t("table",ht,[e[12]||(e[12]=t("thead",null,[t("tr",null,[t("th",null,"章節名稱"),t("th",null,"完成率")])],-1)),t("tbody",null,[(i(!0),d(S,null,C(s.courseDetail.chapters,o=>(i(),d("tr",{key:o.name},[t("td",null,l(o.name),1),t("td",null,[t("div",wt,[t("div",{class:"progress-bar bg-success",role:"progressbar",style:M({width:o.completionRate+"%"})},l(o.completionRate)+"% ",5)])])]))),128))])])]),e[17]||(e[17]=t("h6",{class:"card-subtitle mt-3"},"參加學生列表",-1)),e[18]||(e[18]=t("hr",null,null,-1)),t("div",ft,[t("table",yt,[e[13]||(e[13]=t("thead",null,[t("tr",null,[t("th",null,"學生名稱"),t("th",null,"學生Email"),t("th",null,"操作")])],-1)),t("tbody",null,[(i(!0),d(S,null,C(s.students,o=>(i(),d("tr",{key:o.id},[t("td",null,l(o.name),1),t("td",null,l(o.email),1),t("td",null,[t("div",xt,[t("button",{class:"btn btn-primary btn-sm",onClick:g=>s.viewStudent(o.id)}," 檢視 ",8,St),t("button",{class:"btn btn-info btn-sm",onClick:g=>s.viewExam(o.id)}," 測驗閱卷詳情 ",8,Ct)])])]))),128))])])]),s.totalStudentPages>1?(i(),d("nav",Rt,[t("ul",kt,[t("li",{class:R(["page-item",{disabled:s.currentPage===1}])},[t("a",{class:"page-link",href:"#",onClick:e[1]||(e[1]=P(o=>s.handlePageChange(s.currentPage-1),["prevent"]))}," 上一頁 ")],2),(i(!0),d(S,null,C(s.totalStudentPages,o=>(i(),d("li",{key:o,class:R(["page-item",{active:s.currentPage===o}])},[t("a",{class:"page-link",href:"#",onClick:P(g=>s.handlePageChange(o),["prevent"])},l(o),9,Dt)],2))),128)),t("li",{class:R(["page-item",{disabled:s.currentPage===s.totalStudentPages}])},[t("a",{class:"page-link",href:"#",onClick:e[2]||(e[2]=P(o=>s.handlePageChange(s.currentPage+1),["prevent"]))}," 下一頁 ")],2)])])):q("",!0),p(D,{show:s.showStudentModal,"onUpdate:show":e[3]||(e[3]=o=>s.showStudentModal=o),student:s.selectedStudent,"course-id":s.courseId,"student-id":(v=s.selectedStudent)==null?void 0:v.id},null,8,["show","student","course-id","student-id"]),p(y,{show:s.showExamModal,"onUpdate:show":e[4]||(e[4]=o=>s.showExamModal=o),examData:s.selectedExamData},null,8,["show","examData"])])])])])]),p(E)])])}const At=I(st,[["render",Et],["__scopeId","data-v-c09603ea"]]);export{At as default};
