import{_ as C,r as f,j as L,k as w,o as l,c as r,b as a,l as x,d as T,e as v,g as b,n as m,t as d,a as n,p as D,F as q}from"./index-c34474c4.js";import{a as U}from"./api-service-a37f4a4e.js";import{F as j,N as I,_ as z}from"./sidebar-01ba7568.js";import{L as A}from"./loading-5656bda6.js";const O={components:{Footer:j,Navbar:I,Sidebar:z,Loading:A},setup(){const i=f({address:"",phone:"",email:"",facebook:"",line:"",twitter:"",youtube:""}),o=f({}),u=f(!1),e=f(""),_=f(""),c=f(!1),y=t=>{var h,M;const E=((M=(h=t.response)==null?void 0:h.data)==null?void 0:M.errors)||{},p={};return Object.entries(E).forEach(([F,V])=>{const S=F.replace("meta_value.","");if(S.includes("_acc")){const N=S.replace("_acc",""),B={fb:"facebook",line:"line",twitter:"twitter",youtube:"youtube"};p[B[N]||N]=V[0]}else p[S]=V[0]}),p},k=async()=>{try{c.value=!0;const t=await U.getSocialSetting();i.value={address:t.address,phone:t.phone,email:t.email,facebook:t.fb_acc,line:t.line_acc,twitter:t.twitter_acc,youtube:t.youtube_acc},c.value=!1}catch(t){c.value=!1,console.error("獲取社群設定失敗:",t),_.value="錯誤",e.value="獲取設定失敗，請重新整理頁面",u.value=!0}},g=async()=>{try{c.value=!0,o.value={};const t=[{meta_key:"address",meta_value:{address:i.value.address}},{meta_key:"phone",meta_value:{phone:i.value.phone}},{meta_key:"email",meta_value:{email:i.value.email}},{meta_key:"fb_acc",meta_value:{fb_acc:i.value.facebook}},{meta_key:"line_acc",meta_value:{line_acc:i.value.line}},{meta_key:"twitter_acc",meta_value:{twitter_acc:i.value.twitter}},{meta_key:"youtube_acc",meta_value:{youtube_acc:i.value.youtube}}];await U.updateSiteMetaBatch(t),_.value="成功",e.value="社群設定已更新",u.value=!0,c.value=!1}catch(t){console.error("Error saving social settings:",t),o.value=y(t),_.value="錯誤",e.value="更新設定失敗，請檢查輸入內容",u.value=!0,c.value=!1}},s=()=>{u.value=!1};return L(()=>{k()}),{socialSettings:i,errors:o,showModal:u,modalMessage:e,modalTitle:_,saveSocialSettings:g,closeModal:s,loading:c}}},X={class:"main-wrapper"},Y={class:"page-wrapper"},G={class:"page-content"},H={class:"row"},J={class:"col-md-12 grid-margin stretch-card"},K={class:"card"},P={class:"card-body"},Q={class:"mb-3"},R={key:0,class:"invalid-feedback"},W={class:"mb-3"},Z={key:0,class:"invalid-feedback"},$={class:"mb-3"},ee={key:0,class:"invalid-feedback"},oe={class:"mb-3"},ae={key:0,class:"invalid-feedback"},se={class:"mb-3"},te={key:0,class:"invalid-feedback"},le={class:"mb-3"},ie={key:0,class:"invalid-feedback"},re={class:"mb-3"},ne={key:0,class:"invalid-feedback"},de={class:"modal-dialog"},ce={class:"modal-content"},me={class:"modal-header"},ve={class:"modal-title"},be={class:"modal-body"},ue={class:"modal-footer"},fe={key:1,class:"modal-backdrop fade show"};function _e(i,o,u,e,_,c){const y=w("Sidebar"),k=w("Navbar"),g=w("Loading");return l(),r(q,null,[a("div",X,[x(y),a("div",Y,[x(k),a("div",G,[a("div",H,[a("div",J,[a("div",K,[a("div",P,[o[18]||(o[18]=a("h6",{class:"card-title"},"社群設定",-1)),a("form",{onSubmit:o[7]||(o[7]=T((...s)=>e.saveSocialSettings&&e.saveSocialSettings(...s),["prevent"]))},[a("div",Q,[o[10]||(o[10]=a("label",{for:"address",class:"form-label"},"地址",-1)),v(a("input",{type:"text",class:m(["form-control",{"is-invalid":e.errors.address}]),id:"address","onUpdate:modelValue":o[0]||(o[0]=s=>e.socialSettings.address=s),required:""},null,2),[[b,e.socialSettings.address]]),e.errors.address?(l(),r("div",R,d(e.errors.address),1)):n("",!0)]),a("div",W,[o[11]||(o[11]=a("label",{for:"phone",class:"form-label"},"電話",-1)),v(a("input",{type:"tel",class:m(["form-control",{"is-invalid":e.errors.phone}]),id:"phone","onUpdate:modelValue":o[1]||(o[1]=s=>e.socialSettings.phone=s),required:""},null,2),[[b,e.socialSettings.phone]]),e.errors.phone?(l(),r("div",Z,d(e.errors.phone),1)):n("",!0)]),a("div",$,[o[12]||(o[12]=a("label",{for:"email",class:"form-label"},"電子郵件",-1)),v(a("input",{type:"email",class:m(["form-control",{"is-invalid":e.errors.email}]),id:"email","onUpdate:modelValue":o[2]||(o[2]=s=>e.socialSettings.email=s),required:""},null,2),[[b,e.socialSettings.email]]),e.errors.email?(l(),r("div",ee,d(e.errors.email),1)):n("",!0)]),a("div",oe,[o[13]||(o[13]=a("label",{for:"facebook",class:"form-label"},"Facebook 連結",-1)),v(a("input",{type:"url",class:m(["form-control",{"is-invalid":e.errors.fb_acc}]),id:"facebook","onUpdate:modelValue":o[3]||(o[3]=s=>e.socialSettings.facebook=s),placeholder:"https://facebook.com/your-page"},null,2),[[b,e.socialSettings.facebook]]),e.errors.facebook?(l(),r("div",ae,d(e.errors.facebook),1)):n("",!0)]),a("div",se,[o[14]||(o[14]=a("label",{for:"twitter",class:"form-label"},"Twitter(X) 連結",-1)),v(a("input",{type:"url",class:m(["form-control",{"is-invalid":e.errors.twitter_acc}]),id:"twitter","onUpdate:modelValue":o[4]||(o[4]=s=>e.socialSettings.twitter=s),placeholder:"https://twitter.com/your-account"},null,2),[[b,e.socialSettings.twitter]]),e.errors.twitter?(l(),r("div",te,d(e.errors.twitter),1)):n("",!0)]),a("div",le,[o[15]||(o[15]=a("label",{for:"youtube",class:"form-label"},"YouTube 連結",-1)),v(a("input",{type:"url",class:m(["form-control",{"is-invalid":e.errors.youtube_acc}]),id:"youtube","onUpdate:modelValue":o[5]||(o[5]=s=>e.socialSettings.youtube=s),placeholder:"https://youtube.com/@your-channel"},null,2),[[b,e.socialSettings.youtube]]),e.errors.youtube?(l(),r("div",ie,d(e.errors.youtube),1)):n("",!0)]),a("div",re,[o[16]||(o[16]=a("label",{for:"line",class:"form-label"},"LINE ID",-1)),v(a("input",{type:"text",class:m(["form-control",{"is-invalid":e.errors.line_acc}]),id:"line","onUpdate:modelValue":o[6]||(o[6]=s=>e.socialSettings.line=s),placeholder:"@your-line-id"},null,2),[[b,e.socialSettings.line]]),e.errors.line?(l(),r("div",ne,d(e.errors.line),1)):n("",!0)]),o[17]||(o[17]=a("button",{type:"submit",class:"btn btn-primary me-2"},"儲存設定",-1))],32)])])])])]),e.showModal?(l(),r("div",{key:0,class:m(["modal fade",{show:e.showModal}]),tabindex:"-1",style:{display:"block"}},[a("div",de,[a("div",ce,[a("div",me,[a("h5",ve,d(e.modalTitle),1),a("button",{type:"button",class:"btn-close",onClick:o[8]||(o[8]=(...s)=>e.closeModal&&e.closeModal(...s))})]),a("div",be,[a("p",null,d(e.modalMessage),1)]),a("div",ue,[a("button",{type:"button",class:"btn btn-secondary",onClick:o[9]||(o[9]=(...s)=>e.closeModal&&e.closeModal(...s))},"關閉")])])])],2)):n("",!0),e.showModal?(l(),r("div",fe)):n("",!0)])]),e.loading?(l(),D(g,{key:0})):n("",!0)],64)}const Se=C(O,[["render",_e]]);export{Se as default};
