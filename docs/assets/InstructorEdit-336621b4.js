import{_ as k,i as F,u as U,r as b,j as V,k as i,o as g,c as w,b as t,l as m,d as N,e as d,g as u,a as y,v as S,y as C,p as L,F as q,m as B}from"./index-7097d872.js";import{F as D,N as M,_ as R}from"./sidebar-e309ec1f.js";import{a as x}from"./api-service-28558cf5.js";import{L as h}from"./loading-0c855871.js";const P={components:{Footer:D,Navbar:M,Sidebar:R,Loading:h},setup(){const c=F(),o=U(),r=b(null),e=b(!1),n=b({}),_=async()=>{try{e.value=!0;const a=await x.getInstructor(o.params.id);n.value=a,n.value.photo&&(r.value=`${n.value.photo}`),e.value=!1}catch{alert("取得講師資料失敗"),c.push("/course/instructor"),e.value=!1}finally{e.value=!1}},p=async()=>{e.value=!0;try{const a=new FormData;a.append("name",n.value.name),a.append("position",n.value.position),a.append("description",n.value.description),a.append("note",n.value.note),a.append("index_show",n.value.index_show),n.value.image instanceof File&&a.append("photo",n.value.image),await x.updateInstructor(o.params.id,a),c.push("/course/instructor"),e.value=!1}catch(a){e.value=!1,alert("更新失敗："+a.message)}finally{e.value=!1}},v=a=>{const l=a.target.files[0];if(l){n.value.image=l;const s=new FileReader;s.onload=I=>{r.value=I.target.result},s.readAsDataURL(l)}},f=()=>{n.value.image=null,r.value=null};return V(()=>{_()}),{instructor:n,imagePreview:r,handleImageUpload:v,removeImage:f,saveInstructor:p,loading:e}}},j={class:"main-wrapper"},E={class:"page-wrapper"},T={class:"page-content"},A={class:"row mb-4"},z={class:"col-12 mx-auto stretch-card"},G={class:"card"},H={class:"card-body"},J={class:"mb-3"},K={class:"mb-3"},O={key:0,class:"mt-2"},Q=["src"],W={class:"mb-3"},X={class:"mb-3"},Y={class:"mb-3"},Z={class:"mb-3"},$={class:"d-flex justify-content-end"};function oo(c,o,r,e,n,_){const p=i("Sidebar"),v=i("Navbar"),f=i("router-link"),a=i("Footer"),l=i("Loading");return g(),w(q,null,[t("div",j,[m(p),t("div",E,[m(v),t("div",T,[t("div",A,[t("div",z,[t("div",G,[t("div",H,[o[17]||(o[17]=t("h6",{class:"card-title"},"編輯講師",-1)),t("form",{onSubmit:o[7]||(o[7]=N((...s)=>e.saveInstructor&&e.saveInstructor(...s),["prevent"]))},[t("div",J,[o[8]||(o[8]=t("label",{class:"form-label"},"講師名稱",-1)),d(t("input",{type:"text",class:"form-control","onUpdate:modelValue":o[0]||(o[0]=s=>e.instructor.name=s),required:""},null,512),[[u,e.instructor.name]])]),t("div",K,[o[9]||(o[9]=t("label",{class:"form-label"},"講師照片",-1)),t("input",{type:"file",class:"form-control",accept:"image/*",onChange:o[1]||(o[1]=(...s)=>e.handleImageUpload&&e.handleImageUpload(...s))},null,32),e.imagePreview?(g(),w("div",O,[t("img",{src:e.imagePreview,class:"img-thumbnail",style:{"max-width":"200px"}},null,8,Q),t("button",{type:"button",class:"btn btn-sm btn-outline-danger ms-2",onClick:o[2]||(o[2]=(...s)=>e.removeImage&&e.removeImage(...s))}," 移除照片 ")])):y("",!0)]),t("div",W,[o[10]||(o[10]=t("label",{class:"form-label"},"職稱",-1)),d(t("input",{type:"text",class:"form-control","onUpdate:modelValue":o[3]||(o[3]=s=>e.instructor.position=s),required:""},null,512),[[u,e.instructor.position]])]),t("div",X,[o[11]||(o[11]=t("label",{class:"form-label"},"描述",-1)),d(t("textarea",{class:"form-control","onUpdate:modelValue":o[4]||(o[4]=s=>e.instructor.description=s),rows:"4",required:""},null,512),[[u,e.instructor.description]])]),t("div",Y,[o[12]||(o[12]=t("label",{class:"form-label"},"備註",-1)),d(t("textarea",{class:"form-control","onUpdate:modelValue":o[5]||(o[5]=s=>e.instructor.note=s),rows:"2"},null,512),[[u,e.instructor.note]])]),t("div",Z,[o[14]||(o[14]=t("label",{class:"form-label"},"是否展示在首頁",-1)),d(t("select",{class:"form-select","onUpdate:modelValue":o[6]||(o[6]=s=>e.instructor.index_show=s),required:""},o[13]||(o[13]=[t("option",{value:"1"},"是",-1),t("option",{value:"0"},"否",-1)]),512),[[S,e.instructor.index_show]])]),t("div",$,[m(f,{to:"/course/instructor",class:"btn btn-secondary me-2"},{default:C(()=>o[15]||(o[15]=[B(" 取消 ")])),_:1}),o[16]||(o[16]=t("button",{type:"submit",class:"btn btn-primary"},"儲存",-1))])],32)])])])])]),m(a)])]),e.loading?(g(),L(l,{key:0})):y("",!0)],64)}const no=k(P,[["render",oo]]);export{no as default};
