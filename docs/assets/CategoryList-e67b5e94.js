import{_ as N,p as F,r as s,i as T,j as b,o as l,c as d,b as e,k as f,e as B,g as D,F as C,f as w,n as k,d as P,a as L,m as V,t as v}from"./index-c9105bf4.js";import{F as j,N as E,_ as Q,a as S}from"./sidebar-e3f393ae.js";import{L as z}from"./loading-c728061a.js";const A={components:{Footer:j,Navbar:E,Sidebar:Q,Loading:z},setup(){const p=F(),a=s([]),h=s(""),t=s(1),i=s(10),c=s(!1),u=s(0),g=s(""),r=async()=>{c.value=!0;try{const n=await S.getTags({type:"category",page:t.value,per_page:i.value,search:h.value});a.value=n.data.map(_=>({id:_.id,name:_.name,courseCount:_.courses_count,createdAt:_.created_at})),i.value=n.pagination.per_page,u.value=n.pagination.last_page,t.value=n.pagination.current_page}catch(n){console.error("獲取分類失敗:",n)}finally{c.value=!1}},y=n=>{p.push(`/course/category/edit/${n}`)},o=n=>{g.value=n},m=async()=>{try{await S.delTag(g.value),r(),$("#delConfirmModal").modal("hide")}catch(n){console.error("刪除標籤失敗:",n)}},x=async n=>{t.value=n,await r()},M=()=>{t.value=1,r()};return T(()=>{r()}),{categories:a,searchQuery:h,currentPage:t,pageSize:i,loading:c,totalPages:u,handleEdit:y,handleDelete:o,changePage:x,handleSearch:M,delTag:m}}},I={class:"main-wrapper"},R={class:"page-wrapper"},U={class:"page-content"},q={class:"row mb-4"},G={class:"col-md-12 grid-margin stretch-card"},H={class:"card"},J={class:"card-body"},K={class:"d-flex justify-content-between align-items-center mb-4"},O={class:"mb-3 d-flex row gap-2"},W={class:"col-md-4"},X={class:"input-group"},Y={class:"table-responsive"},Z={class:"table"},ee=["onClick"],te=["onClick"],ae={key:0,class:"mt-4"},oe={class:"pagination justify-content-center"},ne=["onClick"],se={class:"modal fade",id:"delConfirmModal",tabindex:"-1","aria-labelledby":"delConfirmModalLabel","aria-hidden":"true"},le={class:"modal-dialog"},re={class:"modal-content"},de={class:"modal-footer"};function ie(p,a,h,t,i,c){const u=b("Sidebar"),g=b("Navbar"),r=b("Footer"),y=b("Loading");return l(),d(C,null,[e("div",I,[f(u),e("div",R,[f(g),e("div",U,[e("div",q,[e("div",G,[e("div",H,[e("div",J,[e("div",K,[a[6]||(a[6]=e("h6",{class:"card-title mb-0"},"課程分類管理",-1)),e("button",{class:"btn btn-primary",onClick:a[0]||(a[0]=o=>p.$router.push("/course/category/add"))}," 新增分類 ")]),e("div",O,[e("div",W,[e("div",X,[B(e("input",{type:"text",class:"form-control","onUpdate:modelValue":a[1]||(a[1]=o=>t.searchQuery=o),placeholder:"搜尋分類名稱"},null,512),[[D,t.searchQuery]]),e("button",{class:"btn btn-primary",onClick:a[2]||(a[2]=(...o)=>t.handleSearch&&t.handleSearch(...o))}," 搜尋 ")])])]),e("div",Y,[e("table",Z,[a[7]||(a[7]=e("thead",null,[e("tr",null,[e("th",null,"分類名稱"),e("th",null,"課程數量"),e("th",null,"建立日期"),e("th",null,"操作")])],-1)),e("tbody",null,[(l(!0),d(C,null,w(t.categories,o=>(l(),d("tr",{key:o.id},[e("td",null,v(o.name),1),e("td",null,v(o.courseCount),1),e("td",null,v(o.createdAt),1),e("td",null,[e("button",{class:"btn btn-sm btn-outline-primary me-2",onClick:m=>t.handleEdit(o.id)}," 編輯 ",8,ee),e("button",{class:"btn btn-sm btn-outline-danger",onClick:m=>t.handleDelete(o.id),"data-bs-toggle":"modal","data-bs-target":"#delConfirmModal"}," 刪除 ",8,te)])]))),128))])])]),t.totalPages>0?(l(),d("nav",ae,[e("ul",oe,[e("li",{class:k(["page-item",{disabled:t.currentPage===1}])},[e("a",{class:"page-link",href:"#",onClick:a[3]||(a[3]=P(o=>t.changePage(t.currentPage>1?t.currentPage-1:1),["prevent"]))}," 上一頁 ")],2),(l(!0),d(C,null,w(t.totalPages,o=>(l(),d("li",{key:o,class:k(["page-item",{active:t.currentPage===o}])},[e("a",{class:"page-link",href:"#",onClick:P(m=>t.changePage(o),["prevent"])},v(o),9,ne)],2))),128)),e("li",{class:k(["page-item",{disabled:t.currentPage===t.totalPages}])},[e("a",{class:"page-link",href:"#",onClick:a[4]||(a[4]=P(o=>t.changePage(t.currentPage<t.totalPages?t.currentPage+1:t.totalPages),["prevent"]))}," 下一頁 ")],2)])])):L("",!0)])])])])]),e("div",se,[e("div",le,[e("div",re,[a[9]||(a[9]=e("div",{class:"modal-header"},[e("h5",{class:"modal-title",id:"delConfirmModalLabel"},"確認刪除？"),e("button",{type:"button",class:"btn-close","data-bs-dismiss":"modal","aria-label":"btn-close"})],-1)),a[10]||(a[10]=e("div",{class:"modal-body"},"請確認是否刪除",-1)),e("div",de,[a[8]||(a[8]=e("button",{type:"button",class:"btn btn-secondary","data-bs-dismiss":"modal"}," 關閉 ",-1)),e("button",{type:"button",class:"btn btn-primary",onClick:a[5]||(a[5]=o=>t.delTag())}," 確認 ")])])])]),f(r)])]),t.loading?(l(),V(y,{key:0})):L("",!0)],64)}const me=N(A,[["render",ie],["__scopeId","data-v-7ac8474c"]]);export{me as default};
