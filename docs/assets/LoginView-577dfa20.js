import{_ as x,p as M,r,j as E,o as d,c,b as s,l as u,d as S,e as p,g as w,z as C,k as F,y as L,a as b,t as f,n as V,h as N,F as D}from"./index-d5779e68.js";import{F as I,N as z,_ as B,a as k}from"./sidebar-aa2c2d34.js";const H={components:{Footer:I,Navbar:z,Sidebar:B},setup(){const v=M(),o=r(""),m=r(""),e=r(!1),l=r(!1),i=r(""),n=r(!1),a=r(!1);return{email:o,password:m,rememberMe:e,loginForm:async()=>{var g,_;a.value=!0,n.value=!0;try{const t=await k.adminLogin({email:o.value,password:m.value});if(t&&t.original.access_token){const h=t.original.access_token;e.value?localStorage.setItem("access_token",h):sessionStorage.setItem("access_token",h);const y=await k.adminMe();sessionStorage.setItem("userData",JSON.stringify(y)),v.push("/")}else i.value="登入失敗：無效的回應格式",l.value=!0,console.error("Invalid response format:",t)}catch(t){i.value="登入失敗："+(((_=(g=t.response)==null?void 0:g.data)==null?void 0:_.message)||"未知錯誤"),l.value=!0,console.error("Login error:",t)}finally{n.value=!1,a.value=""}},showErrorModal:l,errorMessage:i,closeErrorModal:()=>{l.value=!1},isLoading:n,showHint:a}}},U={class:"main-wrapper"},j={class:"page-wrapper full-page"},q={class:"page-content d-flex align-items-center justify-content-center"},P={class:"row w-100 mx-0 auth-page"},T={class:"col-md-10 col-lg-8 col-xl-6 mx-auto"},J={class:"card"},O={class:"row"},R={class:"col-md-8 ps-md-0"},A={class:"auth-form-wrapper px-4 py-5"},G={class:"mb-3"},K={class:"mb-3"},Q={class:"form-check mb-3"},W={class:"mb-3"},X=["disabled"],Y={key:0,class:"spinner-border spinner-border-sm me-1",role:"status","aria-hidden":"true"},Z={class:"mt-3 text-info",style:{"min-height":"30px"}},$={key:0},ss={class:"modal-dialog"},os={class:"modal-content"},es={class:"modal-header"},as={class:"modal-body"},ts={class:"modal-footer"},rs={key:0,class:"modal-backdrop fade show"};function ls(v,o,m,e,l,i){const n=E("router-link");return d(),c(D,null,[s("div",U,[s("div",j,[s("div",q,[s("div",P,[s("div",T,[s("div",J,[s("div",O,[o[12]||(o[12]=s("div",{class:"col-md-4 pe-md-0"},[s("div",{class:"auth-side-wrapper",style:{"background-image":"url('assets/images/login.webp')"}})],-1)),s("div",R,[s("div",A,[o[10]||(o[10]=s("a",{href:"#",class:"nobleui-logo d-block mb-2"},[u("Smart"),s("span",null,"Health")],-1)),o[11]||(o[11]=s("h5",{class:"text-secondary fw-normal mb-4"}," 請輸入您的帳號密碼 ",-1)),s("form",{class:"forms-sample",onSubmit:o[3]||(o[3]=S((...a)=>e.loginForm&&e.loginForm(...a),["prevent"]))},[s("div",G,[o[6]||(o[6]=s("label",{for:"userEmail",class:"form-label"},"Email",-1)),p(s("input",{type:"email",class:"form-control","onUpdate:modelValue":o[0]||(o[0]=a=>e.email=a),id:"userEmail",placeholder:"Email",required:""},null,512),[[w,e.email]])]),s("div",K,[o[7]||(o[7]=s("label",{for:"userPassword",class:"form-label"},"密碼",-1)),p(s("input",{type:"password",class:"form-control",id:"userPassword",autocomplete:"current-password","onUpdate:modelValue":o[1]||(o[1]=a=>e.password=a),placeholder:"密碼",required:""},null,512),[[w,e.password]])]),s("div",Q,[p(s("input",{type:"checkbox",class:"form-check-input",id:"authCheck","onUpdate:modelValue":o[2]||(o[2]=a=>e.rememberMe=a)},null,512),[[C,e.rememberMe]]),o[8]||(o[8]=s("label",{class:"form-check-label",for:"authCheck"}," 記住我 ",-1))]),s("div",W,[F(n,{to:"/forgot-password",class:"text-primary text-decoration-none"},{default:L(()=>o[9]||(o[9]=[u(" 忘記密碼？ ")])),_:1})]),s("div",null,[s("button",{type:"submit",class:"btn btn-primary me-2 mb-2 mb-md-0 text-white",disabled:e.isLoading},[e.isLoading?(d(),c("span",Y)):b("",!0),u(" "+f(e.isLoading?"登入中...":"登入"),1)],8,X)])],32),s("div",Z,[e.showHint?(d(),c("span",$,f(e.isLoading?"正在處理您的登入請求...":"請稍候，我們正在驗證您的帳號..."),1)):b("",!0)])])])])])])])])])]),s("div",{class:V(["modal fade",{"show d-block":e.showErrorModal}]),tabindex:"-1",style:N({display:e.showErrorModal?"block":"none"})},[s("div",ss,[s("div",os,[s("div",es,[o[13]||(o[13]=s("h5",{class:"modal-title"},"登入錯誤",-1)),s("button",{type:"button",class:"btn-close",onClick:o[4]||(o[4]=(...a)=>e.closeErrorModal&&e.closeErrorModal(...a))})]),s("div",as,[s("p",null,f(e.errorMessage),1)]),s("div",ts,[s("button",{type:"button",class:"btn btn-secondary",onClick:o[5]||(o[5]=(...a)=>e.closeErrorModal&&e.closeErrorModal(...a))}," 關閉 ")])])])],6),e.showErrorModal?(d(),c("div",rs)):b("",!0)],64)}const ms=x(H,[["render",ls]]);export{ms as default};
