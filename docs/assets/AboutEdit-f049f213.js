import{_ as C,u as U,p as A,r as n,i as L,j as b,o as h,c as y,k as _,b as e,e as g,g as N,v as w,n as S,h as E,a as F}from"./index-6761c57d.js";import{F as H,N as P,_ as V,a as M}from"./sidebar-38b40803.js";import{C as T,U as j}from"./UploadAdapter-a417776a.js";const B={components:{Footer:H,Navbar:P,Sidebar:V},setup(){U(),A();const f=n([]),o=n({id:null,title:"",content:"",sort:0,status:"active",type:"post"}),i=n({}),s=n(!1),a=n(""),c=n(null),r=async()=>{try{const t=await M.getPost({type:"about"});o.value={...t}}catch(t){console.error("Error fetching post:",t),alert("獲取文章資料失敗，請稍後再試")}},u=async()=>{var t,d;try{const l=await M.updatePost(o.value.id,o.value);a.value="儲存成功",s.value=!0}catch(l){if(console.error("Failed to save member:",l),((d=(t=l.response)==null?void 0:t.data)==null?void 0:d.status)==="error")if(l.response.data.content){const p={};for(const[x,m]of Object.entries(l.response.data.content))p[x]=Array.isArray(m)?m[0].replace(/[\[\]"]/g,""):m;i.value=p;const k=Object.values(p).join("<br/>");a.value=k,s.value=!0}else a.value=l.response.data.message||"儲存失敗",s.value=!0;else a.value="儲存失敗",s.value=!0}};L(async()=>{await r(),c.value=await T.create(document.querySelector("#editor"),{removePlugins:["Markdown"],extraPlugins:[v],toolbar:["heading","|","bold","italic","link","bulletedList","numberedList","blockQuote","imageUpload"],heading:{options:[{model:"paragraph",title:"Paragraph",class:"ck-heading_paragraph"},{model:"heading1",view:"h2",title:"Heading 1",class:"ck-heading_heading1"},{model:"heading2",view:"h3",title:"Heading 2",class:"ck-heading_heading2"}]}}).then(t=>(t.model.document.on("change:data",()=>{o.value.content=t.getData()}),t)).catch(t=>{console.error(t)})});function v(t){t.plugins.get("FileRepository").createUploadAdapter=d=>new j(d)}return{postList:f,currentpost:o,editor:c,editpost:r,savepost:u,showModal:s,modalMessage:a,errors:i}}},R={class:"main-wrapper"},z={class:"page-wrapper"},D={class:"page-content"},O={class:"row"},q={class:"col-md-12 grid-margin stretch-card"},Q={class:"card"},G={class:"card-body"},J={class:"row mb-4"},K={class:"col-12"},W={class:"col-12 my-3"},X=["innerHTML"],Y={class:"col-6"},Z={class:"col-6"},I={class:"col-6 d-flex align-items-end"},$={class:"modal-dialog"},ee={class:"modal-content"},oe={class:"modal-header"},te=["innerHTML"],se={class:"modal-footer"},ae={key:0,class:"modal-backdrop fade show"};function le(f,o,i,s,a,c){const r=b("Navbar"),u=b("Sidebar"),v=b("Footer");return h(),y("div",R,[_(r),_(u),e("div",z,[e("div",D,[e("div",O,[e("div",q,[e("div",Q,[e("div",G,[o[12]||(o[12]=e("h6",{class:"card-title"},"關於我們編輯",-1)),e("div",J,[e("div",K,[o[6]||(o[6]=e("label",{class:"form-label"},"標題",-1)),g(e("input",{type:"text",class:"form-control",disabled:"","onUpdate:modelValue":o[0]||(o[0]=t=>s.currentpost.title=t)},null,512),[[N,s.currentpost.title]])]),e("div",W,[o[7]||(o[7]=e("label",{class:"form-label"},"內容編輯",-1)),e("div",{id:"editor",innerHTML:s.currentpost.content},null,8,X)]),e("div",Y,[o[9]||(o[9]=e("label",{class:"form-label"},"狀態",-1)),g(e("select",{class:"form-select","onUpdate:modelValue":o[1]||(o[1]=t=>s.currentpost.status=t)},o[8]||(o[8]=[e("option",{value:"active"},"啟用",-1),e("option",{value:"inactive"},"停用",-1)]),512),[[w,s.currentpost.status]])]),e("div",Z,[o[11]||(o[11]=e("label",{class:"form-label"},"狀態",-1)),g(e("select",{class:"form-select","onUpdate:modelValue":o[2]||(o[2]=t=>s.currentpost.status=t)},o[10]||(o[10]=[e("option",{value:"active"},"啟用",-1),e("option",{value:"inactive"},"停用",-1)]),512),[[w,s.currentpost.status]])]),e("div",I,[e("button",{class:"btn btn-primary w-100",onClick:o[3]||(o[3]=(...t)=>s.savepost&&s.savepost(...t))}," 儲存變更 ")])])])])])]),_(v)])]),e("div",{class:S(["modal fade",{show:s.showModal}]),tabindex:"-1",style:E({display:s.showModal?"block":"none"})},[e("div",$,[e("div",ee,[e("div",oe,[o[13]||(o[13]=e("h5",{class:"modal-title"},"錯誤提示",-1)),e("button",{type:"button",class:"btn-close",onClick:o[4]||(o[4]=t=>s.showModal=!1)})]),e("div",{class:"modal-body",innerHTML:s.modalMessage},null,8,te),e("div",se,[e("button",{type:"button",class:"btn btn-secondary",onClick:o[5]||(o[5]=t=>s.showModal=!1)}," 關閉 ")])])])],6),s.showModal?(h(),y("div",ae)):F("",!0)])}const ie=C(B,[["render",le],["__scopeId","data-v-90c2c5dd"]]);export{ie as default};
